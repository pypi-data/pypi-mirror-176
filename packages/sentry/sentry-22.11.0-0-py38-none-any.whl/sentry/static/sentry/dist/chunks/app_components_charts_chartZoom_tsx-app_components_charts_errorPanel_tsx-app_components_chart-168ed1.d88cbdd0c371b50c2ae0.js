"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_charts_chartZoom_tsx-app_components_charts_errorPanel_tsx-app_components_chart-168ed1"],{"./app/components/charts/chartZoom.tsx":(e,t,s)=>{s.d(t,{Z:()=>y});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=s("../node_modules/react/index.js"),o=s("../node_modules/moment/moment.js"),n=s.n(o),a=s("../node_modules/query-string/index.js"),l=s("./app/actionCreators/pageFilters.tsx"),d=s("./app/components/charts/components/dataZoomInside.tsx");s("../node_modules/echarts/lib/component/dataZoomSlider.js");const u={realtime:!1,showDetail:!1,left:0,right:6,bottom:8};function c(e){return e&&Array.isArray(e)?e:[{...u,...e}]}var p=s("./app/components/charts/components/toolBox.tsx"),m=s("./app/utils/callIfFunction.tsx"),g=s("./app/utils/dates.tsx");const h=e=>e?n().utc(e).format(n().HTML5_FMT.DATETIME_LOCAL_SECONDS):null;class f extends i.Component{constructor(e){var t;super(e),t=this,(0,r.Z)(this,"history",void 0),(0,r.Z)(this,"currentPeriod",void 0),(0,r.Z)(this,"zooming",null),(0,r.Z)(this,"saveCurrentPeriod",(e=>{this.currentPeriod={period:e.period,start:h(e.start),end:h(e.end)}})),(0,r.Z)(this,"setPeriod",(function(e){let{period:s,start:r,end:i}=e,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{router:n,onZoom:d,usePageDate:u}=t.props,c=h(r),p=h(i);o&&t.history.push(t.currentPeriod),d?.({period:s,start:c,end:p}),t.zooming=()=>{if(u&&n){const e={...n.location.query,pageStart:r?(0,g.v5)(r):void 0,pageEnd:i?(0,g.v5)(i):void 0,pageStatsPeriod:s??void 0};a.stringify(e)!==a.stringify(n.location.query)&&n.push({pathname:n.location.pathname,query:e})}else(0,l.dR)({period:s,start:c?(0,g.hC)(c):c,end:p?(0,g.hC)(p):p},n);t.saveCurrentPeriod({period:s,start:r,end:i})}})),(0,r.Z)(this,"handleChartReady",(e=>{this.props.onChartReady?.(e)})),(0,r.Z)(this,"handleZoomRestore",((e,t)=>{this.history.length&&(this.setPeriod(this.history[0]),this.history=[],this.props.onRestore?.(e,t))})),(0,r.Z)(this,"handleDataZoom",((e,t)=>{const s=t.getModel(),{startValue:r,endValue:i}=s._payload.batch[0];if(null===r&&null===i){const e=this.history.pop();if(!e)return;this.setPeriod(e)}else{const e=n().utc(r),t=n().utc(i);this.setPeriod({period:null,start:e,end:t},!0)}this.props.onDataZoom?.(e,t)})),(0,r.Z)(this,"handleChartFinished",((e,t)=>{"function"==typeof this.zooming&&(this.zooming(),this.zooming=null);const s=t._componentsViews?.find((e=>e._features&&e._features.dataZoom));s&&!s._features.dataZoom._isZoomActive&&t.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:!0}),(0,m.g)(this.props.onFinished)})),this.history=[],this.saveCurrentPeriod(e)}componentDidUpdate(){this.props.disabled||this.saveCurrentPeriod(this.props)}render(){const{utc:e,start:t,end:s,disabled:r,children:i,xAxisIndex:o,router:n,onZoom:a,onRestore:l,onChartReady:u,onDataZoom:m,onFinished:h,showSlider:f,chartZoomOptions:y,...v}=this.props,b=e??void 0,x=t?(0,g.hC)(t):void 0,S=s?(0,g.hC)(s):void 0;return i(r?{utc:b,start:x,end:S,...v}:{isGroupedByDate:!0,onChartReady:this.handleChartReady,utc:b,start:x,end:S,dataZoom:f?[...c({xAxisIndex:o,...y}),...(0,d.Z)({xAxisIndex:o,...y})]:(0,d.Z)({xAxisIndex:o,...y}),showTimeInTooltip:!0,toolBox:(0,p.Z)({},{dataZoom:{title:{zoom:"",back:""},iconStyle:{borderWidth:0,color:"transparent",opacity:0}}}),onDataZoom:this.handleDataZoom,onFinished:this.handleChartFinished,onRestore:this.handleZoomRestore,...v})}}f.displayName="ChartZoom";const y=f},"./app/components/charts/components/dataZoomInside.tsx":(e,t,s)=>{s.d(t,{Z:()=>i}),s("../node_modules/echarts/lib/component/dataZoomInside.js");const r={type:"inside",zoomOnMouseWheel:!1,zoomLock:!0,throttle:50};function i(e){return e&&Array.isArray(e)?e:[{...r,...e}]}},"./app/components/charts/components/toolBox.tsx":(e,t,s)=>{function r(){let{dataZoom:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{...e?{dataZoom:{yAxisIndex:"none",title:{zoom:"zoom",back:"undo"},...e}}:{},...t}}function i(e,t){return{right:0,top:0,itemSize:16,z:-1,feature:r(t),...e}}s.d(t,{Z:()=>i})},"./app/components/charts/components/visualMap.tsx":(e,t,s)=>{function r(e){return e}s.d(t,{Z:()=>r}),s("../node_modules/echarts/lib/component/visualMap.js")},"./app/components/charts/errorPanel.tsx":(e,t,s)=>{s.d(t,{Z:()=>r});const r=(0,s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js").Z)("div",{target:"e1six6h50"})("display:flex;flex-direction:column;justify-content:center;align-items:center;flex:1;flex-shrink:0;overflow:hidden;height:",(e=>e.height||"200px"),";position:relative;border-color:transparent;margin-bottom:0;color:",(e=>e.theme.gray300),";font-size:",(e=>e.theme.fontSizeExtraLarge),";")},"./app/components/charts/lineChart.tsx":(e,t,s)=>{s.d(t,{w:()=>n});var r=s("./app/components/charts/series/lineSeries.tsx"),i=s("./app/components/charts/baseChart.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function n(e){let{series:t,seriesOptions:s,...n}=e;return(0,o.tZ)(i.Z,{...n,series:t.map((e=>{let{seriesName:t,data:i,dataArray:o,...n}=e;return(0,r.Z)({...s,...n,name:t,data:o||i?.map((e=>{let{value:t,name:s}=e;return[s,t]})),animation:!1,animationThreshold:1,animationDuration:0})}))})}n.displayName="LineChart"},"./app/components/charts/transitionChart.tsx":(e,t,s)=>{s.d(t,{Z:()=>l});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=s("../node_modules/react/index.js"),o=s("./app/components/charts/loadingPanel.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class a extends i.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{prevReloading:this.props.reloading,prevLoading:this.props.loading,key:1})}static getDerivedStateFromProps(e,t){const s=t.prevReloading,r=e.reloading,i=t.prevLoading,o=e.loading;return i!==o?{prevReloading:r,prevLoading:o,key:t.key+1}:o?{prevReloading:r,prevLoading:o,key:t.key}:s&&!r?{prevReloading:r,prevLoading:o,key:t.key+1}:{prevReloading:r,prevLoading:o,key:t.key}}render(){const{height:e,loading:t,reloading:s}=this.props;return t&&!s?(0,n.tZ)(o.Z,{height:e,"data-test-id":"events-request-loading"}):(0,n.tZ)(i.Fragment,{children:this.props.children},String(this.state.key))}}a.displayName="TransitionChart",(0,r.Z)(a,"defaultProps",{height:"200px"});const l=a},"./app/components/charts/transparentLoadingMask.tsx":(e,t,s)=>{s.d(t,{Z:()=>n});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=s("./app/components/loadingMask.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const n=(0,r.Z)((e=>{let{className:t,visible:s,children:r,...n}=e;const a=s?{...n,"data-test-id":"loading-placeholder"}:n;return(0,o.tZ)(i.Z,{className:t,...a,children:r})}),{target:"ewtkxp50"})((e=>!e.visible&&"display: none;"),";opacity:0.4;z-index:1;")},"./app/components/charts/worldMapChart.tsx":(e,t,s)=>{s.d(t,{y:()=>c});var r=s("../node_modules/react/index.js"),i=s("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),o=s("../node_modules/echarts/lib/core/echarts.js"),n=s("../node_modules/lodash/max.js"),a=s.n(n),l=s("./app/components/charts/components/visualMap.tsx");s("../node_modules/echarts/lib/chart/map.js");var d=s("./app/components/charts/baseChart.tsx"),u=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function c(e){let{series:t,seriesOptions:n,fromDiscover:c,fromDiscoverQueryList:p,...m}=e;const g=(0,i.u)(),[h,f]=(0,r.useState)((()=>({countryToCodeMap:null,map:null,codeToCountryMap:null})));if((0,r.useEffect)((()=>{let e=!1;return e||async function(){try{const[e,t]=await Promise.all([s.e("app_data_countryCodesMap_tsx").then(s.bind(s,"./app/data/countryCodesMap.tsx")),s.e("app_data_world_json").then(s.t.bind(s,"./app/data/world.json",19))]),r=e.default,i=t.default;o.je?.("sentryWorld",i);const n={};for(const e in i)n[r[e]]=e;f({countryToCodeMap:r,map:i,codeToCountryMap:n})}catch{}}(),()=>{e=!0}}),[]),null===h.countryToCodeMap||null===h.map)return null;const y=t.map((e=>{let{seriesName:t,data:s,...r}=e;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{map:""};return{roam:!0,...e,emphasis:{label:{show:!1},...e.emphasis},type:"map"}}({...n,...r,map:"sentryWorld",name:t,nameMap:h.countryToCodeMap??void 0,aspectScale:.85,zoom:c?1.1:p?.9:1.3,center:[10.97,p?-12:9.71],itemStyle:{areaColor:g.gray200,borderColor:g.backgroundSecondary},emphasis:{itemStyle:{areaColor:g.pink300},label:{show:!1}},data:s,silent:p,roam:!p})})),v=a()(t.map((e=>{let{data:t}=e;return a()(t.map((e=>{let{value:t}=e;return t})))})))||1;return(0,u.tZ)(d.Z,{options:{backgroundColor:p?void 0:g.background,visualMap:[(0,l.Z)({show:!p,left:c?void 0:"right",right:c?5:void 0,min:0,max:v,inRange:{color:[g.purple200,g.purple300]},text:["High","Low"],textStyle:{color:g.textColor},calculable:!1})]},...m,yAxis:null,xAxis:null,series:y,tooltip:{formatter:e=>{const{marker:t,name:s,value:r}=Array.isArray(e)?e[0]:e;if(isNaN(r))return"";const i="number"==typeof r?r.toLocaleString():"";return[`<div class="tooltip-series tooltip-series-solo">\n               <div><span class="tooltip-label">${t} <strong>${h.codeToCountryMap?.[s]||s}</strong></span> ${i}</div>\n            </div>`,'<div class="tooltip-arrow"></div>'].join("")}},height:c?400:void 0})}c.displayName="WorldMapChart"},"./app/utils/customMeasurements/customMeasurementsContext.tsx":(e,t,s)=>{s.d(t,{z:()=>r});const r=(0,s("../node_modules/react/index.js").createContext)(void 0)},"./app/utils/dashboards/issueFieldRenderers.tsx":(e,t,s)=>{s.d(t,{N:()=>S,O:()=>C});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),o=s("./app/components/assigneeSelector.tsx"),n=s("./app/components/count.tsx"),a=s("./app/components/links/link.tsx"),l=s("./app/components/organizations/timeRangeSelector/utils.tsx"),d=s("./app/components/tooltip.tsx"),u=s("./app/constants/index.tsx"),c=s("./app/locale.tsx"),p=s("./app/stores/memberListStore.tsx"),m=s("./app/styles/space.tsx"),g=s("./app/utils/discover/eventView.tsx"),h=s("./app/views/dashboardsV2/widgetBuilder/issueWidget/fields.tsx"),f=s("./app/utils/discover/styles.tsx"),y=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const v={issue:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;const r=e["issue.id"];if(!r)return(0,y.tZ)(f.W2,{children:(0,y.tZ)(f.PV,{shortId:`${e.issue}`})});const i={pathname:`/organizations/${s.slug}/issues/${r}/`};return(0,y.tZ)(f.W2,{children:(0,y.tZ)(f.Jo,{to:i,"aria-label":r,children:(0,y.tZ)(f.PV,{shortId:`${e.issue}`})})})}},assignee:{sortField:null,renderFunc:e=>{const t=p.Z.getAll();return(0,y.tZ)(T,{children:(0,y.tZ)(o.Z,{id:e.id,memberList:t,noDropdown:!0})})}},lifetimeEvents:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;return b(e,s,"lifetimeEvents")}},lifetimeUsers:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;return b(e,s,"lifetimeUsers")}},events:{sortField:"freq",renderFunc:(e,t)=>{let{organization:s}=t;return b(e,s,"events")}},users:{sortField:"user",renderFunc:(e,t)=>{let{organization:s}=t;return b(e,s,"users")}},lifetimeCount:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;return b(e,s,"lifetimeEvents")}},lifetimeUserCount:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;return b(e,s,"lifetimeUsers")}},count:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;return b(e,s,"events")}},userCount:{sortField:null,renderFunc:(e,t)=>{let{organization:s}=t;return b(e,s,"users")}},links:{sortField:null,renderFunc:e=>{let{links:t}=e;return(0,y.tZ)(F,{dangerouslySetInnerHTML:{__html:t}})}}},b=(e,t,s)=>{const{start:r,end:o,period:a}=e,p=!!/user/i.exec(s.toLowerCase()),m=e[s],g=e[p?"users":"events"],h=e[p?"lifetimeUsers":"lifetimeEvents"],v=e[p?"filteredUsers":"filteredEvents"],b=x(e,t),S=x(e,t,!0),w=r&&o?"time range":(0,l.TI)(a||u.GY).toLowerCase();return(0,y.tZ)(f.W2,{children:(0,y.tZ)(d.Z,{isHoverable:!0,skipWrapper:!0,overlayStyle:{padding:0},title:(0,y.BX)("div",{children:[v?(0,y.BX)(i.Fragment,{children:[(0,y.BX)(_,{to:S,children:[(0,c.t)("Matching search filters"),(0,y.tZ)(j,{value:v})]}),(0,y.tZ)(Z,{})]}):null,(0,y.BX)(_,{to:b,children:[(0,c.t)("Total in %s",w),(0,y.tZ)(j,{value:g})]}),(0,y.tZ)(Z,{}),(0,y.BX)(E,{children:[(0,c.t)("Since issue began"),(0,y.tZ)(j,{value:h})]})]}),children:(0,y.tZ)("span",{children:["events","users"].includes(s)&&v?(0,y.BX)(i.Fragment,{children:[(0,y.tZ)(n.Z,{value:v}),(0,y.tZ)(O,{value:m})]}):(0,y.tZ)(n.Z,{value:m})})})})};b.displayName="issuesCountRenderer";const x=(e,t,s)=>{const r={projects:[Number(e.projectId)]};return g.ZP.fromSavedQuery({...r,id:void 0,start:e.start,end:e.end,range:e.period,name:e.title,fields:["title","release","environment","user","timestamp"],orderby:"-timestamp",query:`issue.id:${e.id}${s?e.discoverSearchQuery:""}`,version:2}).getResultsViewUrlTarget(t.slug)};function S(e){if(v.hasOwnProperty(e))return v[e].sortField;switch(e){case h.Sh.LAST_SEEN:return"date";case h.Sh.FIRST_SEEN:return"new";default:return null}}const w={name:"s5gdgx",styles:"width:100%;justify-content:space-between;display:flex;padding:6px 10px"},E=(0,r.Z)("div",{target:"e1va53iy6"})(w,";"),_=(0,r.Z)(a.Z,{target:"e1va53iy5"})(w,";color:",(e=>e.theme.gray400),";&:hover{color:",(e=>e.theme.gray400),";background:",(e=>e.theme.hover),";}"),O=(0,r.Z)(n.Z,{target:"e1va53iy4"})(":before{content:'/';padding-left:",(0,m.Z)(.25),";padding-right:2px;}"),j=(0,r.Z)((e=>{let{value:t,...s}=e;return(0,y.tZ)("div",{...s,children:(0,y.tZ)(n.Z,{value:t})})}),{target:"e1va53iy3"})("text-align:right;font-weight:bold;font-variant-numeric:tabular-nums;padding-left:",(0,m.Z)(2),";color:",(e=>e.theme.subText),";"),Z=(0,r.Z)("div",{target:"e1va53iy2"})("height:1px;overflow:hidden;background-color:",(e=>e.theme.innerBorder),";"),T=(0,r.Z)("div",{target:"e1va53iy1"})({name:"1sl6pdq",styles:"display:flex;justify-content:left;margin-left:18px;height:24px;:hover{cursor:default;}"}),F=(0,r.Z)("span",{target:"e1va53iy0"})({name:"1bmnxg7",styles:"white-space:nowrap"});function C(e){return v.hasOwnProperty(e)?v[e].renderFunc:null}},"./app/utils/useCustomMeasurements.tsx":(e,t,s)=>{s.d(t,{Z:()=>o}),s("../node_modules/core-js/modules/es.error.cause.js");var r=s("../node_modules/react/index.js"),i=s("./app/utils/customMeasurements/customMeasurementsContext.tsx");function o(){const e=(0,r.useContext)(i.z);if(!e)throw new Error("useCustomMeasurements was called outside of CustomMeasurementsProvider");return e}},"./app/views/dashboardsV2/datasetConfig/base.tsx":(e,t,s)=>{s.d(t,{N:()=>p,v:()=>c}),s("../node_modules/core-js/modules/es.array.includes.js");var r=s("../node_modules/lodash/trimStart.js"),i=s.n(r),o=s("./app/utils/discover/fields.tsx"),n=s("./app/views/dashboardsV2/types.tsx"),a=s("./app/views/dashboardsV2/utils.tsx"),l=s("./app/views/dashboardsV2/datasetConfig/errorsAndTransactions.tsx"),d=s("./app/views/dashboardsV2/datasetConfig/issues.tsx"),u=s("./app/views/dashboardsV2/datasetConfig/releases.tsx");function c(e){switch(e){case n.l9.ISSUE:return d.f;case n.l9.RELEASE:return u.u$;case n.l9.DISCOVER:default:return l.g}}function p(e,t){const s=i()(e.orderby,"-"),r=e.orderby.startsWith("-")?"-":"";if(!t.includes(s)&&""!==e.orderby){const i=e.aggregates.includes(s),n=(0,o.GO)(s),l=e.columns.includes(s),d=i||n||l,u=(0,o.GO)(e.aggregates[0]??"")?`equation[${(0,a.yd)(e.aggregates)-1}]`:t[0];e.orderby=d&&e.orderby||`${r}${u}`}return e}},"./app/views/dashboardsV2/datasetConfig/errorsAndTransactions.tsx":(e,t,s)=>{s.d(t,{g:()=>B}),s("../node_modules/core-js/modules/es.array.includes.js");var r=s("../node_modules/lodash/trimStart.js"),i=s.n(r),o=s("./app/actionCreators/events.tsx"),n=s("./app/components/charts/utils.tsx"),a=s("./app/components/links/link.tsx"),l=s("./app/components/tooltip.tsx"),d=s("./app/locale.tsx"),u=s("./app/utils.tsx"),c=s("./app/utils/discover/fieldRenderers.tsx"),p=s("./app/utils/discover/fields.tsx"),m=s("./app/utils/discover/genericDiscoverQuery.tsx"),g=s("./app/utils/discover/styles.tsx"),h=s("./app/utils/discover/types.tsx"),f=s("./app/utils/discover/urls.tsx"),y=s("./app/utils/events.tsx"),v=s("./app/utils/measurements/measurements.tsx"),b=s("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),x=s("./app/views/eventsV2/table/types.tsx"),S=s("./app/views/eventsV2/utils.tsx"),w=s("./app/views/performance/traceDetails/utils.tsx"),E=s("./app/views/performance/utils.tsx"),_=s("./app/views/dashboardsV2/types.tsx"),O=s("./app/views/dashboardsV2/utils.tsx"),j=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),Z=s("./app/components/events/searchBar.tsx"),T=s("./app/constants/index.tsx"),F=s("./app/types/index.tsx"),C=s("./app/utils/useCustomMeasurements.tsx"),R=s("./app/views/dashboardsV2/widgetBuilder/utils.tsx"),D=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function A(e){let{organization:t,pageFilters:s,onClose:r,widgetQuery:i}=e;const{customMeasurements:o}=(0,C.Z)(),n=s.projects,a=(0,O.tT)("",i,s),l=a.hasAggregateField()?(0,p.db)(t,a.fields):a.fields;return(0,D.tZ)(I,{searchSource:"widget_builder",organization:t,projectIds:n,query:i.conditions,fields:l,onClose:r,useFormWrapper:!1,maxQueryLength:T.dI,maxSearchItems:R.yM,maxMenuHeight:R.CD,savedSearchType:F.L4.EVENT,customMeasurements:o})}A.displayName="EventsSearchBar";const I=(0,j.Z)(Z.Z,{target:"e1pc9id60"})({name:"1ff36h2",styles:"flex-grow:1"});var M=s("./app/views/dashboardsV2/widgetBuilder/buildSteps/sortByStep/index.tsx"),L=s("./app/views/dashboardsV2/widgetCard/widgetQueries.tsx");const B={defaultWidgetQuery:{name:"",fields:["count()"],columns:[],fieldAliases:[],aggregates:["count()"],conditions:"",orderby:"-count()"},enableEquations:!0,getCustomFieldRenderer:function(e,t,s){const r=!s?.features.includes("discover-frontend-use-events-endpoint");return"id"===e?N:"trace"===e?k:["title","transaction"].includes(e)?(s,i)=>s[e]===E.og?(0,D.tZ)(g.W2,{children:(0,D.tZ)(a.Z,{to:(0,E.uq)({location:i.location,organization:i.organization,source:E.Pv.DISCOVER}),children:s[e]})}):(0,c.Js)(e,t,r)(s,i):(0,c.Js)(e,t,r)},SearchBar:A,filterSeriesSortOptions:function(e){return t=>t.value.kind===x.L.FUNCTION||t.value.kind===x.L.EQUATION||e.has(t.value.meta.name)||t.value.meta.name===M.E},filterYAxisAggregateParams:function(e,t){return s=>{if(t===_.FO.BIG_NUMBER)return!0;if(e.kind!==x.L.FUNCTION)return!0;const r=e.function[0],i=(0,p.Xh)(r,s.value.meta.name);return i?(0,p.HW)(i):s.value.kind!==x.L.FUNCTION&&s.value.kind!==x.L.EQUATION&&(0,p.HW)(s.value.meta.dataType)}},filterYAxisOptions:function(e){return t=>{if(e!==_.FO.BIG_NUMBER&&t.value.kind===x.L.FUNCTION){const e=(0,p.Xh)(t.value.meta.name,void 0);if(e)return(0,p.HW)(e)}return t.value.kind===x.L.FUNCTION}},getTableFieldOptions:q,getTimeseriesSortOptions:function(e,t,s){const r={};r[`field:${M.E}`]={label:"Custom Equation",value:{kind:x.L.EQUATION,meta:{name:M.E}}};let i=0;[...t.aggregates,...t.columns].filter((e=>!!e)).forEach((e=>{let t;const s=(0,p.bQ)(e);(0,p.GO)(e)&&(t=`equation[${i}]`,i+=1,r[`equation:${t}`]={label:s,value:{kind:x.L.EQUATION,meta:{name:t??e}}})}));const o=q(e,s);return{...r,...o}},getTableSortOptions:function(e,t){const{columns:s,aggregates:r}=t,i=[];let o=0;return[...r,...s].filter((e=>!!e)).forEach((e=>{let t;const s=(0,p.bQ)(e);(0,p.GO)(e)&&(t=`equation[${o}]`,o+=1),i.push({label:s,value:t??e})})),i},getGroupByFieldOptions:q,handleOrderByReset:s("./app/views/dashboardsV2/datasetConfig/base.tsx").N,supportedDisplayTypes:[_.FO.AREA,_.FO.BAR,_.FO.BIG_NUMBER,_.FO.LINE,_.FO.TABLE,_.FO.TOP_N,_.FO.WORLD_MAP],getTableRequest:(e,t,s,r,i,o,n,a)=>P(s.features.includes("discover-frontend-use-events-endpoint")?`/organizations/${s.slug}/events/`:`/organizations/${s.slug}/eventsv2/`,e,t,s,r,i,o,n,a),getSeriesRequest:function(e,t,s,r,n,a,l){const d=t.queries[s],{displayType:c,limit:m}=t,{environments:g,projects:f}=n,{start:y,end:v,period:x}=n.datetime,S=(0,O.s)(c,{start:y,end:v,period:x}),w=(r.features.includes("dashboards-mep")||r.features.includes("mep-rollout-flag"))&&(0,u.ri)(l)&&l!==b.oR.transactionsOnly;let E;if(c===_.FO.TOP_N)E={organization:r,interval:S,start:y,end:v,project:f,environment:g,period:x,query:d.conditions,yAxis:d.aggregates[d.aggregates.length-1],includePrevious:!1,referrer:a,partial:!0,field:[...d.columns,...d.aggregates],queryExtras:(0,O.Gl)(w),includeAllArgs:!0,topEvents:h.hY},d.orderby&&(E.orderby=d.orderby);else if(E={organization:r,interval:S,start:y,end:v,project:f,environment:g,period:x,query:d.conditions,yAxis:d.aggregates,orderby:d.orderby,includePrevious:!1,referrer:a,partial:!0,queryExtras:(0,O.Gl)(w),includeAllArgs:!0},0!==d.columns?.length){E.topEvents=m??h.hY,E.field=[...d.columns,...d.aggregates];const e=i()(d.orderby,"-");if(!d.orderby||(0,p.uI)(e)||E.field.includes(e)||E.field.push(e),E.excludeOther=1!==d.aggregates.length||1!==t.queries.length,(0,p.GO)(i()(d.orderby,"-"))){const e=(0,O.yd)(d.aggregates),t=d.orderby.startsWith("-")?"-":"";E.orderby=`${t}equation[${e}]`,E.field=[...d.columns,...d.aggregates,i()(d.orderby,"-")]}}return(0,o.lI)(e,E)},getWorldMapRequest:(e,t,s,r,i,o,n)=>P(`/organizations/${s.slug}/events-geo/`,e,t,s,r,i,o,n),transformSeries:function(e,t){let s=[];const r=t.name;if((0,n.Xe)(e)){let i=[];i=t.aggregates.length>1&&t.columns.length?(0,L.vD)(e,r):Object.keys(e).map((t=>{const s=r?`${r} : ${t}`:t,i=e[t];return[i.order||0,(0,L.FN)(i,s,t)]})),s=[...i.sort(((e,t)=>e[0]-t[0])).map((e=>e[1]))]}else{const i=t.aggregates[0],o=r?`${r} : ${i}`:i,n=(0,L.FN)(e,o,i);s.push(n)}return s},transformTable:function(e,t,s){let r=e;if(s.features.includes("discover-frontend-use-events-endpoint")){const{fields:t,...s}=e.meta??{};r={...e,meta:{...t,...s}}}return r},filterAggregateParams:function(e,t){return!(e.value.kind===x.L.CUSTOM_MEASUREMENT&&"function"===t?.kind&&t?.function&&!e.value.meta.functions.includes(t.function[0]))},getSeriesResultType:function(e,t){const s=t.aggregates[0],r={};return(0,n.Xe)(e)?Object.keys(e).forEach((t=>r[t]=e[t].meta?.fields[(0,p.LY)(t)])):r[s]=e.meta?.fields[(0,p.LY)(s)],r}};function q(e,t,s){const r=(0,v.i)();return(0,S.R0)({organization:e,tagKeys:Object.values(t??{}).map((e=>{let{key:t}=e;return t})),measurementKeys:Object.values(r).map((e=>{let{key:t}=e;return t})),spanOperationBreakdownKeys:p.$4,customMeasurements:e.features.includes("dashboards-mep")||e.features.includes("mep-rollout-flag")?Object.values(s??{}).map((e=>{let{key:t,functions:s}=e;return{key:t,functions:s}})):void 0})}function N(e,t){let{eventView:s,organization:r}=t;const i=e?.id;if(!s||"string"!=typeof i)return null;const o=(0,f.JE)(e),n=(0,f.eQ)({orgSlug:r.slug,eventSlug:o,eventView:s});return(0,D.tZ)(l.Z,{title:(0,d.t)("View Event"),children:(0,D.tZ)(a.Z,{"data-test-id":"view-event",to:n,children:(0,D.tZ)(g.W2,{children:(0,y.XQ)(i)})})})}function k(e,t){let{eventView:s,organization:r,location:i}=t;const o=e?.trace;if(!s||"string"!=typeof o)return null;const n=s.normalizeDateSelection(i),u=(0,w.YA)(r,String(e.trace),n,{});return(0,D.tZ)(l.Z,{title:(0,d.t)("View Trace"),children:(0,D.tZ)(a.Z,{"data-test-id":"view-trace",to:u,children:(0,D.tZ)(g.W2,{children:(0,y.XQ)(o)})})})}function P(e,t,s,r,i,o,n,a,l){const d=(r.features.includes("dashboards-mep")||r.features.includes("mep-rollout-flag"))&&(0,u.ri)(l)&&l!==b.oR.transactionsOnly,c=(0,O.tT)("",s,i),p={per_page:o,cursor:n,referrer:a,...(0,O.Gl)(d)};return s.orderby&&(p.sort="string"==typeof s.orderby?[s.orderby]:s.orderby),(0,m.AA)(t,e,{...c.generateQueryStringObject(),...p})}N.displayName="renderEventIdAsLinkable",k.displayName="renderTraceAsLinkable"},"./app/views/dashboardsV2/datasetConfig/issues.tsx":(e,t,s)=>{s.d(t,{f:()=>E}),s("../node_modules/core-js/modules/es.array.includes.js");var r=s("./app/components/searchSyntax/parser.tsx"),i=s("./app/locale.tsx"),o=s("./app/stores/groupStore.tsx"),n=s("./app/utils/dashboards/issueFieldRenderers.tsx"),a=s("./app/utils/dates.tsx"),l=s("./app/views/issueList/utils.tsx"),d=s("./app/views/dashboardsV2/types.tsx"),u=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),c=s("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),p=s("./app/views/dashboardsV2/widgetBuilder/utils.tsx"),m=s("./app/views/issueList/searchBar.tsx"),g=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function h(e){let{onClose:t,widgetQuery:s,organization:r}=e;return(0,g.tZ)(c.ms,{children:e=>{let{css:o}=e;return(0,g.tZ)(f,{searchSource:"widget_builder",organization:r,query:s.conditions||"",onClose:t,placeholder:(0,i.t)("Search for issues, status, assigned, and more"),maxSearchItems:p.yM,dropdownClassName:o`
            max-height: ${p.CD}px;
            overflow-y: auto;
          `})}})}h.displayName="IssuesSearchBar";const f=(0,u.Z)(m.Z,{target:"ewve4jj0"})({name:"1hoyb5r",styles:"flex-grow:1;button:not([aria-label='Clear search']){display:none;}"});var y=s("./app/views/dashboardsV2/widgetBuilder/issueWidget/fields.tsx"),v=s("./app/views/eventsV2/table/types.tsx");const b=[l.qh.DATE,l.qh.NEW,l.qh.FREQ,l.qh.PRIORITY,l.qh.USER],x={name:"",fields:["issue","assignee","title"],columns:["issue","assignee","title"],fieldAliases:[],aggregates:[],conditions:"",orderby:l.qh.DATE},S=l.qh.DATE,w=["owners"],E={defaultWidgetQuery:x,enableEquations:!1,disableSortOptions:function(e){return{disableSort:!1,disableSortDirection:!0,disableSortReason:(0,i.t)("Issues dataset does not yet support descending order")}},getTableRequest:function(e,t,s,r,i,o){const n=`/organizations/${s.slug}/issues/`,l={project:r.projects??[],environment:r.environments??[],query:t.conditions,sort:t.orderby||S,expand:w,limit:i??d.$V,cursor:o};return r.datetime.period&&(l.statsPeriod=r.datetime.period),r.datetime.end&&(l.end=(0,a.v5)(r.datetime.end)),r.datetime.start&&(l.start=(0,a.v5)(r.datetime.start)),r.datetime.utc&&(l.utc=r.datetime.utc),e.requestPromise(n,{includeAllArgs:!0,method:"GET",data:{...l}})},getCustomFieldRenderer:n.O,SearchBar:h,getTableSortOptions:function(e,t){const s=[...b];return e.features.includes("issue-list-trend-sort")&&s.push(l.qh.TREND),s.map((e=>({label:(0,l._k)(e),value:e})))},getTableFieldOptions:e=>function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y.$L;const t=Object.keys(e).sort(),s={};return t.forEach((t=>{s[`field:${t}`]={label:t,value:{kind:v.L.FIELD,meta:{name:t,dataType:e[t]}}}})),s}(),fieldHeaderMap:y.kh,supportedDisplayTypes:[d.FO.TABLE],transformTable:function(e,t,s,i){o.Z.add(e);const n=[];return e.forEach((e=>{let{id:s,shortId:o,title:d,lifetime:u,filtered:c,count:p,userCount:m,project:g,annotations:h,...f}=e;const y={};Object.keys(f).filter((e=>["number","string"].includes(typeof f[e]))).forEach((e=>{y[e]=f[e]}));const v={...y,events:p,users:m,id:s,"issue.id":s,issue:o,title:d,project:g.slug,links:h?.join(", ")};u&&(v.lifetimeEvents=u?.count,v.lifetimeUsers=u?.userCount),c&&(v.filteredEvents=c?.count,v.filteredUsers=c?.userCount);const b=t.conditions,x=(0,r.UG)(b)?.filter((e=>!(e.type===r.WU.Filter&&l.QL.includes(e.key.text))));v.discoverSearchQuery=(0,r.D3)(x,!0),v.projectId=g.id;const{period:S,start:w,end:E}=i.datetime||{};w&&E&&(v.start=(0,a.v5)(w),v.end=(0,a.v5)(E)),v.period=S??"",n.push(v)})),{data:n}}}},"./app/views/dashboardsV2/datasetConfig/releases.tsx":(e,t,s)=>{s.d(t,{u$:()=>P}),s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/core-js/modules/es.error.cause.js");var r=s("../node_modules/lodash/omit.js"),i=s.n(r),o=s("../node_modules/lodash/trimStart.js"),n=s.n(o),a=s("./app/components/charts/utils.tsx"),l=s("./app/components/organizations/pageFilters/parse.tsx"),d=s("./app/utils.tsx");const u=(e,t)=>{let{field:s,orgSlug:r,cursor:i,environment:o,groupBy:n,includeSeries:u,includeTotals:c,interval:p,limit:m,orderBy:g,project:h,query:f,includeAllArgs:y=!1,statsPeriodStart:v,statsPeriodEnd:b,...x}=t;const{start:S,end:w,statsPeriod:E}=(0,l.fK)(x,{allowEmptyPeriod:!0}),_=Object.fromEntries(Object.entries({field:s.filter((e=>!!e)),cursor:i,end:w,environment:o,groupBy:n?.filter((e=>!!e)),includeSeries:u,includeTotals:c,interval:p||(0,a.ZS)({start:S,end:w,period:E}),query:f||void 0,per_page:m,project:h,orderBy:g,start:S,statsPeriod:E,statsPeriodStart:v,statsPeriodEnd:b}).filter((e=>{let[,t]=e;return(0,d.ri)(t)&&""!==t}))),O=`/organizations/${r}/metrics/data/`;return e.requestPromise(O,{includeAllArgs:y,query:_})},c=(e,t)=>{let{field:s,orgSlug:r,cursor:i,environment:o,groupBy:n,interval:u,project:c,orderBy:p,query:m,includeAllArgs:g=!1,statsPeriodStart:h,statsPeriodEnd:f,limit:y,...v}=t;const{start:b,end:x,statsPeriod:S}=(0,l.fK)(v,{allowEmptyPeriod:!0}),w=Object.fromEntries(Object.entries({field:s.filter((e=>!!e)),cursor:i,end:x,environment:o,groupBy:n?.filter((e=>!!e)),interval:u||(0,a.ZS)({start:b,end:x,period:S}),orderBy:p,per_page:y,query:m||void 0,project:c,start:b,statsPeriod:S,statsPeriodStart:h,statsPeriodEnd:f}).filter((e=>{let[,t]=e;return(0,d.ri)(t)&&""!==t})));return e.requestPromise(`/organizations/${r}/sessions/`,{includeAllArgs:g,query:w})};var p=s("./app/locale.tsx"),m=s("./app/types/index.tsx"),g=s("./app/utils/dates.tsx"),h=s("./app/utils/discover/fieldRenderers.tsx"),f=s("./app/views/eventsV2/table/types.tsx"),y=s("./app/views/dashboardsV2/types.tsx"),v=s("./app/views/dashboardsV2/utils.tsx"),b=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),x=s("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),S=s("../node_modules/lodash/memoize.js"),w=s.n(S),E=s("./app/actionCreators/tags.tsx"),_=s("./app/components/smartSearchBar/index.tsx"),O=s("./app/constants/index.tsx"),j=s("./app/utils/useApi.tsx"),Z=s("./app/views/dashboardsV2/widgetBuilder/utils.tsx"),T=s("./app/views/dashboardsV2/widgetBuilder/releaseWidget/fields.tsx"),F=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const C=new RegExp(`^${O.c$}|\\${O.ir}`,"g");function R(e){let{organization:t,pageFilters:s,widgetQuery:r,onClose:i}=e;const o=t.slug,n=s.projects,a=(0,j.Z)();function l(e){return e.replace(C,"")}function d(e,t){if("session.status"===e.name)return Promise.resolve(T._I);const s=n?.map(String);return(0,E.Fo)({api:a,orgSlug:o,tagKey:e.key,search:t,projectIds:s,includeTransactions:!0}).then((e=>e.map((e=>{let{value:t}=e;return t}))),(()=>{throw new Error("Unable to fetch tag values")}))}const u=Object.values(T.Wt).reduce(((e,t)=>(e[t]={key:t,name:t},e)),{});return(0,F.tZ)(x.ms,{children:e=>{let{css:t}=e;return(0,F.tZ)(D,{onGetTagValues:w()(d,((e,t)=>{let{key:s}=e;return`${s}-${t}`})),supportedTags:u,placeholder:(0,p.t)("Search for release version, session status, and more"),prepareQuery:l,dropdownClassName:t`
            max-height: ${Z.CD??300}px;
            overflow-y: auto;
          `,onClose:i,maxQueryLength:O.dI,maxSearchItems:Z.yM,searchSource:"widget_builder",query:r.conditions,savedSearchType:m.L4.SESSION,hasRecentSearches:!0,highlightUnsupportedTags:!0})}})}R.displayName="ReleaseSearchBar";const D=(0,b.Z)(_.Z,{target:"ei7lnmi0"})({name:"1ff36h2",styles:"flex-grow:1"});var A=s("./app/views/dashboardsV2/widgetCard/releaseWidgetQueries.tsx");function I(e,t,s){const r=Object.entries(t.by).map((e=>{let[t,s]=e;return`${s}`})).join(", ");return`${s?`${s} > `:""}${r?`${r} : ${(0,A.nD)(e)}`:(0,A.nD)(e)}`}var M=s("./app/utils/discover/fields.tsx");function L(e){const t={};for(const[s,r]of Object.entries(e))t[(0,A.nD)(s)]=r;return t}function B(e,t,s){const r={};return s.length?(void 0===e["session.status"]||s.forEach((s=>{const i=s.match(T.$4);i&&(e["session.status"]===i[1]?"session"===i[2]?r[s]=t["sum(session)"]:"user"===i[2]&&(r[s]=t["count_unique(user)"]):r[s]=0)})),r):r}var q=s("./app/views/dashboardsV2/datasetConfig/base.tsx");const N={name:"",fields:[`crash_free_rate(${m.r2.SESSION})`],columns:[],fieldAliases:[],aggregates:[`crash_free_rate(${m.r2.SESSION})`],conditions:"",orderby:`-crash_free_rate(${m.r2.SESSION})`},k=new Date("2022-07-12"),P={defaultWidgetQuery:N,enableEquations:!1,disableSortOptions:function(e){const{columns:t}=e;return t.includes("session.status")?{disableSort:!0,disableSortDirection:!0,disableSortReason:(0,p.t)("Sorting currently not supported with session.status")}:{disableSort:!1,disableSortDirection:!1}},getTableRequest:(e,t,s,r,i,o)=>z(0,1,e,t,s,r,void 0,i,o),getSeriesRequest:function(e,t,s,r,i){const o=t.queries[s],{displayType:n,limit:a}=t,{datetime:l}=i,{start:d,end:u,period:c}=l,p=(0,A.Vl)(o);return z(1,o.columns.length>0?1:0,e,o,r,i,(0,v.s)(n,{start:d,end:u,period:c},"5m",p?"low":void 0),a)},getTableSortOptions:function(e,t){const{columns:s,aggregates:r}=t,i=[];return[...r,...s].filter((e=>!!e)).filter((e=>!T.d2.includes(e))).filter((e=>!T.aE.includes(e))).forEach((e=>{i.push({label:e,value:e})})),i},getTimeseriesSortOptions:function(e,t){const s=new Set(t.columns),r=(0,T.e1)(Object.values(T.Jo),T.ve),i={};return Object.entries(r).forEach((e=>{let[t,r]=e;["count_healthy","count_errored"].includes(r.value.meta.name)||(r.value.kind!==f.L.FIELD||"release"===r.value.meta.name&&s.has(r.value.meta.name))&&(i[t]=r)})),i},filterTableOptions:V,filterAggregateParams:$,filterYAxisAggregateParams:(e,t)=>$,filterYAxisOptions:function(e){return e=>[f.L.FUNCTION,f.L.NUMERIC_METRICS].includes(e.value.kind)},getCustomFieldRenderer:(e,t)=>(0,h.Js)(e,t,!1),SearchBar:R,getTableFieldOptions:function(e){return(0,T.e1)(Object.values(T.Jo),T.ve)},getGroupByFieldOptions:e=>(0,T.e1)([],T.ve),handleColumnFieldChangeOverride:function(e){if(0===e.aggregates.length){const t=`crash_free_rate(${m.r2.SESSION})`;e.aggregates=[t],e.fields=e.fields?[...e.fields,t]:[t]}return e},handleOrderByReset:function(e,t){return e.columns.includes("session.status")&&(e.orderby=""),(0,q.N)(e,t)},filterSeriesSortOptions:function(e){return t=>!["count_healthy","count_errored"].includes(t.value.meta.name)&&(t.value.kind===f.L.FIELD?e.has(t.value.meta.name)&&"release"===t.value.meta.name:V(t))},supportedDisplayTypes:[y.FO.AREA,y.FO.BAR,y.FO.BIG_NUMBER,y.FO.LINE,y.FO.TABLE,y.FO.TOP_N],transformSeries:function(e,t){if(null===e)return[];const s=t.name,r=t.columns.includes("session.status"),{derivedStatusFields:i,injectedFields:o}=(0,A.gp)(t.aggregates,t.orderby,r),n=[];return e.groups.length?(e.groups.forEach((t=>{Object.keys(t.series).forEach((r=>{o.includes((0,A.nD)(r))||n.push({seriesName:I(r,t,s),data:e.intervals.map(((e,s)=>({name:e,value:t.series[r][s]??0})))})})),i.length&&(0,d.ri)(t.by["session.status"])&&i.forEach((r=>{const i=r.match(T.$4);if(i){let o;t.by["session.status"]===i[1]&&("session"===i[2]?o="sum(session)":"user"===i[2]&&(o="count_unique(user)")),n.push({seriesName:I(r,t,s),data:e.intervals.map(((e,s)=>({name:e,value:o?t.series[o][s]??0:0})))})}}))})),n):[{seriesName:`(${(0,p.t)("no results")})`,data:e.intervals.map((e=>({name:e,value:0})))}]},transformTable:function(e,t){const s=t.columns.includes("session.status"),{derivedStatusFields:r,injectedFields:o}=(0,A.gp)(t.aggregates,t.orderby,s),n=e.groups.map(((e,t)=>({id:String(t),...L(e.by),...i()(L(e.totals),o),...B(e.by,e.totals,r)}))),a=n[0];return{meta:{...(l=i()(a,"id"),Object.keys(l??{}).reduce(((e,t)=>(e[t]=T.ve.includes(t)?"string":(0,M.Px)(t),e)),{}))},data:n};var l}};function V(e){return[f.L.FUNCTION,f.L.FIELD,f.L.NUMERIC_METRICS].includes(e.value.kind)}function $(e){return e.value.kind===f.L.METRICS}function U(e){return T.wg[e]??e}function z(e,t,s,r,i,o,a,l,d){const{environments:m,projects:h,datetime:f}=o,{start:y,end:v,period:b}=f;let x=!1;if(y){let e;e="string"==typeof y?new Date(y):y,x=e<k}else if(b){const e=(0,g.Ri)(b),t=new Date;x=new Date((new Date).setDate(t.getDate()-e))<k}if(x)return Promise.reject(new Error((0,p.t)("Releases data is only available from Jul 12. Please retry your query with a more recent date range.")));const S=r.columns.includes("session.status"),w=(0,A.Vl)(r),E=r.orderby.startsWith("-"),_=n()(r.orderby,"-"),O=T.d2.includes(_)||S||"release"===_,j=r.columns,{aggregates:Z,injectedFields:F}=(0,A.gp)(r.aggregates,r.orderby,S);let C,R;return S?(C={field:Z.filter((e=>!Object.values(T.Xg).includes(e))),orgSlug:i.slug,end:v,environment:m,groupBy:j,limit:void 0,orderBy:"",interval:a,project:h,query:r.conditions,start:y,statsPeriod:b,includeAllArgs:!0,cursor:d},R=c):(C={field:Z.map(U),orgSlug:i.slug,end:v,environment:m,groupBy:j.map(U),limit:0===j.length?1:w?100:l,orderBy:O?"":E?`-${U(_)}`:U(_),interval:a,project:h,query:r.conditions,start:y,statsPeriod:b,includeAllArgs:!0,cursor:d,includeSeries:e,includeTotals:t},R=u,!_||O||Z.includes(_)||j.includes(_)||(C.field=[...C.field,U(_)],F.includes(_)||F.push(_))),R(s,C)}},"./app/views/dashboardsV2/widgetBuilder/buildSteps/buildStep.tsx":(e,t,s)=>{s.d(t,{F:()=>a});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=s("./app/components/list/listItem.tsx"),o=s("./app/styles/space.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a(e){let{title:t,description:s,required:r=!1,children:i}=e;return(0,n.BX)(l,{children:[(0,n.BX)(d,{children:[t,r&&(0,n.tZ)(p,{})]}),(0,n.tZ)(u,{children:s}),(0,n.tZ)(c,{children:i})]})}a.displayName="BuildStep";const l=(0,r.Z)(i.Z,{target:"ecpormx4"})({name:"vetbs0",styles:"display:grid"}),d=(0,r.Z)("h5",{target:"ecpormx3"})("margin-bottom:0;color:",(e=>e.theme.gray500),";"),u=(0,r.Z)("small",{target:"ecpormx2"})("color:",(e=>e.theme.gray300),";padding:",(0,o.Z)(.25)," ",(0,o.Z)(2)," ",(0,o.Z)(2)," 0;@media (max-width: ",(e=>e.theme.breakpoints.small),"){padding-top:",(0,o.Z)(1),";margin-left:-",(0,o.Z)(4),";}"),c=(0,r.Z)("div",{target:"ecpormx1"})("display:grid;@media (max-width: ",(e=>e.theme.breakpoints.small),"){margin-left:-",(0,o.Z)(4),";}"),p=(0,r.Z)("div",{target:"ecpormx0"})("background:",(e=>e.theme.red300),";opacity:0.6;width:5px;height:5px;border-radius:5px;margin-left:",(0,o.Z)(.5),";display:inline-block;vertical-align:super;")},"./app/views/dashboardsV2/widgetBuilder/buildSteps/sortByStep/index.tsx":(e,t,s)=>{s.d(t,{E:()=>j,j:()=>Z});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),o=s("../node_modules/lodash/trimStart.js"),n=s.n(o),a=s("./app/components/forms/controls/selectControl.tsx"),l=s("./app/components/forms/field/index.tsx"),d=s("./app/components/tooltip.tsx"),u=s("./app/locale.tsx"),c=s("./app/styles/space.tsx"),p=s("./app/views/dashboardsV2/datasetConfig/base.tsx"),m=s("./app/views/dashboardsV2/types.tsx"),g=s("./app/views/dashboardsV2/widgetBuilder/utils.tsx"),h=s("./app/views/dashboardsV2/widgetBuilder/buildSteps/buildStep.tsx"),f=s("../node_modules/lodash/uniqBy.js"),y=s.n(f),v=s("./app/utils/discover/fields.tsx"),b=s("./app/utils/useOrganization.tsx"),x=s("./app/views/eventsV2/table/arithmeticInput.tsx"),S=s("./app/views/eventsV2/table/queryField.tsx"),w=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function E(e){let{values:t,widgetType:s,onChange:r,disableSortReason:o,disableSort:l,disableSortDirection:c,widgetQuery:h,displayType:f}=e;const E=(0,p.v)(s),Z=(0,b.Z)(),T=new Set(h.columns),[F,C]=(0,i.useState)(!1),[R,D]=(0,i.useState)({sortBy:`${v.qe}`,sortDirection:t.sortDirection});return(0,i.useEffect)((()=>{const e=(0,v.GO)(n()(t.sortBy,"-"));e&&D({sortBy:n()(t.sortBy,"-"),sortDirection:t.sortDirection}),C(e)}),[t.sortBy,t.sortDirection]),(0,w.BX)(_,{children:[(0,w.tZ)(d.Z,{title:o,disabled:!c||c&&l,children:(0,w.tZ)(a.Z,{name:"sortDirection","aria-label":"Sort direction",menuPlacement:"auto",disabled:c,options:Object.keys(g.Qj).map((e=>({label:g.Qj[e],value:e}))),value:t.sortDirection,onChange:e=>{r({sortBy:t.sortBy,sortDirection:e.value})}})}),(0,w.tZ)(d.Z,{title:o,disabled:!l||c&&l,children:f===m.FO.TABLE?(0,w.tZ)(a.Z,{name:"sortBy","aria-label":"Sort by",menuPlacement:"auto",disabled:l,placeholder:`${(0,u.t)("Select a column")}â€¦`,value:t.sortBy,options:y()(E.getTableSortOptions(Z,h),(e=>{let{value:t}=e;return t})),onChange:e=>{r({sortBy:e.value,sortDirection:t.sortDirection})}}):(0,w.tZ)(S.q,{disabled:l,fieldValue:F?(0,v.HM)({field:j}):(0,v.HM)({field:t.sortBy}),fieldOptions:E.getTimeseriesSortOptions(Z,h),filterPrimaryOptions:E.filterSeriesSortOptions?E.filterSeriesSortOptions(T):void 0,filterAggregateParameters:E.filterAggregateParams,onChange:e=>{if(e.alias&&(0,v.uI)(e.alias))return void r({sortBy:e.alias,sortDirection:t.sortDirection});const s=(0,v.sN)(e),i=(0,v.GO)(s);C(i),r(i?R:{sortBy:s,sortDirection:t.sortDirection})}})}),F&&(0,w.tZ)(O,{children:(0,w.tZ)(x.Z,{name:"arithmetic",type:"text",required:!0,placeholder:(0,u.t)("Enter Equation"),value:(0,v.vp)(R.sortBy),onUpdate:e=>{const s={sortBy:`${v.qe}${e}`,sortDirection:t.sortDirection};r(s),D(s)},hideFieldOptions:!0})})]})}E.displayName="SortBySelectors";const _=(0,r.Z)("div",{target:"e1grfh1l1"})("display:grid;gap:",(0,c.Z)(1),";@media (min-width: ",(e=>e.theme.breakpoints.small),"){grid-template-columns:200px 1fr;}"),O=(0,r.Z)("div",{target:"e1grfh1l0"})({name:"18iuzk9",styles:"grid-column:1/-1"}),j="custom-equation";function Z(e){let{displayType:t,onSortByChange:s,queries:r,widgetType:o,error:a,limit:c,onLimitChange:f,tags:y}=e;const v=(0,p.v)(o);let b,x=!1,S=!1;v.disableSortOptions&&({disableSort:x,disableSortDirection:S,disableSortReason:b}=v.disableSortOptions(r[0]));const _=r[0].orderby,O=n()(_,"-"),j=(0,g.oA)(r.length,r[0].aggregates.length),Z=[m.FO.LINE,m.FO.BAR,m.FO.AREA].includes(t);return(0,i.useEffect)((()=>{c&&c>j&&f(j)}),[c,j,f]),(0,w.tZ)(h.F,{title:t===m.FO.TABLE?(0,u.t)("Sort by a column"):(0,u.t)("Sort by a y-axis"),description:t===m.FO.TABLE?(0,u.t)("Choose one of the columns you've created to sort by."):(0,u.t)("Choose one of the y-axis you've created to sort by."),children:(0,w.tZ)(d.Z,{title:b,disabled:!(S&&x),children:(0,w.BX)(l.Z,{inline:!1,error:a,flexibleControlStateSize:!0,stacked:!0,children:[[m.FO.AREA,m.FO.BAR,m.FO.LINE].includes(t)&&c&&(0,w.tZ)(T,{disabled:S&&x,name:"resultsLimit",menuPlacement:"auto",options:[...Array(j).keys()].map((e=>{const t=e+1;return{label:(0,u.tn)("Limit to %s result","Limit to %s results",t),value:t}})),value:c,onChange:e=>{f(e.value)}}),(0,w.tZ)(E,{displayType:t,widgetType:o,hasGroupBy:Z&&!!r[0].columns.length,disableSortReason:b,disableSort:x,disableSortDirection:S,widgetQuery:r[0],values:{sortDirection:"-"===_[0]?g.Sr.HIGH_TO_LOW:g.Sr.LOW_TO_HIGH,sortBy:O},onChange:e=>{let{sortDirection:t,sortBy:r}=e;const i=t===g.Sr.HIGH_TO_LOW?`-${r}`:r;s(i)},tags:y})]})})})}Z.displayName="SortByStep";const T=(0,r.Z)(a.Z,{target:"e14t0x3e0"})("margin-bottom:",(0,c.Z)(1),";")},"./app/views/dashboardsV2/widgetBuilder/issueWidget/fields.tsx":(e,t,s)=>{let r;s.d(t,{$L:()=>i,Sh:()=>r,kh:()=>o}),function(e){e.ASSIGNEE="assignee",e.TITLE="title",e.ISSUE="issue",e.LEVEL="level",e.STATUS="status",e.PLATFORM="platform",e.IS_BOOKMARKED="isBookmarked",e.IS_SUBSCRIBED="isSubscribed",e.IS_HANDLED="isHandled",e.LAST_SEEN="lastSeen",e.FIRST_SEEN="firstSeen",e.EVENTS="events",e.USERS="users",e.LIFETIME_EVENTS="lifetimeEvents",e.LIFETIME_USERS="lifetimeUsers",e.PROJECT="project",e.LINKS="links"}(r||(r={}));const i={[r.ASSIGNEE]:"string",[r.TITLE]:"string",[r.ISSUE]:"string",[r.LEVEL]:"string",[r.STATUS]:"string",[r.PLATFORM]:"string",[r.IS_BOOKMARKED]:"boolean",[r.IS_SUBSCRIBED]:"boolean",[r.IS_HANDLED]:"boolean",[r.LAST_SEEN]:"date",[r.FIRST_SEEN]:"date",[r.EVENTS]:"string",[r.USERS]:"string",[r.LIFETIME_EVENTS]:"string",[r.LIFETIME_USERS]:"string",[r.PROJECT]:"string",[r.LINKS]:"string"},o={[r.LIFETIME_EVENTS]:"Lifetime Events",[r.LIFETIME_USERS]:"Lifetime Users"}},"./app/views/dashboardsV2/widgetBuilder/utils.tsx":(e,t,s)=>{s.d(t,{CD:()=>Z,Qj:()=>b,Sr:()=>v,V0:()=>F,Zi:()=>E,_4:()=>w,_k:()=>h,eQ:()=>_,hV:()=>x,i0:()=>f,oA:()=>T,qg:()=>y,wc:()=>S,yM:()=>j}),s("../node_modules/core-js/modules/es.array.includes.js");var r=s("../node_modules/lodash/cloneDeep.js"),i=s.n(r),o=s("../node_modules/lodash/isEqual.js"),n=s.n(o),a=s("../node_modules/lodash/trimStart.js"),l=s.n(a),d=s("./app/locale.tsx"),u=s("./app/utils/discover/fields.tsx"),c=s("./app/views/dashboardsV2/types.tsx"),p=(s("./app/views/eventsV2/table/types.tsx"),s("./app/views/eventsV2/utils.tsx"),s("./app/views/issueList/utils.tsx")),m=s("./app/views/dashboardsV2/utils.tsx"),g=s("./app/views/dashboardsV2/widgetBuilder/releaseWidget/fields.tsx");const h=5,f="new";let y,v;!function(e){e.EVENTS="events",e.ISSUES="issues",e.RELEASES="releases"}(y||(y={})),function(e){e.HIGH_TO_LOW="high_to_low",e.LOW_TO_HIGH="low_to_high"}(v||(v={}));const b={[v.HIGH_TO_LOW]:(0,d.t)("High to low"),[v.LOW_TO_HIGH]:(0,d.t)("Low to high")},x={[c.FO.AREA]:(0,d.t)("Area Chart"),[c.FO.BAR]:(0,d.t)("Bar Chart"),[c.FO.LINE]:(0,d.t)("Line Chart"),[c.FO.TABLE]:(0,d.t)("Table"),[c.FO.WORLD_MAP]:(0,d.t)("World Map"),[c.FO.BIG_NUMBER]:(0,d.t)("Big Number")};function S(e,t){return Object.keys(e).forEach((s=>{const r=e[s];"string"!=typeof r?Array.isArray(r)&&"string"==typeof r[0]?t[s]=r[0]:Array.isArray(r)&&"object"==typeof r[0]?t[s]=r.map((e=>S(e,{}))):t[s]=S(r,{}):t[s]=r})),t}const w=e=>{let{aggregates:t,columns:s,widgetType:r}=e;const i=r===c.l9.RELEASE,o=[];let n=0;return(i?[...t.map(u.hr),...s]:[...t,...s]).filter((e=>!!e)).filter((e=>!g.d2.includes(e))).filter((e=>!i||!g.aE.includes(e))).forEach((e=>{let t;const s=(0,u.bQ)(e);(0,u.GO)(e)&&(t=`equation[${n}]`,n+=1),o.push({label:s,value:t??e})})),o};function E(e){let{displayType:t,queries:s,widgetType:r}=e;const o=F(t),a=[c.FO.TABLE,c.FO.TOP_N].includes(t);if(s=i()(s),[c.FO.TABLE,c.FO.WORLD_MAP,c.FO.BIG_NUMBER].includes(t)?s=s.slice(0,1):o&&(s=s.slice(0,3)),s=s.map((e=>{const{fields:i=[],columns:o}=e;if(e.fields=a?[...new Set([...i,...o])]:i.filter((e=>!o.includes(e))),F(t)&&!e.columns.filter((e=>!!e)).length)return e.orderby="",e;const n=r===c.l9.RELEASE?(0,u.hr)(s[0].orderby):s[0].orderby,d=l()(n,"-"),g=!(a&&(0,u.GO)(d)||!(0,u.GO)(d)&&!(0,u.uI)(d)&&![...e.columns,...e.aggregates].includes(d)||(0,u.uI)(d)&&(0,u.G5)(d)>(0,m.yd)([...e.columns,...e.aggregates])-1)&&l()(n,"-")||(r===c.l9.ISSUE?n??p.qh.DATE:w({widgetType:r??c.l9.DISCOVER,columns:s[0].columns,aggregates:s[0].aggregates})[0].value),h=!e.orderby||r!==c.l9.ISSUE&&n.startsWith("-");return e.orderby=h?`-${String(g)}`:String(g),e})),a)return s;if(s=s.map((e=>{let s=e.aggregates;return(o||t===c.FO.WORLD_MAP)&&(s=s.filter((e=>(0,u.HW)((0,u.Px)(e))))),o&&s.length&&s.length>3&&(s=s.slice(0,3)),{...e,fields:s.length?s:["count()"],columns:e.columns?e.columns:[],aggregates:s.length?s:["count()"]}})),o){const e=[...s[0].aggregates];e:for(const t of s){if(e.length>=3)break;if(!n()(e,t.aggregates))for(const s of t.aggregates){if(e.length>=3)break e;e.includes(s)||e.push(s)}}s=s.map((t=>({...t,columns:t.columns?t.columns:[],aggregates:e,fields:e})))}return[c.FO.WORLD_MAP,c.FO.BIG_NUMBER].includes(t)&&(s=s.map((e=>({...e,fields:e.aggregates.slice(0,1),aggregates:e.aggregates.slice(0,1),orderby:"",columns:[]})))),s}function _(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const t=new URLSearchParams(e),s=Object.fromEntries(t.entries());if(!Object.keys(s).length)return;const r=s.columns?O(s.columns):[],i=s.aggregates?O(s.aggregates):[],o=[...r,...i];return{...s,fields:o,columns:r,aggregates:i}}function O(e){return e.split(/,(?![^(]*\))/g)}const j=5,Z=250;function T(e,t){return 0===e||0===t?h:Math.floor(10/(e*t))}function F(e){return[c.FO.LINE,c.FO.AREA,c.FO.BAR].includes(e)}},"./app/views/dashboardsV2/widgetCard/dashboardsMEPContext.tsx":(e,t,s)=>{s.d(t,{HH:()=>l,KC:()=>u,XA:()=>a,k:()=>d});var r=s("../node_modules/react/index.js"),i=s("./app/utils/performance/contexts/utils.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const[n,a,l]=(0,i.n)({name:"DashboardsMEPContext"}),d=l.Consumer;function u(e){let{children:t}=e;const[s,i]=(0,r.useState)(void 0);return(0,o.tZ)(n,{value:{isMetricsData:s,setIsMetricsData:i},children:t})}u.displayName="DashboardsMEPProvider"},"./app/views/dashboardsV2/widgetCard/genericWidgetQueries.tsx":(e,t,s)=>{s.d(t,{Z:()=>g});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=(s("../node_modules/core-js/modules/es.error.cause.js"),s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),o=s("../node_modules/lodash/cloneDeep.js"),n=s.n(o),a=s("../node_modules/lodash/isEqual.js"),l=s.n(a),d=s("./app/components/organizations/pageFilters/utils.tsx"),u=s("./app/locale.tsx"),c=s("./app/views/dashboardsV2/types.tsx");function p(e){let t="";return t=e===c.FO.TABLE?"api.dashboards.tablewidget":e===c.FO.BIG_NUMBER?"api.dashboards.bignumberwidget":e===c.FO.WORLD_MAP?"api.dashboards.worldmapwidget":`api.dashboards.widget.${e}-chart`,t}class m extends i.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{loading:!0,queryFetchID:void 0,errorMessage:void 0,timeseriesResults:void 0,rawResults:void 0,tableResults:void 0,pageLinks:void 0,timeseriesResultsTypes:void 0}),(0,r.Z)(this,"_isMounted",!1)}componentDidMount(){this._isMounted=!0,this.props.loading||this.fetchData()}componentDidUpdate(e){const{selection:t,widget:s,cursor:r,organization:i,config:o,customDidUpdateComparator:n}=this.props,[a,u]=e.widget.queries.map((e=>(e.aggregates=e.aggregates.filter((e=>!!e)),e.columns=e.columns.filter((e=>!!e)),e))).reduce(((e,t)=>{let[s,r]=e,{name:i,...o}=t;return s.push(i),r.push(o),[s,r]}),[[],[]]),[c,p]=s.queries.map((e=>(e.aggregates=e.aggregates.filter((e=>!!e&&"equation|"!==e)),e.columns=e.columns.filter((e=>!!e&&"equation|"!==e)),e))).reduce(((e,t)=>{let[s,r]=e,{name:i,...o}=t;return s.push(i),r.push(o),[s,r]}),[[],[]]);(n?!n(e,this.props):s.limit===e.widget.limit&&l()(s.displayType,e.widget.displayType)&&l()(s.interval,e.widget.interval)&&l()(p,u)&&l()(this.props.dashboardFilters,e.dashboardFilters)&&(0,d.WO)(t,e.selection)&&r===e.cursor)?this.state.loading||l()(a,c)||this.state.rawResults?.length!==s.queries.length||this.setState((e=>{const t=s.queries.reduce(((t,s,r)=>t.concat(o.transformSeries(e.rawResults[r],s,i))),[]);return{...e,timeseriesResults:t}})):this.fetchData()}componentWillUnmount(){this._isMounted=!1}applyDashboardFilters(e){const{dashboardFilters:t}=this.props;let s="";if(t)for(const[e,r]of Object.entries(t))1===r.length?s+=`${e}:${r[0]} `:r.length>1&&(s+=`${e}:[${r.join(",")}] `);return e.queries.forEach((e=>{e.conditions=e.conditions+(""===s?"":` ${s}`)})),e}async fetchTableData(e){const{widget:t,limit:s,config:r,api:i,organization:o,selection:a,cursor:l,afterFetchTableData:d,onDataFetched:m,mepSetting:g}=this.props,h=this.applyDashboardFilters(n()(t)),f=await Promise.all(h.queries.map((e=>{let t=s??c.$V,n=r.getTableRequest;if(h.displayType===c.FO.WORLD_MAP&&(t=void 0,n=r.getWorldMapRequest),!n)throw new Error((0,u.t)("This display type is not supported by the selected dataset."));return n(i,e,o,a,t,l,p(h.displayType),g)})));let y,v,b=[];f.forEach(((e,t)=>{let[s,i,n]=e;v=d?.(s,n)??{};const l=r.transformTable(s,h.queries[0],o,a);l.title=h.queries[t]?.name??"",b=[...b,l],y=(n?.getResponseHeader("Link")||n?.getResponseHeader("link"))??void 0})),this._isMounted&&this.state.queryFetchID===e&&(m?.({tableResults:b,pageLinks:y,...v}),this.setState({tableResults:b,pageLinks:y}))}async fetchSeriesData(e){const{widget:t,config:s,api:r,organization:i,selection:o,afterFetchSeriesData:a,onDataFetched:l,mepSetting:d}=this.props,u=this.applyDashboardFilters(n()(t)),c=await Promise.all(u.queries.map(((e,t)=>s.getSeriesRequest(r,u,t,i,o,p(u.displayType),d)))),m=n()(this.state.rawResults)??[],g=[];c.forEach(((e,t)=>{let[r]=e;a?.(r),m[t]=r;const o=s.transformSeries(r,u.queries[t],i);o.forEach(((e,s)=>{g[t*o.length+s]=e}))}));const h=s.getSeriesResultType?.(c[0][0],u.queries[0]);this._isMounted&&this.state.queryFetchID===e&&(l?.({timeseriesResults:g,timeseriesResultsTypes:h}),this.setState({timeseriesResults:g,rawResults:m,timeseriesResultsTypes:h}))}async fetchData(){const{widget:e}=this.props,t=Symbol("queryFetchID");this.setState({loading:!0,tableResults:void 0,timeseriesResults:void 0,errorMessage:void 0,queryFetchID:t});try{[c.FO.TABLE,c.FO.BIG_NUMBER,c.FO.WORLD_MAP].includes(e.displayType)?await this.fetchTableData(t):await this.fetchSeriesData(t)}catch(e){this._isMounted&&this.setState({errorMessage:e?.responseJSON?.detail||e?.message||(0,u.t)("An unknown error occurred.")})}finally{this._isMounted&&this.setState({loading:!1})}}render(){const{children:e}=this.props,{loading:t,tableResults:s,timeseriesResults:r,errorMessage:i,pageLinks:o,timeseriesResultsTypes:n}=this.state;return e({loading:t,tableResults:s,timeseriesResults:r,errorMessage:i,pageLinks:o,timeseriesResultsTypes:n})}}m.displayName="GenericWidgetQueries";const g=m},"./app/views/dashboardsV2/widgetCard/releaseWidgetQueries.tsx":(e,t,s)=>{s.d(t,{Vl:()=>j,ZP:()=>T,gp:()=>O,nD:()=>E});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),o=s("../node_modules/lodash/cloneDeep.js"),n=s.n(o),a=s("../node_modules/lodash/isEqual.js"),l=s.n(a),d=s("../node_modules/lodash/omit.js"),u=s.n(d),c=s("../node_modules/lodash/trimStart.js"),p=s.n(c),m=s("./app/actionCreators/indicator.tsx"),g=s("./app/components/organizations/pageFilters/utils.tsx"),h=s("./app/locale.tsx"),f=s("./app/utils/discover/fields.tsx"),y=s("./app/utils/discover/types.tsx"),v=s("./app/views/dashboardsV2/datasetConfig/releases.tsx"),b=s("./app/views/dashboardsV2/types.tsx"),x=s("./app/views/dashboardsV2/widgetBuilder/releaseWidget/fields.tsx"),S=s("./app/views/dashboardsV2/widgetCard/genericWidgetQueries.tsx"),w=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function E(e){return x.Mg[e]??e}function _(e){let t="";const s=[];t+="release:["+e[0].version,s.push(e[0].version);for(let r=1;r<e.length;r++)t+=","+e[r].version,s.push(e[r].version);return t+="]",e.length<10?{releaseQueryString:t,releasesUsed:s}:e.length>10&&t.length>1500?_(e.slice(0,-10)):{releaseQueryString:t,releasesUsed:s}}function O(e,t,s){const r=e.map(f.hr),i=r.filter((e=>Object.values(x.Xg).includes(e))),o=[],n=p()(t,"-"),a=x.d2.includes(n)||s||"release"===n;return!n||a||e.includes(n)||o.includes(n)||o.push(n),s?(i.forEach((e=>{const t=e.match(x.$4);t&&("user"!==t[2]||r.includes("count_unique(user)")||(o.push("count_unique(user)"),r.push("count_unique(user)")),"session"!==t[2]||r.includes("sum(session)")||(o.push("sum(session)"),r.push("sum(session)")))})),{aggregates:r,derivedStatusFields:i,injectedFields:o}):{aggregates:r,derivedStatusFields:i,injectedFields:o}}function j(e){const t=!e.columns.includes("session.status"),s=p()(e.orderby,"-");return t&&"release"===s}class Z extends i.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{loading:!0,errorMessage:void 0,releases:void 0}),(0,r.Z)(this,"config",v.u$),(0,r.Z)(this,"_isMounted",!1),(0,r.Z)(this,"fetchReleases",(async()=>{this.setState({loading:!0,errorMessage:void 0});const{selection:e,api:t,organization:s}=this.props,{environments:r,projects:i}=e;try{const e=await t.requestPromise(`/organizations/${s.slug}/releases/`,{method:"GET",data:{sort:"date",project:i,per_page:50,environment:r}});if(!this._isMounted)return;this.setState({releases:e,loading:!1})}catch(e){if(!this._isMounted)return;const t=e.responseJSON?e.responseJSON.error:(0,h.t)("Error sorting by releases");this.setState({errorMessage:t,loading:!1}),(0,m.Iw)(t)}})),(0,r.Z)(this,"customDidUpdateComparator",((e,t)=>{const{loading:s,limit:r,widget:i,cursor:o,organization:n,selection:a,dashboardFilters:d}=t,c=["queries","title","id","layout","tempId","widgetType"],p=["name","fields","aggregates","columns"];return!(r===e.limit&&n.slug===e.organization.slug&&l()(d,e.dashboardFilters)&&(0,g.WO)(a,e.selection)&&l()(u()(i,c),u()(e.widget,c))&&l()(i.queries.map((e=>u()(e,p))),e.widget.queries.map((e=>u()(e,p))))&&l()(i.queries.flatMap((e=>e.fields?.filter((e=>!!e)))),e.widget.queries.flatMap((e=>e.fields?.filter((e=>!!e)))))&&l()(i.queries.flatMap((e=>e.aggregates.filter((e=>!!e)))),e.widget.queries.flatMap((e=>e.aggregates.filter((e=>!!e)))))&&l()(i.queries.flatMap((e=>e.columns.filter((e=>!!e)))),e.widget.queries.flatMap((e=>e.columns.filter((e=>!!e)))))&&s===e.loading&&o===e.cursor)})),(0,r.Z)(this,"transformWidget",(e=>{const{releases:t}=this.state,s=n()(e),r=j(s.queries[0]),i=s.queries[0].orderby.startsWith("-"),o=s.queries[0].columns.includes("session.status");let a="";const l=[];if(r&&(t&&1===t.length&&(a+=`release:${t[0].version}`,l.push(t[0].version)),t&&t.length>1)){const{releaseQueryString:e,releasesUsed:s}=_(t);a+=e,l.push(...s),i||l.reverse()}return o||s.queries.forEach((e=>{e.conditions=e.conditions+(""===a?"":` ${a}`)})),s})),(0,r.Z)(this,"afterFetchData",(e=>{const{widget:t}=this.props,{releases:s}=this.state,r=t.queries[0].orderby.startsWith("-"),i=[];if(j(t.queries[0])&&(s&&1===s.length&&i.push(s[0].version),s&&s.length>1)){const{releasesUsed:e}=_(s);i.push(...e),r||i.reverse()}i.length&&(e.groups.sort((function(e,t){const s=e.by.release,r=t.by.release;return i.indexOf(s)-i.indexOf(r)})),e.groups=e.groups.slice(0,this.limit))}))}componentDidMount(){this._isMounted=!0,j(this.props.widget.queries[0])&&this.fetchReleases()}componentWillUnmount(){this._isMounted=!1}get limit(){const{limit:e}=this.props;switch(this.props.widget.displayType){case b.FO.TOP_N:return y.hY;case b.FO.TABLE:return e??b.$V;case b.FO.BIG_NUMBER:return 1;default:return e??20}}render(){const{api:e,children:t,organization:s,selection:r,widget:i,cursor:o,dashboardFilters:n,onDataFetched:a}=this.props,l=v.u$;return(0,w.tZ)(S.Z,{config:l,api:e,organization:s,selection:r,widget:this.transformWidget(i),dashboardFilters:n,cursor:o,limit:this.limit,onDataFetched:a,loading:j(i.queries[0])?!this.state.releases:void 0,customDidUpdateComparator:this.customDidUpdateComparator,afterFetchTableData:this.afterFetchData,afterFetchSeriesData:this.afterFetchData,children:e=>{let{errorMessage:s,...r}=e;return t({errorMessage:this.state.errorMessage??s,...r})}})}}Z.displayName="ReleaseWidgetQueries";const T=Z},"./app/views/dashboardsV2/widgetCard/widgetQueries.tsx":(e,t,s)=>{s.d(t,{FN:()=>m,ZP:()=>f,vD:()=>g}),s("../node_modules/core-js/modules/es.array.includes.js");var r=s("../node_modules/react/index.js"),i=s("../node_modules/lodash/omit.js"),o=s.n(i),n=(s("./app/components/charts/utils.tsx"),s("./app/utils/discover/fieldRenderers.tsx")),a=s("./app/utils/discover/fields.tsx"),l=s("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),d=s("./app/views/dashboardsV2/datasetConfig/errorsAndTransactions.tsx"),u=s("./app/views/dashboardsV2/widgetCard/dashboardsMEPContext.tsx"),c=s("./app/views/dashboardsV2/widgetCard/genericWidgetQueries.tsx"),p=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function m(e,t,s){const r=e.meta?.units?.[(0,a.LY)(s)],i=(r&&(n.a_[r]??n.en[r]))??1;return{seriesName:t,data:e?.data?.map((e=>{let[t,s]=e;return{name:1e3*t,value:s.reduce(((e,t)=>{let{count:s}=t;return e+s}),0)*i}}))??[]}}function g(e,t){const s=[];return Object.keys(e).forEach((r=>{Object.keys(o()(e[r],"order")).forEach((i=>{const o=`${r} : ${i}`,n=t?`${t} > ${o}`:o,a=e[r][i];s.push([e[r].order||0,m(a,n,o)])}))})),s}function h(e){let{api:t,children:s,organization:i,selection:o,widget:n,dashboardFilters:a,cursor:m,limit:g,onDataFetched:h}=e;const f=d.g,y=(0,r.useContext)(u.HH),v=(0,l.Eg)();let b;y&&(b=y.setIsMetricsData);const x=[],S=[];return(0,p.tZ)(c.Z,{config:f,api:t,organization:i,selection:o,widget:n,cursor:m,limit:g,dashboardFilters:a,onDataFetched:h,afterFetchSeriesData:e=>{e.data?void 0!==e.isMetricsData&&x.push(e.isMetricsData):Object.keys(e).forEach((t=>{const s=e[t];void 0!==s.isMetricsData&&x.push(s.isMetricsData)})),b?.(!x.includes(!1))},afterFetchTableData:e=>{void 0!==e.meta?.isMetricsData&&S.push(e.meta.isMetricsData),b?.(!S.includes(!1))},mepSetting:v.metricSettingState,children:s})}h.displayName="WidgetQueries";const f=h},"./app/views/eventsV2/table/topResultsIndicator.tsx":(e,t,s)=>{s.d(t,{Z:()=>r});const r=(0,s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js").Z)("div",{target:"e1r2bjtv0"})("position:absolute;left:-1px;margin-top:4.5px;width:9px;height:15px;border-radius:0 3px 3px 0;background-color:",(e=>e.theme.charts.getColorPalette(e.count-2)[e.index]),";")},"./app/views/performance/traceDetails/utils.tsx":(e,t,s)=>{s.d(t,{Rg:()=>n,YA:()=>o,uM:()=>a});var r=s("./app/constants/pageFilters.tsx"),i=s("./app/utils/performance/quickTrace/utils.tsx");function o(e,t,s,i){const{start:o,end:n,statsPeriod:a}=s;return{pathname:`/organizations/${e.slug}/performance/trace/${t}/`,query:{...i,statsPeriod:a,[r.V.PAGE_START]:o,[r.V.PAGE_END]:n}}}function n(e){const t={projects:new Set,errors:new Set,transactions:new Set,startTimestamp:Number.MAX_SAFE_INTEGER,endTimestamp:0,maxGeneration:0};return e.reduce(((e,t)=>(0,i.S2)(t,((e,t)=>{for(const s of t.errors??[])e.errors.add(s.event_id);return e.transactions.add(t.event_id),e.projects.add(t.project_slug),e.startTimestamp=Math.min(e.startTimestamp,t.start_timestamp),e.endTimestamp=Math.max(e.endTimestamp,t.timestamp),e.maxGeneration=Math.max(e.maxGeneration,t.generation),e}),e)),t)}function a(e){return null===e.parent_span_id}}}]);
//# sourceMappingURL=../sourcemaps/app_components_charts_chartZoom_tsx-app_components_charts_errorPanel_tsx-app_components_chart-168ed1.b4615adf1aa1caf1ac2f6811a815414c.js.map