"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_events_interfaces_spans_utils_tsx"],{"./app/components/events/interfaces/spans/constants.tsx":(t,e,s)=>{s.d(e,{DX:()=>a,S5:()=>p,ZR:()=>o,bl:()=>r,h0:()=>i,rz:()=>n,tJ:()=>m});const a=120,n=4,r=a/n,i=20,o=a+i+20+1,p=18,m=10},"./app/components/events/interfaces/spans/utils.tsx":(t,e,s)=>{s.d(e,{BU:()=>H,IG:()=>E,Io:()=>Q,PA:()=>P,PC:()=>j,PQ:()=>W,Rr:()=>A,TC:()=>C,Zv:()=>X,ct:()=>N,h_:()=>L,hw:()=>F,is:()=>z,k9:()=>M,kP:()=>b,ll:()=>U,n0:()=>V,o0:()=>k,on:()=>K,rF:()=>O,ro:()=>D,sT:()=>Y,vu:()=>B,yk:()=>R,yn:()=>Z});var a=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react-router/es/index.js")),r=s("../node_modules/lodash/isNumber.js"),i=s.n(r),o=s("../node_modules/lodash/isString.js"),p=s.n(o),m=s("../node_modules/lodash/maxBy.js"),l=s.n(m),d=s("../node_modules/lodash/set.js"),c=s.n(d),u=s("../node_modules/moment/moment.js"),h=s.n(u),f=s("./app/components/performance/waterfall/treeConnector.tsx"),S=s("./app/types/event.tsx"),T=s("./app/types/utils.tsx"),g=s("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),w=s("./app/utils/fields/index.ts"),_=s("./app/utils/performance/vitals/constants.tsx"),v=s("./app/utils/performanceForSentry.tsx"),y=s("./app/components/events/interfaces/spans/constants.tsx");const b=t=>{const e=(0,v.Zz)();if(!e||0===t)return;const s=[10,100,200,300,400,500,600,700,800,900,1001].find((e=>t<=e))||-1;e.setTag("ui.spanCount",t),e.setTag("ui.spanCount.grouped",`<=${s}`)},I=t=>{const{startTimestamp:e,endTimestamp:s}=t;return e>s?{startTimestamp:s,endTimestamp:e}:t};let x;!function(t){t[t.Stable=0]="Stable",t[t.Reversed=1]="Reversed",t[t.Equal=2]="Equal"}(x||(x={}));const E=t=>{const{viewStart:e,viewEnd:s}=t,{startTimestamp:a,endTimestamp:n}=I({startTimestamp:t.traceStartTimestamp,endTimestamp:t.traceEndTimestamp}),r=n-a,i=a+e*r,o=n-(1-s)*r-i;return t=>{if(r<=0)return{type:"TRACE_TIMESTAMPS_EQUAL",isSpanVisibleInView:!0};if(o<=0)return{type:"INVALID_VIEW_WINDOW",isSpanVisibleInView:!0};const{startTimestamp:e,endTimestamp:s}=I(t),a=(t=>{const e=t.startTimestamp,s=t.endTimestamp;return e<s?x.Stable:e===s?x.Equal:x.Reversed})(t),n=(e-i)/o,p=(s-i)/o,m=p>0&&n<1;switch(a){case x.Equal:return{type:"TIMESTAMPS_EQUAL",start:n,width:1,isSpanVisibleInView:p>=0&&n<=1};case x.Reversed:return{type:"TIMESTAMPS_REVERSED",start:n,end:p,isSpanVisibleInView:m};case x.Stable:return{type:"TIMESTAMPS_STABLE",start:n,end:p,isSpanVisibleInView:m};default:return a}}};function V(t){return{trace_id:t.traceID,span_id:t.rootSpanID,parent_span_id:t.parentSpanID,start_timestamp:t.traceStartTimestamp,timestamp:t.traceEndTimestamp,op:t.op,description:t.description,data:{},status:t.rootSpanStatus,hash:t.hash,exclusive_time:t.exclusiveTime}}function C(t){return{start:h().unix(t.start).subtract(12,"hours").utc().format("YYYY-MM-DDTHH:mm:ss.SSS"),end:h().unix(t.end).add(12,"hours").utc().format("YYYY-MM-DDTHH:mm:ss.SSS")}}function F(t){return"type"in t&&"gap"===t.type}function D(t){if("type"in t){if("orphan"===t.type)return!0;if("gap"===t.type)return t.isOrphan}return!1}function A(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return F(t)?e:t.span_id}function R(t){if(!F(t))return t.op}function P(t){return t?.contexts?.trace}function M(t){const e=t.entries.find((t=>t.type===S.UZ.SPANS)),s=e?.data??[],a=P(t),n=a&&a.trace_id||"",r=a&&a.span_id||"",o=a&&a.op||"transaction",m=a&&a.description,l=a&&a.parent_span_id,d=a&&a.status,u=a&&a.hash,h=a&&a.exclusive_time;if(!e||s.length<=0)return{op:o,childSpans:{},traceStartTimestamp:t.startTimestamp,traceEndTimestamp:t.endTimestamp,traceID:n,rootSpanID:r,rootSpanStatus:d,parentSpanID:l,spans:[],description:m,hash:u,exclusiveTime:h};const f=new Set(s.map((t=>t.span_id)));f.add(r);const g={op:o,childSpans:{},traceStartTimestamp:t.startTimestamp,traceEndTimestamp:t.endTimestamp,traceID:n,rootSpanID:r,rootSpanStatus:d,parentSpanID:l,spans:s,description:m,hash:u,exclusiveTime:h},w=s.reduce(((t,e)=>{let s=e;const a=function(t){return F(t)?"gap-span":t.parent_span_id}(s),n=a&&f.has(a);var o;o=a,p()(o)&&o.length>0&&n||(s.parent_span_id=r,s={type:"orphan",...s}),(0,T.hu)(s.parent_span_id);const m=t.childSpans[s.parent_span_id]??[];m.push(s),c()(t.childSpans,s.parent_span_id,m),(!t.traceStartTimestamp||s.start_timestamp<t.traceStartTimestamp)&&(t.traceStartTimestamp=s.start_timestamp);const l=i()(s.timestamp);return t.traceEndTimestamp?l&&s.timestamp>t.traceEndTimestamp?(t.traceEndTimestamp=s.timestamp,t):(s.start_timestamp>t.traceEndTimestamp&&(t.traceEndTimestamp=s.start_timestamp),t):l?(t.traceEndTimestamp=s.timestamp,t):(t.traceEndTimestamp=s.start_timestamp,t)}),g);return Object.values(w.childSpans).forEach((t=>{t.sort($)})),w}function $(t,e){return D(t)&&!D(e)?1:!D(t)&&D(e)||t.start_timestamp<e.start_timestamp?-1:t.start_timestamp===e.start_timestamp?0:1}function Z(t){return"number"!=typeof t&&"orphan"===t?.type}function L(t){return Z(t)?t.depth:t}function j(t){const e=t.sdk?.name;return!!e&&["sentry.javascript.browser","sentry.javascript.react","sentry.javascript.gatsby","sentry.javascript.ember","sentry.javascript.vue","sentry.javascript.angular","sentry.javascript.nextjs","sentry.javascript.electron","sentry.javascript.remix","sentry.javascript.svelte"].includes(e.toLowerCase())}const k=["mark","paint"];function q(t){const e=Object.keys(t);return Object.values(_.r9).filter((t=>e.includes(t.slug))).some((e=>{const{value:s}=t[e.slug];return"number"==typeof s&&"number"==typeof e.poorThreshold&&s>=e.poorThreshold}))}function z(t,e){if(!t.measurements||!t.startTimestamp)return new Map;const{startTimestamp:s}=t,a=new Set([w.Zl.FCP,w.Zl.FP,w.Zl.FID,w.Zl.LCP,w.Zl.TTFB]),n=Object.keys(t.measurements).filter((t=>a.has(`measurements.${t}`))).map((e=>{const a=t.measurements[e];return{name:e,timestamp:s+a.value/1e3,value:a?a.value:void 0}})),r=new Map;return n.forEach((t=>{const s=t.name,a=t.value,n=e({startTimestamp:t.timestamp,endTimestamp:t.timestamp});if("TIMESTAMPS_EQUAL"!==n.type)return;const i=Math.round(100*n.start);for(const[e]of r)if(Math.abs(e-i)<=y.tJ){const n=r.get(e),{poorThreshold:i}=_.r9[`measurements.${s}`];return n.marks={...n.marks,[s]:{value:a,timestamp:t.timestamp,failedThreshold:!!a&&a>=i}},n.failedThreshold||(n.failedThreshold=q(n.marks)),void r.set(e,n)}const{poorThreshold:o}=_.r9[`measurements.${s}`],p={[s]:{value:a,timestamp:t.timestamp,failedThreshold:!!a&&a>=o}};r.set(i,{marks:p,failedThreshold:q(p)})})),r}function B(t,e){const s=e({startTimestamp:t,endTimestamp:t});switch(s.type){case"TRACE_TIMESTAMPS_EQUAL":case"INVALID_VIEW_WINDOW":return{warning:void 0,left:void 0,width:void 0,isSpanVisibleInView:s.isSpanVisibleInView};case"TIMESTAMPS_EQUAL":return{warning:void 0,left:s.start,width:1e-5,isSpanVisibleInView:s.isSpanVisibleInView};case"TIMESTAMPS_REVERSED":case"TIMESTAMPS_STABLE":return{warning:void 0,left:s.start,width:s.end-s.start,isSpanVisibleInView:s.isSpanVisibleInView};default:return s}}function O(t,e,s,a){return r=>{r.preventDefault();const i=N(t);e(i),n.browserHistory.push({...s,hash:i}),(0,g.Z)("performance_views.event_details.anchor_span",{organization:a,span_id:t})}}function N(t){return`#span-${t}`}function W(t,e){return void 0!==e?`${t.op}.${t.description}.${e}`:`${t.op}.${t.description}`}function U(t){return t.reduce(((t,e)=>{const{start_timestamp:s,timestamp:a}=e.span;let n=t.startTimestamp,r=t.endTimestamp;return s<n&&(n=s),r<a&&(r=a),{startTimestamp:n,endTimestamp:r}}),{startTimestamp:t[0].span.start_timestamp,endTimestamp:t[0].span.timestamp})}function Y(t,e){const{startTimestamp:s,endTimestamp:a}=U(t),n=e({startTimestamp:s,endTimestamp:a});switch(n.type){case"TRACE_TIMESTAMPS_EQUAL":case"INVALID_VIEW_WINDOW":return{warning:void 0,left:void 0,width:void 0,isSpanVisibleInView:n.isSpanVisibleInView};case"TIMESTAMPS_EQUAL":return{warning:void 0,left:n.start,width:1e-5,isSpanVisibleInView:n.isSpanVisibleInView};case"TIMESTAMPS_REVERSED":case"TIMESTAMPS_STABLE":return{warning:void 0,left:n.start,width:n.end-n.start,isSpanVisibleInView:n.isSpanVisibleInView};default:return n}}class Q{constructor(t){(0,a.Z)(this,"spanDepthsInView",void 0),(0,a.Z)(this,"treeDepthSum",void 0),(0,a.Z)(this,"length",void 0),(0,a.Z)(this,"isRootSpanInView",void 0),this.spanDepthsInView=new Map,this.treeDepthSum=0,this.length=0,this.isRootSpanInView=t}addSpan(t,e){return!this.spanDepthsInView.has(t)&&(this.spanDepthsInView.set(t,e),this.length+=1,this.treeDepthSum+=e,0===e&&(this.isRootSpanInView=!0),!0)}removeSpan(t){if(!this.spanDepthsInView.has(t))return!1;const e=this.spanDepthsInView.get(t);return this.spanDepthsInView.delete(t),this.length-=1,this.treeDepthSum-=e,0===e&&(this.isRootSpanInView=!1),!0}has(t){return this.spanDepthsInView.has(t)}getScrollVal(){return this.isRootSpanInView?0:Math.round(this.treeDepthSum/this.length)*(f.Ll/2)-f.Y9/2}}function H(t){const e=l()(t||[],(t=>J[t.level]))?.level;if(e)return G[e]}const G={fatal:"error",error:"error",default:"error",warning:"warning",sample:"info",info:"info",unknown:"muted"},J={fatal:5,error:4,default:4,warning:3,sample:2,info:1,unknown:0};function X(t,e){const s=String(t).split("."),a=String(e).split(".");if(2!==s.length||2!==a.length)return{start:String(t),end:String(e)};const n=s.reduce(((t,e,s)=>e.length>a[s].length?(t.start.push(e),t.end.push(0===s?a[s].padStart(e.length,"0"):a[s].padEnd(e.length,"0")),t):(t.start.push(0===s?e.padStart(a[s].length,"0"):e.padEnd(a[s].length,"0")),t.end.push(a[s]),t)),{start:[],end:[]});return{start:n.start.join("."),end:n.end.join(".")}}function K(t,e){return!!e&&!t.some((t=>e.has(t.span.span_id)))}},"./app/components/performance/waterfall/treeConnector.tsx":(t,e,s)=>{s.d(e,{DN:()=>d,Ll:()=>m,U1:()=>c,UV:()=>l,Y9:()=>p,jd:()=>h,rw:()=>u});var a=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=s("./app/components/performance/waterfall/constants.tsx"),r=s("./app/components/performance/waterfall/utils.tsx"),i=s("./app/icons/index.tsx"),o=s("./app/styles/space.tsx");const p=30,m=p+16,l=(0,a.Z)("div",{target:"e1xp7sks4"})("height:250%;border-left:2px ",(t=>t.orphanBranch?"dashed":"solid")," ",(t=>t.theme.border),";position:absolute;top:0;"),d=(0,a.Z)("div",{target:"e1xp7sks3"})("height:",(t=>t.isLast?n.dN/2+1:n.dN),"px;width:100%;border-left:",(t=>`2px ${t.orphanBranch?"dashed":"solid"} ${t.theme.border};`),";position:absolute;top:0;",(t=>t.isLast?`\n      border-bottom: 2px ${t.orphanBranch?"dashed":"solid"} ${t.theme.border};\n      border-bottom-left-radius: ${t.theme.borderRadius};`:`\n      &:before {\n        content: '';\n        height: 2px;\n        left: -2px;\n        border-bottom: 2px ${t.orphanBranch?"dashed":"solid"} ${t.theme.border};\n        width: calc(100% - 2px);\n        position: absolute;\n        bottom: calc(50% - 1px);\n      }`)," &:after{content:'';background-color:",(t=>t.theme.border),";border-radius:50%;height:6px;width:6px;position:absolute;right:0;top:",n.dN/2-3,"px;}"),c=(0,a.Z)("div",{target:"e1xp7sks2"})("height:16px;white-space:nowrap;min-width:30px;display:flex;align-items:center;justify-content:center;border-radius:99px;padding:0px ",(0,o.Z)(.5),";transition:all 0.15s ease-in-out;font-size:10px;line-height:0;z-index:1;box-shadow:",(t=>t.theme.dropShadowLightest),";",(t=>(0,r.uu)(t)),";"),u=(0,a.Z)("div",{target:"e1xp7sks1"})("position:relative;height:",n.dN,"px;width:",40,"px;min-width:",40,"px;margin-right:",(0,o.Z)(1),";z-index:",(t=>t.theme.zIndex.traceView.spanTreeToggler),";display:flex;justify-content:flex-end;align-items:center;"),h=(0,a.Z)(i.g6,{target:"e1xp7sks0"})("width:7px;margin-left:",(0,o.Z)(.25),";")},"./app/utils/performance/vitals/constants.tsx":(t,e,s)=>{s.d(e,{AR:()=>p,TT:()=>o,r9:()=>i});var a=s("./app/locale.tsx"),n=s("./app/utils/discover/fields.tsx"),r=s("./app/utils/fields/index.ts");const i={[r.Zl.FP]:{slug:"fp",name:(0,a.t)("First Paint"),acronym:"FP",description:(0,a.t)("Render time of the first pixel loaded in the viewport (may overlap with FCP)."),poorThreshold:3e3,type:(0,n.Cq)(r.Zl.FP)},[r.Zl.FCP]:{slug:"fcp",name:(0,a.t)("First Contentful Paint"),acronym:"FCP",description:(0,a.t)("Render time of the first image, text or other DOM node in the viewport."),poorThreshold:3e3,type:(0,n.Cq)(r.Zl.FCP)},[r.Zl.LCP]:{slug:"lcp",name:(0,a.t)("Largest Contentful Paint"),acronym:"LCP",description:(0,a.t)("Render time of the largest image, text or other DOM node in the viewport."),poorThreshold:4e3,type:(0,n.Cq)(r.Zl.LCP)},[r.Zl.FID]:{slug:"fid",name:(0,a.t)("First Input Delay"),acronym:"FID",description:(0,a.t)("Response time of the browser to a user interaction (clicking, tapping, etc)."),poorThreshold:300,type:(0,n.Cq)(r.Zl.FID)},[r.Zl.CLS]:{slug:"cls",name:(0,a.t)("Cumulative Layout Shift"),acronym:"CLS",description:(0,a.t)("Sum of layout shift scores that measure the visual stability of the page."),poorThreshold:.25,type:(0,n.Cq)(r.Zl.CLS)},[r.Zl.TTFB]:{slug:"ttfb",name:(0,a.t)("Time to First Byte"),acronym:"TTFB",description:(0,a.t)("The time that it takes for a user's browser to receive the first byte of page content."),poorThreshold:600,type:(0,n.Cq)(r.Zl.TTFB)},[r.Zl.RequestTime]:{slug:"ttfb.requesttime",name:(0,a.t)("Request Time"),acronym:"RT",description:(0,a.t)("Captures the time spent making the request and receiving the first byte of the response."),poorThreshold:600,type:(0,n.Cq)(r.Zl.RequestTime)}},o={[r.$n.AppStartCold]:{slug:"app_start_cold",name:(0,a.t)("App Start Cold"),description:(0,a.t)("Cold start is a measure of the application start up time from scratch."),type:(0,n.Cq)(r.$n.AppStartCold)},[r.$n.AppStartWarm]:{slug:"app_start_warm",name:(0,a.t)("App Start Warm"),description:(0,a.t)("Warm start is a measure of the application start up time while still in memory."),type:(0,n.Cq)(r.$n.AppStartWarm)},[r.$n.FramesTotal]:{slug:"frames_total",name:(0,a.t)("Total Frames"),description:(0,a.t)("Total frames is a count of the number of frames recorded within a transaction."),type:(0,n.Cq)(r.$n.FramesTotal)},[r.$n.FramesSlow]:{slug:"frames_slow",name:(0,a.t)("Slow Frames"),description:(0,a.t)("Slow frames is a count of the number of slow frames recorded within a transaction."),type:(0,n.Cq)(r.$n.FramesSlow)},[r.$n.FramesFrozen]:{slug:"frames_frozen",name:(0,a.t)("Frozen Frames"),description:(0,a.t)("Frozen frames is a count of the number of frozen frames recorded within a transaction."),type:(0,n.Cq)(r.$n.FramesFrozen)},[r.$n.FramesSlowRate]:{slug:"frames_slow_rate",name:(0,a.t)("Slow Frames Rate"),description:(0,a.t)("Slow Frames Rate is the percentage of frames recorded within a transaction that is considered slow."),type:(0,n.Cq)(r.$n.FramesSlowRate)},[r.$n.FramesFrozenRate]:{slug:"frames_frozen_rate",name:(0,a.t)("Frozen Frames Rate"),description:(0,a.t)("Frozen Frames Rate is the percentage of frames recorded within a transaction that is considered frozen."),type:(0,n.Cq)(r.$n.FramesFrozenRate)},[r.$n.StallCount]:{slug:"stall_count",name:(0,a.t)("Stalls"),description:(0,a.t)("Stalls is the number of times the application stalled within a transaction."),type:(0,n.Cq)(r.$n.StallCount)},[r.$n.StallTotalTime]:{slug:"stall_total_time",name:(0,a.t)("Total Stall Time"),description:(0,a.t)("Stall Total Time is the total amount of time the application is stalled within a transaction."),type:(0,n.Cq)(r.$n.StallTotalTime)},[r.$n.StallLongestTime]:{slug:"stall_longest_time",name:(0,a.t)("Longest Stall Time"),description:(0,a.t)("Stall Longest Time is the longest amount of time the application is stalled within a transaction."),type:(0,n.Cq)(r.$n.StallLongestTime)},[r.$n.StallPercentage]:{slug:"stall_percentage",name:(0,a.t)("Stall Percentage"),description:(0,a.t)("Stall Percentage is the percentage of the transaction duration the application was stalled."),type:(0,n.Cq)(r.$n.StallPercentage)}};let p;!function(t){t.CHROME="Chrome",t.EDGE="Edge",t.OPERA="Opera",t.FIREFOX="Firefox",t.SAFARI="Safari",t.IE="IE"}(p||(p={}))}}]);
//# sourceMappingURL=../sourcemaps/app_components_events_interfaces_spans_utils_tsx.78cb9f04edb4cf88e867769b8af867a5.js.map