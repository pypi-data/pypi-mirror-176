(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_performance_transactionSummary_transactionReplays_index_tsx-node_modules_lodash__ba-240a92"],{"./app/views/performance/transactionSummary/transactionReplays/index.tsx":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>G});var a=n("../node_modules/react/index.js"),s=n("./app/components/acl/feature.tsx"),r=n("./app/components/alert.tsx"),o=n("./app/components/layouts/thirds.tsx"),i=n("./app/components/loadingIndicator.tsx"),l=n("./app/locale.tsx"),p=n("./app/styles/organization.tsx"),c=n("./app/utils/discover/eventView.tsx"),u=n("./app/utils/discover/fields.tsx"),d=n("./app/utils/queryString.tsx"),m=n("./app/utils/tokenizeSearch.tsx"),y=n("./app/utils/withOrganization.tsx"),g=n("./app/utils/withProjects.tsx"),h=n("./app/views/performance/transactionSummary/filter.tsx"),v=n("./app/views/performance/transactionSummary/pageLayout.tsx"),w=n("./app/views/performance/transactionSummary/tabs.tsx"),f=n("./app/views/performance/transactionSummary/transactionEvents/utils.tsx"),x=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),Z=n("../node_modules/react-router/es/index.js"),b=n("../node_modules/lodash/first.js"),F=n.n(b),_=n("../node_modules/lodash/omit.js"),j=n.n(_),q=n("./app/components/compactSelect.tsx"),z=n("./app/components/datePageFilter.tsx"),V=n("./app/components/environmentPageFilter.tsx"),k=n("./app/components/events/searchBar.tsx"),S=n("./app/components/organizations/pageFilterBar.tsx"),N=n("./app/components/organizations/pageFilters/parse.tsx"),P=n("./app/components/pagination.tsx"),E=n("./app/styles/space.tsx"),R=n("./app/utils.tsx"),B=n("./app/views/replays/replayTable.tsx"),D=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function L(e){let{eventView:t,eventsDisplayFilterName:n,isFetching:a,location:s,organization:r,pageLinks:i,replays:p,spanOperationBreakdownFilter:c,percentileValues:u}=e;const d=s.query,m=(0,f._S)(c,u);return(0,D.BX)(o.or,{fullWidth:!0,children:[(0,D.BX)(T,{children:[(0,D.BX)(S.Z,{condensed:!0,children:[(0,D.tZ)(V.Z,{}),(0,D.tZ)(z.Z,{alignDropdown:"left"})]}),(0,D.tZ)(C,{organization:r,projectIds:t.project,query:d.query,fields:t.fields,onSearch:(y="query",function(e){const t=(0,N.fK)({...s.query||{},[y]:e}),n=["cursor"];(0,R.ri)(e)||n.push(y);const a=j()(t,n);Z.browserHistory.push({...s,query:a})})}),(0,D.tZ)(A,{triggerProps:{prefix:(0,l.t)("Percentile")},value:n,onChange:e=>(e=>{const t={...s.query,showTransactions:e};e===f.q3.p100&&delete t.showTransaction,Z.browserHistory.push({pathname:s.pathname,query:t})})(e.value),options:Object.entries(m).map((e=>{let[t,n]=e;return{value:t,label:n.label}}))})]}),(0,D.tZ)(B.Z,{isFetching:a,replays:p,showProjectColumn:!1,sort:F()(t.sorts)||{field:"startedAt",kind:"asc"},showSlowestTxColumn:!0}),(0,D.tZ)(P.Z,{pageLinks:i})]});var y}L.displayName="ReplaysContent";const T=(0,x.Z)("div",{target:"er3ps122"})("display:grid;gap:",(0,E.Z)(2),";margin-bottom:",(0,E.Z)(2),";grid-template-columns:repeat(2, 1fr);@media (min-width: ",(e=>e.theme.breakpoints.small),"){grid-template-columns:auto 1fr auto;}"),A=(0,x.Z)(q.Z,{target:"er3ps121"})("order:2;justify-self:flex-end;@media (min-width: ",(e=>e.theme.breakpoints.small),"){order:3;}"),C=(0,x.Z)(k.Z,{target:"er3ps120"})("order:3;grid-column:span 2;@media (min-width: ",(e=>e.theme.breakpoints.small),"){order:2;grid-column:span 1;}"),I=L;var O=n("../node_modules/@sentry/browser/node_modules/@sentry/core/esm/exports.js"),W=n("./app/utils/discover/genericDiscoverQuery.tsx"),$=n("./app/utils/replays/fetchReplayList.tsx"),H=n("./app/utils/useApi.tsx");function Q(){return(0,D.tZ)(p.JH,{children:(0,D.tZ)(r.Z,{type:"warning",children:(0,l.t)("You don't have access to this feature")})})}function X(e){const{location:t,organization:n,projects:a}=e;return(0,D.tZ)(s.Z,{features:["session-replay-ui"],organization:n,renderDisabled:Q,children:(0,D.tZ)(v.ZP,{location:t,organization:n,projects:a,tab:w.Z.Replays,getDocumentTitle:K,generateEventView:M,childComponent:Y})})}function Y(e){let{eventView:t,location:n,organization:s,setError:r}=e;const l=(0,f.tb)(n),p=(0,h.q0)(n),{eventView:u,replays:y,pageLinks:g,isFetching:v,fetchError:w}=function(e){let{eventsWithReplaysView:t,location:n,organization:s,spanOperationBreakdownFilter:r,eventsDisplayFilterName:o}=e;const i=(0,H.Z)(),[l,p]=(0,a.useState)({fetchError:void 0,isFetching:!0,pageLinks:null,replays:[],eventView:void 0}),u=(0,a.useCallback)((async()=>{const e=(0,f.Lc)(t.clone()),a=await async function(e){let{api:t,eventView:n,location:a,organization:s}=e;try{const[e]=await(0,W.AA)(t,`/organizations/${s.slug}/events/`,n.getEventsAPIPayload(a));return e.data[0]}catch(e){return O.Tb(e),null}}({api:i,eventView:e,location:n,organization:s}),l=(0,f.Kc)(a),u=function(e){let{percentiles:t,spanOperationBreakdownFilter:n,eventsDisplayFilterName:a,eventView:s}=e;const r=(0,f._S)(n,t)[a],o=s.clone();if(o&&r?.query){const e=new m.MY(o.query);r.query.forEach((t=>e.setFilterValues(t[0],[t[1]]))),o.query=e.formatString()}return o}({eventView:t,percentiles:l,spanOperationBreakdownFilter:r,eventsDisplayFilterName:o}),y=await async function(e){let{api:t,eventView:n,location:a,organization:s}=e;try{const[e]=await(0,W.AA)(t,`/organizations/${s.slug}/events/`,n.getEventsAPIPayload(a));return e.data}catch(e){return O.Tb(e),null}}({api:i,eventView:u??t,location:n,organization:s}),g=y?.map((e=>e.replayId)),h=c.ZP.fromNewQueryWithLocation({id:"",name:"Replays within a transaction",version:2,fields:$.p8,projects:[],query:`id:[${String(g)}]`},n);h.sorts=(0,c.vp)((0,d.ro)(n.query.sort,$.yw));const v=await(0,$.ZP)({api:i,eventView:h,location:n,organization:s}),w=v.replays?.map((e=>{let t;for(const n of y??[])n.replayId===e.id&&(!t||n["transaction.duration"]>t["transaction.duration"])&&(t=n);return{...e,txEvent:t??{}}}));p({...v,eventView:h,replays:w})}),[i,t,n,s,r,o]);return(0,a.useEffect)((()=>{u()}),[u]),l}({eventsWithReplaysView:t,location:n,organization:s,eventsDisplayFilterName:l,spanOperationBreakdownFilter:p});return(0,a.useEffect)((()=>{r(w?.message)}),[r,w]),v||!u?(0,D.tZ)(o.or,{fullWidth:!0,children:(0,D.tZ)(i.Z,{})}):y?(0,D.tZ)(I,{eventView:u,isFetching:v,location:n,organization:s,pageLinks:g,replays:y,eventsDisplayFilterName:l,spanOperationBreakdownFilter:p}):(0,D.tZ)(a.Fragment,{children:null})}function K(e){return"string"==typeof e&&String(e).trim().length>0?[String(e).trim(),(0,l.t)("Replays")].join(" — "):[(0,l.t)("Summary"),(0,l.t)("Replays")].join(" — ")}function M(e){let{location:t,transactionName:n}=e;const a=["replayId","count()","transaction.duration","trace","timestamp"],s=(0,h.q0)(t);s!==h.f1.None?a.push(`spans.${s}`):a.push(...u.$4,u.zD);const r=(0,d.ro)(t.query.query,""),o=new m.MY(r);return o.setFilterValues("event.type",["transaction"]),o.addFilterValues("transaction",[n]),o.addFilterValues("!replayId",[""]),c.ZP.fromNewQueryWithLocation({id:"",name:"Replay events within a transaction",version:2,fields:a,query:o.formatString(),projects:[],orderby:(0,d.ro)(t.query.sort,"-timestamp")},t)}Q.displayName="renderNoAccess",X.displayName="TransactionReplays";const G=(0,g.Z)((0,y.Z)(X))},"../node_modules/lodash/_baseExtremum.js":(e,t,n)=>{var a=n("../node_modules/lodash/isSymbol.js");e.exports=function(e,t,n){for(var s=-1,r=e.length;++s<r;){var o=e[s],i=t(o);if(null!=i&&(void 0===l?i==i&&!a(i):n(i,l)))var l=i,p=o}return p}},"../node_modules/lodash/_baseGt.js":e=>{e.exports=function(e,t){return e>t}}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_transactionSummary_transactionReplays_index_tsx-node_modules_lodash__ba-240a92.5b072e32f1eba2beba1b3ad95fcfc883.js.map