"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_modals_widgetViewerModal_utils_tsx-app_views_dashboardsV2_widgetCard_widgetCar-7a3063"],{"./app/components/charts/simpleTableChart.tsx":(e,t,s)=>{s.d(t,{Z:()=>f,p:()=>x});var i=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),o=s("./app/components/panels/panelTable.tsx"),r=s("./app/components/tooltip.tsx"),n=s("./app/components/truncate.tsx"),d=s("./app/styles/space.tsx"),l=s("./app/utils/discover/fieldRenderers.tsx"),p=s("./app/utils/discover/fields.tsx"),c=s("./app/utils/withOrganization.tsx"),g=s("./app/views/eventsV2/table/topResultsIndicator.tsx"),u=s("./app/views/eventsV2/utils.tsx"),m=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function h(e){let{className:t,loading:s,eventView:i,fields:o,metadata:n,data:d,title:c,fieldHeaderMap:h,stickyHeaders:f,getCustomFieldRenderer:y,organization:v,topResultsIndicators:C,location:R,fieldAliases:j,loader:z}=e;const _=n??{},T=v.features.includes("discover-frontend-use-events-endpoint"),S=(0,u.Hg)(o.map(((e,t)=>({field:e,alias:j[t]}))),T);return(0,m.BX)(a.Fragment,{children:[c&&(0,m.tZ)("h4",{children:c}),(0,m.tZ)(b,{className:t,isLoading:s,loader:z,headers:S.map(((e,t)=>{const s=(0,p.qG)(e.name,e.type,_),i=e.column.alias||(h?.[e.key]??e.name);return(0,m.tZ)(w,{align:s,children:(0,m.tZ)(r.Z,{title:i,children:(0,m.tZ)(Z,{value:i,maxLength:30,expandable:!1})})},t)})),isEmpty:!d?.length,stickyHeaders:f,disablePadding:!0,children:d?.map(((e,t)=>function(e,t,s,a){return a.map(((a,o)=>{const r=y?.(a.key,s,v)??(0,l.Js)(a.key,s),n=s.units?.[a.key];return(0,m.BX)(x,{children:[C&&0===o&&(0,m.tZ)(g.Z,{count:C,index:e}),r(t,{organization:v,location:R,eventView:i,unit:n})]},`${e}-${o}:${a.name}`)}))}(t,e,_,S)))})]})}h.displayName="SimpleTableChart";const Z=(0,i.Z)(n.Z,{target:"e3tr8vk3"})({name:"1bmnxg7",styles:"white-space:nowrap"}),b=(0,i.Z)(o.Z,{target:"e3tr8vk2"})("border-radius:0;border-left:0;border-right:0;border-bottom:0;margin:0;",o.z,"{height:min-content;}"),w=(0,i.Z)("div",{target:"e3tr8vk1"})((e=>e.align?`text-align: ${e.align};`:"")," padding:",(0,d.Z)(1)," ",(0,d.Z)(3),";"),x=(0,i.Z)("div",{target:"e3tr8vk0"})("padding:",(0,d.Z)(1)," ",(0,d.Z)(3),";"),f=(0,c.Z)(h)},"./app/components/modals/widgetViewerModal/utils.tsx":(e,t,s)=>{let i;function a(e){return e.match(/\/widget\/[0-9]+\/$/)}s.d(t,{R:()=>i,X:()=>a}),function(e){e.SORT="sort",e.QUERY="query",e.LEGEND="legend",e.PAGE="page",e.CURSOR="cursor",e.WIDTH="width",e.START="viewerStart",e.END="viewerEnd"}(i||(i={}))},"./app/views/dashboardsV2/widgetCard/chart.tsx":(e,t,s)=>{s.d(t,{R:()=>V,Z:()=>E});var i=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),a=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),r=s("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),n=s("../node_modules/lodash/isEqual.js"),d=s.n(n),l=s("../node_modules/lodash/omit.js"),p=s.n(l),c=s("./app/components/charts/areaChart.tsx"),g=s("./app/components/charts/barChart.tsx"),u=s("./app/components/charts/chartZoom.tsx"),m=s("./app/components/charts/errorPanel.tsx"),h=s("./app/components/charts/lineChart.tsx"),Z=s("./app/components/charts/simpleTableChart.tsx"),b=s("./app/components/charts/transitionChart.tsx"),w=s("./app/components/charts/transparentLoadingMask.tsx"),x=s("./app/components/charts/utils.tsx"),f=s("./app/components/charts/worldMapChart.tsx"),y=s("./app/components/loadingIndicator.tsx"),v=s("./app/components/placeholder.tsx"),C=s("./app/components/tooltip.tsx"),R=s("./app/icons/index.tsx"),j=s("./app/styles/space.tsx"),z=s("./app/utils/discover/charts.tsx"),_=s("./app/utils/discover/fieldRenderers.tsx"),T=s("./app/utils/discover/fields.tsx"),S=s("./app/utils/getDynamicText.tsx"),k=s("./app/views/dashboardsV2/utils.tsx"),F=s("./app/views/dashboardsV2/datasetConfig/base.tsx"),M=s("./app/views/dashboardsV2/types.tsx"),N=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const V=60;class O extends o.Component{constructor(){super(...arguments),(0,i.Z)(this,"state",{containerHeight:0})}shouldComponentUpdate(e,t){if(this.props.widget.displayType===M.FO.BIG_NUMBER&&e.widget.displayType===M.FO.BIG_NUMBER&&(this.props.windowWidth!==e.windowWidth||!d()(this.props.widget?.layout,e.widget?.layout)))return!0;const s={...p()(this.props,["windowWidth"]),widget:{...this.props.widget,title:""}};return e={...p()(e,["windowWidth"]),widget:{...e.widget,title:""}},!d()(s,e)||!d()(this.state,t)}tableResultComponent(e){let{loading:t,errorMessage:s,tableResults:i}=e;const{location:a,widget:o,organization:r,selection:n}=this.props;if(s)return(0,N.tZ)(X,{children:(0,N.tZ)(R.FC,{color:"gray500",size:"lg"})});if(void 0===i)return(0,N.tZ)(I,{});const d=(0,F.v)(o.widgetType);return i.map(((e,s)=>{const l=o.queries[s]?.fields?.map(T.hr)??[],p=o.queries[s]?.fieldAliases??[],c=(0,k.tT)(o.title,o.queries[0],n,o.displayType);return(0,N.tZ)(P,{eventView:c,fieldAliases:p,location:a,fields:l,title:i.length>1?e.title:"",loading:t,loader:(0,N.tZ)(I,{}),metadata:e.meta,data:e.data,organization:r,stickyHeaders:!0,getCustomFieldRenderer:d.getCustomFieldRenderer},`table:${e.title}`)}))}bigNumberComponent(e){let{loading:t,errorMessage:s,tableResults:i}=e;if(s)return(0,N.tZ)(X,{children:(0,N.tZ)(R.FC,{color:"gray500",size:"lg"})});if(void 0===i||t)return(0,N.tZ)($,{children:"—"});const{containerHeight:a}=this.state,{location:o,organization:r,widget:n,isMobile:d,expandNumbers:l}=this.props,p=!r.features.includes("discover-frontend-use-events-endpoint")&&n.widgetType!==M.l9.RELEASE;return i.map((e=>{const t={...e.meta},s=Object.keys(t)[0],i=!!l&&"integer"===t[s];if(i&&(t[s]="string"),!s||!e.data?.length)return(0,N.tZ)($,{children:"—"},`big_number:${e.title}`);const c=e.data[0],g=(0,_.fK)(s,t,p),u=t.units?.[s],m=g(i?{[s]:c[s].toLocaleString()}:c,{location:o,organization:r,unit:u});if(!n.id&&!n.tempId||d)return(0,N.tZ)($,{children:m},`big_number:${e.title}`);const h=l?`max(min(8vw, 90px), ${(0,j.Z)(4)})`:a-parseInt((0,j.Z)(1),10)-parseInt((0,j.Z)(3),10);return(0,N.tZ)($,{style:{fontSize:h,...l?{padding:`${(0,j.Z)(1)} ${(0,j.Z)(3)} 0 ${(0,j.Z)(3)}`}:{}},children:(0,N.tZ)(C.Z,{title:m,showOnlyOnOverflow:!0,children:m})},`big_number:${e.title}`)}))}chartComponent(e){const{widget:t}=this.props,s=t.queries[0]?.columns.length>0;switch(t.displayType){case"bar":return(0,N.tZ)(g.v,{...e,stacked:s});case"area":case"top_n":return(0,N.tZ)(c.T,{stacked:!0,...e});case"world_map":return(0,N.tZ)(f.y,{...e});default:return(0,N.tZ)(h.w,{...e})}}render(){const{theme:e,tableResults:t,timeseriesResults:s,errorMessage:i,loading:a,widget:o,onZoom:r,legendOptions:n,expandNumbers:d,showSlider:l,noPadding:p,chartZoomOptions:c,timeseriesResultsTypes:g}=this.props;if("table"===o.displayType)return(0,S.Z)({value:(0,N.BX)(b.Z,{loading:a,reloading:a,children:[(0,N.tZ)(H,{loading:a}),this.tableResultComponent({tableResults:t,loading:a,errorMessage:i})]}),fixed:(0,N.tZ)(v.Z,{height:"200px",testId:"skeleton-ui"})});if("big_number"===o.displayType)return(0,N.BX)(b.Z,{loading:a,reloading:a,children:[(0,N.tZ)(H,{loading:a}),(0,N.tZ)(B,{ref:e=>{if(null!==e&&!d){const{height:t}=e.getBoundingClientRect();t!==this.state.containerHeight&&this.setState({containerHeight:t})}},children:this.bigNumberComponent({tableResults:t,loading:a,errorMessage:i})})]});if(i)return(0,N.tZ)(X,{children:(0,N.tZ)(R.FC,{color:"gray500",size:"lg"})});const{location:m,router:h,selection:Z,onLegendSelectChanged:w}=this.props,{start:f,end:y,period:C,utc:j}=Z.datetime,_=Boolean(o.id||o.tempId);if("world_map"===o.displayType){const{data:e,title:s}=(0,x.JT)(t),i=[{seriesName:s,data:e}];return(0,N.BX)(b.Z,{loading:a,reloading:a,children:[(0,N.tZ)(H,{loading:a}),(0,N.tZ)(W,{autoHeightResize:_,children:(0,S.Z)({value:this.chartComponent({series:i,autoHeightResize:_}),fixed:(0,N.tZ)(v.Z,{height:"200px",testId:"skeleton-ui"})})})]})}const k={left:0,top:0,selected:(0,x.RI)(m),formatter:e=>{const t=(0,T.hW)(e);if(null!==t){const s=(0,T.b8)(t);null!==s&&(e=s.toUpperCase())}return(0,T.by)(e)&&(e=(0,T.bQ)(e)),e},...n},F=o.queries[0]?.aggregates?.[0]??"count()",M=(0,T.GO)(F)?(0,T.vp)(F):F,O={autoHeightResize:_,grid:{left:0,right:4,top:"40px",bottom:l?V:0},seriesOptions:{showSymbol:!1},tooltip:{trigger:"axis",valueFormatter:(e,t)=>{const s=t.split(":").pop()?.trim();return s?g?(0,z.CX)(e,g[s]):(0,z.CX)(e,(0,T.Px)(s)):(0,z.CX)(e,"number")}},yAxis:{axisLabel:{color:e.chartLabel,formatter:e=>{if(g){const t=1===new Set(Object.values(g)).size?g[M]:"number";return(0,z.x1)(e,t)}return(0,z.gu)(e,(0,T.Px)(M))}}}};return(0,N.tZ)(u.Z,{router:h,period:C,start:f,end:y,utc:j,showSlider:l,chartZoomOptions:c,children:t=>{if(i)return(0,N.tZ)(X,{children:(0,N.tZ)(R.FC,{color:"gray500",size:"lg"})});const o=new RegExp("(?:.* : Other$)|^Other$"),n=s?.some((e=>{let{seriesName:t}=e;return t&&t.match(o)})),d=s?e.charts.getColorPalette(s.length-(n?3:2)):[];n&&(d[d.length]=e.chartOther);const l=s?s.map(((e,t)=>{let s="";return void 0!==e.seriesName&&(s=(0,T.GO)(e.seriesName)?(0,T.vp)(e.seriesName):e.seriesName),{...e,seriesName:s,color:d[t]}})):[],c=l[0]?.data[0]?.name,g=l[0]?.data[l[0].data.length-1]?.name;return(0,N.BX)(b.Z,{loading:a,reloading:a,children:[(0,N.tZ)(H,{loading:a}),(0,N.tZ)(W,{autoHeightResize:_,noPadding:p,children:(0,S.Z)({value:this.chartComponent({...t,...O,...r?{onDataZoom:(e,t)=>r({...e,seriesStart:c,seriesEnd:g},t)}:{},legend:k,series:l,onLegendSelectChanged:w}),fixed:(0,N.tZ)(v.Z,{height:"200px",testId:"skeleton-ui"})})})]})}})}}O.displayName="WidgetCardChart";const E=(0,r.b)(O),L=(0,a.Z)((e=>(0,N.tZ)(w.Z,{...e,maskBackgroundColor:"transparent"})),{target:"eb7j3e6"})({name:"1vcob1d",styles:"display:flex;justify-content:center;align-items:center"}),H=e=>{let{loading:t}=e;return t?(0,N.tZ)(L,{visible:t,children:(0,N.tZ)(y.Z,{mini:!0})}):null};H.displayName="LoadingScreen";const I=(0,a.Z)((e=>{let{className:t}=e;return(0,N.tZ)(v.Z,{height:"200px",className:t})}),{target:"eb7j3e5"})("background-color:",(e=>e.theme.surface200),";"),B=(0,a.Z)("div",{target:"eb7j3e4"})({name:"af8mp8",styles:"height:100%;width:100%;overflow:hidden"}),$=(0,a.Z)("div",{target:"eb7j3e3"})("line-height:1;display:inline-flex;flex:1;width:100%;min-height:0;font-size:32px;color:",(e=>e.theme.headingColor),";padding:",(0,j.Z)(1)," ",(0,j.Z)(3)," ",(0,j.Z)(3)," ",(0,j.Z)(3),";*{text-align:left!important;}"),W=(0,a.Z)("div",{target:"eb7j3e2"})((e=>e.autoHeightResize&&"height: 100%;")," padding:",(e=>e.noPadding?"0":`0 ${(0,j.Z)(3)} ${(0,j.Z)(3)}`),";"),P=(0,a.Z)(Z.Z,{target:"eb7j3e1"})("margin-top:",(0,j.Z)(1.5),";border-bottom-left-radius:",(e=>e.theme.borderRadius),";border-bottom-right-radius:",(e=>e.theme.borderRadius),";font-size:",(e=>e.theme.fontSizeMedium),";box-shadow:none;"),X=(0,a.Z)(m.Z,{target:"eb7j3e0"})("padding:",(0,j.Z)(2),";")},"./app/views/dashboardsV2/widgetCard/issueWidgetQueries.tsx":(e,t,s)=>{s.d(t,{Z:()=>l});var i=s("../node_modules/react/index.js"),a=s("./app/stores/memberListStore.tsx"),o=s("./app/utils/getDynamicText.tsx"),r=s("./app/views/dashboardsV2/datasetConfig/issues.tsx"),n=s("./app/views/dashboardsV2/widgetCard/genericWidgetQueries.tsx"),d=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=function(e){let{children:t,api:s,organization:l,selection:p,widget:c,cursor:g,limit:u,dashboardFilters:m,onDataFetched:h}=e;const[Z,b]=(0,i.useState)(!1);(0,i.useEffect)((()=>{b(a.Z.isLoaded());const e=a.Z.listen((()=>{b(a.Z.isLoaded())}),void 0);return()=>e()}),[]);const w=r.f;return(0,o.Z)({value:(0,d.tZ)(n.Z,{config:w,api:s,organization:l,selection:p,widget:c,cursor:g,limit:u,dashboardFilters:m,onDataFetched:h,afterFetchTableData:(e,t)=>({totalIssuesCount:t?.getResponseHeader("X-Hits")??void 0}),children:e=>{let{loading:s,...i}=e;return t({loading:s||!Z,...i})}}),fixed:(0,d.tZ)("div",{})})}},"./app/views/dashboardsV2/widgetCard/widgetCardChartContainer.tsx":(e,t,s)=>{s.d(t,{b:()=>z,Z:()=>_});var i=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=s("../node_modules/react/index.js"),o=s("../node_modules/react-router/es/index.js"),r=s("./app/components/charts/transparentLoadingMask.tsx"),n=s("./app/components/loadingIndicator.tsx"),d=s("./app/views/dashboardsV2/types.tsx"),l=s("./app/views/dashboardsV2/widgetCard/chart.tsx"),p=s("./app/components/charts/errorPanel.tsx"),c=s("./app/components/charts/simpleTableChart.tsx"),g=s("./app/components/placeholder.tsx"),u=s("./app/icons/index.tsx"),m=s("./app/styles/space.tsx"),h=s("./app/utils.tsx"),Z=s("./app/views/dashboardsV2/utils.tsx"),b=s("./app/views/dashboardsV2/datasetConfig/base.tsx"),w=s("./app/views/dashboardsV2/widgetBuilder/issueWidget/fields.tsx"),x=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function f(e){let{organization:t,selection:s,widget:i,errorMessage:a,loading:o,transformedResults:r,location:n}=e;const l=(0,b.v)(d.l9.ISSUE);if(a)return(0,x.tZ)(p.Z,{children:(0,x.tZ)(u.FC,{color:"gray500",size:"lg"})});if(o)return(0,x.tZ)(y,{height:"200px"});const c=i.queries[0],g=(0,h.ri)(c.fields)?c.fields:[...c.columns,...c.aggregates],m=c.fieldAliases??[],f=(0,Z.tT)(i.title,i.queries[0],s,i.displayType);return(0,x.tZ)(v,{location:n,title:"",eventView:f,fields:g,fieldAliases:m,loading:o,metadata:w.$L,data:r,organization:t,getCustomFieldRenderer:l.getCustomFieldRenderer,fieldHeaderMap:l.fieldHeaderMap,stickyHeaders:!0})}f.displayName="IssueWidgetCard";const y=(0,i.Z)(g.Z,{target:"e11eoa721"})("background-color:",(e=>e.theme.surface200),";"),v=(0,i.Z)(c.Z,{target:"e11eoa720"})("margin-top:",(0,m.Z)(1.5),";border-bottom-left-radius:",(e=>e.theme.borderRadius),";border-bottom-right-radius:",(e=>e.theme.borderRadius),";font-size:",(e=>e.theme.fontSizeMedium),";box-shadow:none;");var C=s("./app/views/dashboardsV2/widgetCard/issueWidgetQueries.tsx"),R=s("./app/views/dashboardsV2/widgetCard/releaseWidgetQueries.tsx"),j=s("./app/views/dashboardsV2/widgetCard/widgetQueries.tsx");function z(e){let{location:t,router:s,api:i,organization:o,selection:r,widget:n,dashboardFilters:p,isMobile:c,renderErrorMessage:g,tableItemLimit:u,windowWidth:m,onZoom:h,onLegendSelectChanged:Z,legendOptions:b,expandNumbers:w,onDataFetched:y,showSlider:v,noPadding:z,chartZoomOptions:_}=e;return n.widgetType===d.l9.ISSUE?(0,x.tZ)(C.Z,{api:i,organization:o,widget:n,selection:r,limit:u,onDataFetched:y,dashboardFilters:p,children:e=>{let{tableResults:s,errorMessage:i,loading:d}=e;return(0,x.BX)(a.Fragment,{children:["function"==typeof g?g(i):null,(0,x.tZ)(S,{loading:d}),(0,x.tZ)(f,{transformedResults:s?.[0].data??[],loading:d,errorMessage:i,widget:n,organization:o,location:t,selection:r})]})}}):n.widgetType===d.l9.RELEASE?(0,x.tZ)(R.ZP,{api:i,organization:o,widget:n,selection:r,limit:n.limit??u,onDataFetched:y,dashboardFilters:p,children:e=>{let{tableResults:i,timeseriesResults:d,errorMessage:p,loading:u}=e;return(0,x.BX)(a.Fragment,{children:["function"==typeof g?g(p):null,(0,x.tZ)(l.Z,{timeseriesResults:d,tableResults:i,errorMessage:p,loading:u,location:t,widget:n,selection:r,router:s,organization:o,isMobile:c,windowWidth:m,expandNumbers:w,onZoom:h,showSlider:v,noPadding:z,chartZoomOptions:_})]})}}):(0,x.tZ)(j.ZP,{api:i,organization:o,widget:n,selection:r,limit:u,onDataFetched:y,dashboardFilters:p,children:e=>{let{tableResults:i,timeseriesResults:d,errorMessage:p,loading:u,timeseriesResultsTypes:f}=e;return(0,x.BX)(a.Fragment,{children:["function"==typeof g?g(p):null,(0,x.tZ)(l.Z,{timeseriesResults:d,tableResults:i,errorMessage:p,loading:u,location:t,widget:n,selection:r,router:s,organization:o,isMobile:c,windowWidth:m,onZoom:h,onLegendSelectChanged:Z,legendOptions:b,expandNumbers:w,showSlider:v,noPadding:z,chartZoomOptions:_,timeseriesResultsTypes:f})]})}})}z.displayName="WidgetCardChartContainer";const _=(0,o.withRouter)(z),T=(0,i.Z)((e=>(0,x.tZ)(r.Z,{...e,maskBackgroundColor:"transparent"})),{target:"e14ay5ol0"})({name:"1vcob1d",styles:"display:flex;justify-content:center;align-items:center"}),S=e=>{let{loading:t}=e;return t?(0,x.tZ)(T,{visible:t,children:(0,x.tZ)(n.Z,{mini:!0})}):null};S.displayName="LoadingScreen"}}]);
//# sourceMappingURL=../sourcemaps/app_components_modals_widgetViewerModal_utils_tsx-app_views_dashboardsV2_widgetCard_widgetCar-7a3063.4cb8cd674a5b50ba2184a831f1593621.js.map