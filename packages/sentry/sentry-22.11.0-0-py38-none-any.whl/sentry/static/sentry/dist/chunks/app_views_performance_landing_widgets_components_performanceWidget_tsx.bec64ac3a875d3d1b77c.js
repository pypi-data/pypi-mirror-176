"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_performance_landing_widgets_components_performanceWidget_tsx"],{"./app/views/performance/landing/widgets/components/performanceWidget.tsx":(t,e,a)=>{a.d(e,{I:()=>N});var r=a("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=a("../node_modules/react/index.js"),s=a("../node_modules/react-router/es/index.js"),o=a("./app/components/charts/errorPanel.tsx"),n=a("./app/components/placeholder.tsx"),l=a("./app/icons/iconWarning.tsx"),d=a("./app/styles/space.tsx"),p=a("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),c=a("./app/utils/getDynamicText.tsx"),_=(a("../node_modules/core-js/modules/es.array.includes.js"),a("./app/components/tag.tsx")),m=a("./app/utils/useOrganization.tsx"),u=a("./app/views/performance/landing/widgets/utils.tsx"),T=a("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),A=a("./app/utils/performance/contexts/utils.tsx"),S=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const[g,R]=(0,A.n)({name:"MetricsEnhancedPerformanceDataContext"}),h=t=>{let{children:e,chartSetting:a}=t;const{setAutoSampleState:r}=(0,T.Eg)(),[s,o]=(0,i.useState)(void 0),n=(0,i.useCallback)((t=>{u.zS.includes(a)||(!0===t?r(T.nl.metrics):!1===t&&r(T.nl.transactions),o(t))}),[r,o,a]);return(0,S.tZ)(g,{value:{isMetricsData:s,setIsMetricsData:n},children:e})};h.displayName="MEPDataProvider";const f=R,O=()=>{const{isMetricsData:t}=f();if(!(0,m.Z)().features.includes("performance-use-metrics"))return null;if(void 0===t)return(0,S.tZ)("span",{"data-test-id":"no-metrics-data-tag"});const e=t?"processed":"indexed";return(0,S.tZ)(_.Z,{"data-test-id":"has-metrics-data-tag",children:e})};O.displayName="MEPTag";var y=a("./app/utils/useApi.tsx"),E=a("./app/components/panels/index.tsx");const D=(0,r.Z)(E.s_,{target:"e1evmidq1"})("padding-top:",(0,d.Z)(2),";margin-bottom:0;"),P=(0,r.Z)("div",{target:"e1evmidq0"})("");function v(t){return t.isErrored?t.errorComponent:t.isLoading&&t.loadingComponent?t.loadingComponent:t.hasData?(0,S.tZ)(i.Fragment,{children:t.dataComponents}):t.emptyComponent}v.displayName="DataStateSwitch";var w=a("./app/utils/dates.tsx");function I(t){const e=t.children??(0,S.tZ)(i.Fragment,{});return t.queries.length?(0,S.tZ)(i.Fragment,{children:t.queries.filter((e=>!e.enabled||e.enabled(t.widgetData))).map((e=>(0,S.tZ)(C,{...t,query:e},e.queryKey)))}):(0,S.tZ)(i.Fragment,{children:e})}function C(t){const e=t.query,a=t.queryProps.eventView.getPageFilters(),r=a.datetime.start?(0,w.hC)(a.datetime.start):null,s=a.datetime.end?(0,w.hC)(a.datetime.end):null;return(0,i.useEffect)((()=>()=>{t.removeWidgetDataForKey(e.queryKey)}),[]),(0,S.tZ)(e.component,{fields:e.fields,yAxis:e.fields,start:r,end:s,period:a.datetime.period,project:a.projects,environment:a.environments,organization:t.queryProps.organization,orgSlug:t.queryProps.organization.slug,eventView:t.queryProps.eventView,query:t.queryProps.eventView.getQueryWithAdditionalConditions(),widgetData:t.widgetData,referrer:(o=t.queryProps.chartSetting,`api.performance.generic-widget-chart.${o.replace(/_/g,"-")}`),children:a=>(0,S.tZ)(i.Fragment,{children:(0,S.tZ)(M,{results:a,...t,query:e})})},e.queryKey);var o}function M(t){const e=f(),{results:a,query:r}=t,s=r.transform(t.queryProps,a,t.query);return(0,i.useEffect)((()=>{const i=a?.seriesAdditionalInfo?.[t.queryProps.fields[0]]?.isMetricsData??a?.histograms?.meta?.isMetricsData??a?.tableData?.meta?.isMetricsData;e.setIsMetricsData(i),t.setWidgetDataForKey(r.queryKey,s)}),[s?.hasData,s?.isLoading,s?.isErrored]),(0,S.tZ)(i.Fragment,{})}I.displayName="QueryHandler",C.displayName="SingleQueryHandler",M.displayName="QueryResultSaver";var Z=a("./app/components/charts/styles.tsx"),$=a("./app/components/questionTooltip.tsx"),F=a("./app/components/textOverflow.tsx");function x(t){const{title:e,titleTooltip:a,Subtitle:r,HeaderActions:i}=t;return(0,S.BX)(V,{children:[(0,S.BX)(W,{children:[(0,S.BX)(L,{"data-test-id":"performance-widget-title",children:[(0,S.tZ)(F.Z,{children:e}),(0,S.tZ)(O,{}),(0,S.tZ)($.Z,{position:"top",size:"sm",title:a})]}),r?(0,S.tZ)(r,{...t}):null]}),(0,S.tZ)(b,{children:i&&(0,S.tZ)(i,{...t})})]})}x.displayName="WidgetHeader";const L=(0,r.Z)(Z.ws,{target:"evi51ay3"})({name:"ld8wu3",styles:"position:relative;z-index:initial"}),W=(0,r.Z)("div",{target:"evi51ay2"})({name:"6kz1wu",styles:"display:flex;flex-direction:column;align-items:flex-start"}),V=(0,r.Z)("div",{target:"evi51ay1"})("display:flex;justify-content:space-between;align-items:flex-start;gap:",(0,d.Z)(1),";"),b=(0,r.Z)("div",{target:"evi51ay0"})("display:flex;align-items:center;gap:",(0,d.Z)(1),";");function N(t){const[e,a]=(0,i.useState)({}),r=e[t.chartSetting]??{},s=(0,i.useRef)(r),o=(0,i.useCallback)(((e,r)=>{const i={...s.current,[e]:r};s.current=i,a({[t.chartSetting]:i})}),[e,a]),n=(0,i.useCallback)((e=>{const r={...s.current};delete r[e],s.current=r,a({[t.chartSetting]:r})}),[e,a]),l={widgetData:r,setWidgetDataForKey:o,removeWidgetDataForKey:n},d=Object.entries(t.Queries).map((t=>{let[e,a]=t;return{...a,queryKey:e}})),p=(0,y.Z)(),c=t.Visualizations.reduce(((t,e)=>t+e.height),0);return(0,S.tZ)(i.Fragment,{children:(0,S.BX)(h,{chartSetting:t.chartSetting,children:[(0,S.tZ)(I,{eventView:t.eventView,widgetData:r,setWidgetDataForKey:o,removeWidgetDataForKey:n,queryProps:t,queries:d,api:p}),(0,S.tZ)(U,{...t,...l,totalHeight:c})]})})}function U(t){const{Visualizations:e,chartHeight:a,totalHeight:r,containerType:i,EmptyComponent:s}=t,o=(t=>{let{containerType:e}=t;return"panel"===e?D:P})({containerType:i}),l=Object.keys(t.Queries).length,d=Object.values(t.widgetData).length!==l,_=!d&&Object.values(t.widgetData).every((t=>!t||t.hasData)),m=Object.values(t.widgetData).some((t=>!t||t.isLoading)),u=!d&&Object.values(t.widgetData).some((t=>t&&t.isErrored));return(0,S.BX)(o,{"data-test-id":"performance-widget-container",children:[(0,S.tZ)(z,{children:(0,S.tZ)(x,{...t})}),(0,S.tZ)(v,{isLoading:m,isErrored:u,hasData:_,errorComponent:(0,S.tZ)(q,{height:r}),dataComponents:e.map(((e,r)=>(0,S.tZ)(z,{noPadding:e.noPadding,bottomPadding:e.bottomPadding,"data-test-id":"widget-state-has-data",onClick:()=>{return e=t.chartSetting,a=t.organization,void(0,p.Z)("performance_views.landingv3.widget.interaction",{organization:a,widget_type:e});var e,a},children:(0,c.Z)({value:(0,S.tZ)(e.component,{grid:H,queryFields:e.fields,widgetData:t.widgetData,height:a}),fixed:(0,S.tZ)(n.Z,{height:`${a}px`})})},r))),loadingComponent:(0,S.tZ)(j,{height:`${r}px`}),emptyComponent:s?(0,S.tZ)(s,{}):(0,S.tZ)(j,{height:`${r}px`})})]})}N.displayName="GenericPerformanceWidget",U.displayName="_DataDisplay",(0,s.withRouter)(U);const q=t=>(0,S.tZ)(o.Z,{"data-test-id":"widget-state-is-errored",height:`${t.height}px`,children:(0,S.tZ)(l.F,{color:"gray300",size:"lg"})});q.displayName="DefaultErrorComponent";const H={left:(0,d.Z)(0),right:(0,d.Z)(0),top:(0,d.Z)(2),bottom:(0,d.Z)(1)},z=(0,r.Z)("div",{target:"eqcpc8s1"})("padding-left:",(t=>t.noPadding?(0,d.Z)(0):(0,d.Z)(2)),";padding-right:",(t=>t.noPadding?(0,d.Z)(0):(0,d.Z)(2)),";padding-bottom:",(t=>t.bottomPadding?(0,d.Z)(1):(0,d.Z)(0)),";"),j=(0,r.Z)(n.Z,{target:"eqcpc8s0"})({name:"cs3onb",styles:"border-color:transparent;border-bottom-right-radius:inherit;border-bottom-left-radius:inherit"});N.defaultProps={containerType:"panel",chartHeight:200}},"./app/views/performance/landing/widgets/types.tsx":(t,e,a)=>{let r,i;a.d(e,{A:()=>i}),function(t){t.ERROR="error",t.LOADING="loading",t.EMPTY="empty",t.DATA="data"}(r||(r={})),function(t){t.histogram="histogram",t.area="area",t.vitals="vitals",t.line_list="line_list",t.trends="trends"}(i||(i={}))},"./app/views/performance/landing/widgets/utils.tsx":(t,e,a)=>{a.d(e,{CJ:()=>n,I2:()=>c,gM:()=>d,hD:()=>g,rp:()=>T,zM:()=>A,zS:()=>p}),a("../node_modules/core-js/modules/es.array.includes.js");var r=a("./app/utils.tsx"),i=a("./app/utils/localStorage.tsx"),s=a("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),o=a("./app/views/performance/landing/widgets/widgetDefinitions.tsx");const n=["children","organization","yAxis","period","start","end","environment","project","referrer"],l={};function d(t){let e={};const a=l;return t.shouldQueryProvideMEPAutoParams&&(e={...e,...a,dataset:"metricsEnhanced"}),t.shouldQueryProvideMEPTransactionParams&&(e={...e,...a,dataset:"discover"}),t.shouldQueryProvideMEPMetricParams&&(e={...e,...a,dataset:"metrics"}),(0,r.z)(e)?void 0:e}const p=[o.s.MOST_RELATED_ERRORS,o.s.MOST_RELATED_ISSUES];function c(t,e){if(!p.includes(e))return d(t)}const _="landing-chart-container",m=(t,e,a)=>`landing-chart-container#${e}#${a}#${t}`;function u(){return JSON.parse(i.Z.getItem(_)||"{}")}const T=(t,e,a,r,i)=>{if(i)return r;const s=m(t,a,e),n=u()?.[s];return n&&Object.values(o.s).includes(n)?n:r},A=(t,e,a,r)=>{const s=m(t,a,e),o=u();o[s]=r,function(t){i.Z.setItem(_,JSON.stringify(t))}(o)},S=[o.s.DURATION_HISTOGRAM,o.s.FCP_HISTOGRAM,o.s.LCP_HISTOGRAM,o.s.FID_HISTOGRAM];function g(t,e,a){return!(0,s.gp)(t)||t.features.includes("organizations:performance-mep-reintroduce-histograms")||a.metricSettingState===s.oR.transactionsOnly?e:e.filter((t=>!S.includes(t)))}},"./app/views/performance/landing/widgets/widgetDefinitions.tsx":(t,e,a)=>{a.d(e,{W:()=>d,s:()=>n});var r=a("./app/constants/chartPalette.tsx"),i=a("./app/locale.tsx"),s=a("./app/views/performance/data.tsx"),o=a("./app/views/performance/landing/widgets/types.tsx");let n;!function(t){t.DURATION_HISTOGRAM="duration_histogram",t.LCP_HISTOGRAM="lcp_histogram",t.FCP_HISTOGRAM="fcp_histogram",t.FID_HISTOGRAM="fid_histogram",t.APDEX_AREA="apdex_area",t.P50_DURATION_AREA="p50_duration_area",t.P75_DURATION_AREA="p75_duration_area",t.P95_DURATION_AREA="p95_duration_area",t.P99_DURATION_AREA="p99_duration_area",t.P75_LCP_AREA="p75_lcp_area",t.TPM_AREA="tpm_area",t.FAILURE_RATE_AREA="failure_rate_area",t.USER_MISERY_AREA="user_misery_area",t.WORST_LCP_VITALS="worst_lcp_vitals",t.WORST_FCP_VITALS="worst_fcp_vitals",t.WORST_CLS_VITALS="worst_cls_vitals",t.WORST_FID_VITALS="worst_fid_vitals",t.MOST_IMPROVED="most_improved",t.MOST_REGRESSED="most_regressed",t.MOST_RELATED_ERRORS="most_related_errors",t.MOST_RELATED_ISSUES="most_related_issues",t.SLOW_HTTP_OPS="slow_http_ops",t.SLOW_DB_OPS="slow_db_ops",t.SLOW_RESOURCE_OPS="slow_resource_ops",t.SLOW_BROWSER_OPS="slow_browser_ops",t.COLD_STARTUP_AREA="cold_startup_area",t.WARM_STARTUP_AREA="warm_startup_area",t.SLOW_FRAMES_AREA="slow_frames_area",t.FROZEN_FRAMES_AREA="frozen_frames_area",t.MOST_SLOW_FRAMES="most_slow_frames",t.MOST_FROZEN_FRAMES="most_frozen_frames"}(n||(n={}));const l=r.Z[5],d=t=>{let{organization:e}=t;return{[n.DURATION_HISTOGRAM]:{title:(0,i.t)("Duration Distribution"),titleTooltip:(0,s.$r)(e,s.V$.DURATION_DISTRIBUTION),fields:["transaction.duration"],dataType:o.A.histogram,chartColor:l[5]},[n.LCP_HISTOGRAM]:{title:(0,i.t)("LCP Distribution"),titleTooltip:(0,s.$r)(e,s.V$.DURATION_DISTRIBUTION),fields:["measurements.lcp"],dataType:o.A.histogram,chartColor:l[5]},[n.FCP_HISTOGRAM]:{title:(0,i.t)("FCP Distribution"),titleTooltip:(0,s.$r)(e,s.V$.DURATION_DISTRIBUTION),fields:["measurements.fcp"],dataType:o.A.histogram,chartColor:l[5]},[n.FID_HISTOGRAM]:{title:(0,i.t)("FID Distribution"),titleTooltip:(0,s.$r)(e,s.V$.DURATION_DISTRIBUTION),fields:["measurements.fid"],dataType:o.A.histogram,chartColor:l[5]},[n.WORST_LCP_VITALS]:{title:(0,i.t)("Worst LCP Web Vitals"),titleTooltip:(0,s.$r)(e,s.V$.LCP),fields:["measurements.lcp"],vitalStops:{poor:4e3,meh:2500},dataType:o.A.vitals},[n.WORST_FCP_VITALS]:{title:(0,i.t)("Worst FCP Web Vitals"),titleTooltip:(0,s.$r)(e,s.V$.FCP),fields:["measurements.fcp"],vitalStops:{poor:3e3,meh:1e3},dataType:o.A.vitals},[n.WORST_FID_VITALS]:{title:(0,i.t)("Worst FID Web Vitals"),titleTooltip:(0,s.$r)(e,s.V$.FID),fields:["measurements.fid"],vitalStops:{poor:300,meh:100},dataType:o.A.vitals},[n.WORST_CLS_VITALS]:{title:(0,i.t)("Worst CLS Web Vitals"),titleTooltip:(0,s.$r)(e,s.V$.CLS),fields:["measurements.cls"],vitalStops:{poor:.25,meh:.1},dataType:o.A.vitals},[n.TPM_AREA]:{title:(0,i.t)("Transactions Per Minute"),titleTooltip:(0,s.$r)(e,s.V$.TPM),fields:["tpm()"],dataType:o.A.area,chartColor:l[1],allowsOpenInDiscover:!0},[n.APDEX_AREA]:{title:(0,i.t)("Apdex"),titleTooltip:(0,s.$r)(e,s.V$.APDEX),fields:["apdex()"],dataType:o.A.area,chartColor:l[4],allowsOpenInDiscover:!0},[n.P50_DURATION_AREA]:{title:(0,i.t)("p50 Duration"),titleTooltip:(0,s.$r)(e,s.V$.P50),fields:["p50(transaction.duration)"],dataType:o.A.area,chartColor:l[3],allowsOpenInDiscover:!0},[n.P75_DURATION_AREA]:{title:(0,i.t)("p75 Duration"),titleTooltip:(0,s.$r)(e,s.V$.P75),fields:["p75(transaction.duration)"],dataType:o.A.area,chartColor:l[3],allowsOpenInDiscover:!0},[n.P95_DURATION_AREA]:{title:(0,i.t)("p95 Duration"),titleTooltip:(0,s.$r)(e,s.V$.P95),fields:["p95(transaction.duration)"],dataType:o.A.area,chartColor:l[3],allowsOpenInDiscover:!0},[n.P99_DURATION_AREA]:{title:(0,i.t)("p99 Duration"),titleTooltip:(0,s.$r)(e,s.V$.P99),fields:["p99(transaction.duration)"],dataType:o.A.area,chartColor:l[3],allowsOpenInDiscover:!0},[n.P75_LCP_AREA]:{title:(0,i.t)("p75 LCP"),titleTooltip:(0,s.$r)(e,s.V$.P75),fields:["p75(measurements.lcp)"],dataType:o.A.area,chartColor:l[1],allowsOpenInDiscover:!0},[n.FAILURE_RATE_AREA]:{title:(0,i.t)("Failure Rate"),titleTooltip:(0,s.$r)(e,s.V$.FAILURE_RATE),fields:["failure_rate()"],dataType:o.A.area,chartColor:l[2],allowsOpenInDiscover:!0},[n.USER_MISERY_AREA]:{title:(0,i.t)("User Misery"),titleTooltip:(0,s.$r)(e,s.V$.USER_MISERY),fields:["user_misery()"],dataType:o.A.area,chartColor:l[0],allowsOpenInDiscover:!0},[n.COLD_STARTUP_AREA]:{title:(0,i.t)("Cold Startup Time"),titleTooltip:(0,s.$r)(e,s.V$.APP_START_COLD),fields:["p75(measurements.app_start_cold)"],dataType:o.A.area,chartColor:l[4],allowsOpenInDiscover:!0},[n.WARM_STARTUP_AREA]:{title:(0,i.t)("Warm Startup Time"),titleTooltip:(0,s.$r)(e,s.V$.APP_START_WARM),fields:["p75(measurements.app_start_warm)"],dataType:o.A.area,chartColor:l[3],allowsOpenInDiscover:!0},[n.SLOW_FRAMES_AREA]:{title:(0,i.t)("Slow Frames"),titleTooltip:(0,s.$r)(e,s.V$.SLOW_FRAMES),fields:["p75(measurements.frames_slow_rate)"],dataType:o.A.area,chartColor:l[0],allowsOpenInDiscover:!0},[n.FROZEN_FRAMES_AREA]:{title:(0,i.t)("Frozen Frames"),titleTooltip:(0,s.$r)(e,s.V$.FROZEN_FRAMES),fields:["p75(measurements.frames_frozen_rate)"],dataType:o.A.area,chartColor:l[5],allowsOpenInDiscover:!0},[n.MOST_RELATED_ERRORS]:{title:(0,i.t)("Most Related Errors"),titleTooltip:(0,s.$r)(e,s.V$.MOST_ERRORS),fields:["failure_count()"],dataType:o.A.line_list,chartColor:l[0]},[n.MOST_RELATED_ISSUES]:{title:(0,i.t)("Most Related Issues"),titleTooltip:(0,s.$r)(e,s.V$.MOST_ISSUES),fields:["count()"],dataType:o.A.line_list,chartColor:l[0]},[n.SLOW_HTTP_OPS]:{title:(0,i.t)("Slow HTTP Ops"),titleTooltip:(0,s.$r)(e,s.V$.SLOW_HTTP_SPANS),fields:["p75(spans.http)"],dataType:o.A.line_list,chartColor:l[0]},[n.SLOW_BROWSER_OPS]:{title:(0,i.t)("Slow Browser Ops"),titleTooltip:(0,s.$r)(e,s.V$.SLOW_HTTP_SPANS),fields:["p75(spans.browser)"],dataType:o.A.line_list,chartColor:l[0]},[n.SLOW_RESOURCE_OPS]:{title:(0,i.t)("Slow Resource Ops"),titleTooltip:(0,s.$r)(e,s.V$.SLOW_HTTP_SPANS),fields:["p75(spans.resource)"],dataType:o.A.line_list,chartColor:l[0]},[n.SLOW_DB_OPS]:{title:(0,i.t)("Slow DB Ops"),titleTooltip:(0,s.$r)(e,s.V$.SLOW_HTTP_SPANS),fields:["p75(spans.db)"],dataType:o.A.line_list,chartColor:l[0]},[n.MOST_SLOW_FRAMES]:{title:(0,i.t)("Most Slow Frames"),titleTooltip:(0,s.$r)(e,s.V$.SLOW_FRAMES),fields:["avg(measurements.frames_slow)"],dataType:o.A.line_list,chartColor:l[0]},[n.MOST_FROZEN_FRAMES]:{title:(0,i.t)("Most Frozen Frames"),titleTooltip:(0,s.$r)(e,s.V$.FROZEN_FRAMES),fields:["avg(measurements.frames_frozen)"],dataType:o.A.line_list,chartColor:l[0]},[n.MOST_IMPROVED]:{title:(0,i.t)("Most Improved"),titleTooltip:(0,i.t)("This compares the baseline (%s) of the past with the present.","improved"),fields:[],dataType:o.A.trends},[n.MOST_REGRESSED]:{title:(0,i.t)("Most Regressed"),titleTooltip:(0,i.t)("This compares the baseline (%s) of the past with the present.","regressed"),fields:[],dataType:o.A.trends}}}}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_landing_widgets_components_performanceWidget_tsx.9d85420eb0ac0195632b0bf4406d26fb.js.map