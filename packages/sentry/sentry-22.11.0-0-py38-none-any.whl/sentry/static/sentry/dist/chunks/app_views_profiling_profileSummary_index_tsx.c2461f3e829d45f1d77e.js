"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_profiling_profileSummary_index_tsx"],{"./app/components/profiling/breadcrumb.tsx":(e,t,r)=>{r.d(t,{a:()=>u}),r("../node_modules/core-js/modules/es.error.cause.js");var o=r("../node_modules/react/index.js"),n=r("../node_modules/lodash/omit.js"),s=r.n(n),a=r("./app/components/breadcrumbs.tsx"),i=r("./app/locale.tsx"),l=r("./app/utils/profiling/routes.tsx"),c=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function u(e){let{organization:t,trails:r}=e;const n=(0,o.useMemo)((()=>r.map((e=>function(e,t){let{organization:r}=t;switch(e.type){case"landing":return{to:(0,l.XR)({query:s()(e.payload.query,["cursor","query"]),orgSlug:r.slug}),label:(0,i.t)("Profiling"),preservePageFilters:!0};case"profile summary":return{to:(0,l.R0)({query:s()(e.payload.query,["cursor","query"]),orgSlug:r.slug,projectSlug:e.payload.projectSlug,transaction:e.payload.transaction}),label:(0,i.t)("Profile Summary"),preservePageFilters:!0};case"flamechart":return{to:("flamechart"===e.payload.tab?l.TH:l.Qy)({query:e.payload.query,orgSlug:r.slug,projectSlug:e.payload.projectSlug,profileId:e.payload.profileId}),label:e.payload.transaction,preservePageFilters:!0};default:throw new Error(`Unknown breadcrumb type: ${JSON.stringify(e)}`)}}(e,{organization:t})))),[t,r]);return(0,c.tZ)(a.Z,{crumbs:n})}u.displayName="Breadcrumb"},"./app/views/profiling/profileSummary/index.tsx":(e,t,r)=>{r.r(t),r.d(t,{default:()=>pe});var o=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=r("../node_modules/react/index.js"),s=r("../node_modules/react-router/es/index.js"),a=r("./app/components/datePageFilter.tsx"),i=r("./app/components/environmentPageFilter.tsx"),l=r("./app/components/idBadge/index.tsx"),c=r("./app/components/layouts/thirds.tsx"),u=r("./app/components/noProjectMessage.tsx"),p=r("./app/components/organizations/pageFilterBar.tsx"),d=r("./app/components/organizations/pageFilters/container.tsx"),m=r("./app/components/profiling/breadcrumb.tsx"),g=r("./app/components/sentryDocumentTitle.tsx"),y=r("./app/components/smartSearchBar/index.tsx"),f=r("./app/constants/index.tsx"),h=r("./app/locale.tsx"),x=r("./app/styles/space.tsx"),Z=r("./app/utils.tsx"),b=r("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),k=r("./app/utils/discover/fields.tsx"),v=r("./app/utils/profiling/hooks/useProfileFilters.tsx"),q=r("./app/utils/queryString.tsx"),w=r("./app/utils/tokenizeSearch.tsx"),S=r("./app/utils/useOrganization.tsx"),j=r("./app/utils/useProjects.tsx"),P=r("./app/utils/withPageFilters.tsx"),z=r("./app/components/compactSelect.tsx"),F=r("./app/components/pagination.tsx"),_=r("./app/components/count.tsx"),C=r("./app/components/gridEditable/index.tsx"),T=r("./app/components/performanceDuration.tsx"),B=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function L(e){let{items:t}=e;const[r,o]=(0,n.useState)(!1),s=t[0];return(0,B.BX)(E,{expanded:r,children:[s&&(0,B.tZ)(M,{item:s}),t.length>1&&r&&t.slice(1,t.length).map((e=>(0,B.tZ)(M,{item:e},e.value))),t.length>1?(0,B.tZ)(N,{children:(0,B.tZ)("button",{onClick:()=>o(!r),children:r?(0,h.t)("[collapse]"):(0,h.t)("[+%s more]",t.length-1)})}):null]})}function M(e){let{item:t}=e;return(0,B.tZ)(X,{children:(0,B.tZ)(s.Link,{to:t.target,children:t.value})})}L.displayName="ArrayLinks",M.displayName="LinkedItem";const E=(0,o.Z)("div",{target:"e11x8nqr2"})("display:flex;flex-direction:",(e=>e.expanded?"column":"row"),";"),X=(0,o.Z)("span",{target:"e11x8nqr1"})("flex-shrink:1;display:block;",(e=>e.theme.overflowEllipsis),";width:unset;"),N=(0,o.Z)("div",{target:"e11x8nqr0"})("white-space:nowrap;& button{background:none;border:0;outline:none;padding:0;cursor:pointer;color:",(e=>e.theme.blue300),";margin-left:",(0,x.Z)(.5),";}");var A=r("./app/utils/discover/styles.tsx"),H=r("./app/utils/events.tsx"),I=r("./app/utils/profiling/routes.tsx"),R=r("./app/utils/profiling/tableRenderer.tsx"),D=r("./app/utils/useLocation.tsx");function $(e){const t=(0,D.T)(),r=(0,S.Z)(),o=(0,n.useMemo)((()=>{let t=e.sort,r="asc";return e.sort.startsWith("-")&&(t=e.sort.substring(1),r="desc"),O.has(t)||(t="p99"),{key:t,order:r}}),[e.sort]),s=(0,n.useMemo)((()=>e.functions.map((t=>{const{worst:o,examples:n,...s}=t,a=n.filter((e=>e!==o));return a.unshift(o),{...s,examples:a.map((o=>{const n=o.replaceAll("-","");return{value:(0,H.XQ)(n),target:(0,I.TH)({orgSlug:r.slug,projectSlug:e.project.slug,profileId:n,query:{frameName:t.name,framePackage:t.package}})}}))}}))),[r.slug,e.project.slug,e.functions]),a=(0,n.useCallback)((e=>{if(!O.has(e))return()=>{};const r=o.key!==e?"desc":"desc"===o.order?"asc":"desc";return()=>({...t,query:{...t.query,functionsSort:`${"desc"===r?"-":""}${e}`}})}),[t,o]);return(0,B.tZ)(C.ZP,{isLoading:e.isLoading,error:e.error,data:s,columnOrder:Y.map((e=>G[e])),columnSortBy:[],grid:{renderHeadCell:(0,R.w)({currentSort:o,rightAlignedColumns:W,sortableColumns:O,generateSortLink:a}),renderBodyCell:Q},location:t})}$.displayName="FunctionsTable";const W=new Set(["p75","p99","count"]),O=W;function Q(e,t,r,o){return(0,B.tZ)(V,{column:e,dataRow:t,rowIndex:r,columnIndex:o})}Q.displayName="renderFunctionsTableCell";const U=(0,o.Z)("span",{target:"ef2cp6g0"})("color:",(e=>e.theme.gray300),";");function V(e){let{column:t,dataRow:r}=e;const o=r[t.key];switch(t.key){case"count":return(0,B.tZ)(A.Hw,{children:(0,B.tZ)(_.Z,{value:o})});case"p75":case"p99":return(0,B.tZ)(A.Hw,{children:(0,B.tZ)(T.Z,{nanoseconds:o,abbreviation:!0})});case"examples":return(0,B.tZ)(L,{items:o});case"name":case"package":const e=o||(0,B.tZ)(U,{children:(0,h.t)("Unknown")});return(0,B.tZ)(A.W2,{children:e});default:return(0,B.tZ)(A.W2,{children:o})}}const Y=["name","package","count","p75","p99","examples"],G={name:{key:"name",name:(0,h.t)("Name"),width:C.z7},package:{key:"package",name:(0,h.t)("Package"),width:C.z7},path:{key:"path",name:(0,h.t)("Path"),width:C.z7},p75:{key:"p75",name:(0,h.t)("P75 Duration"),width:C.z7},p99:{key:"p99",name:(0,h.t)("P99 Duration"),width:C.z7},count:{key:"count",name:(0,h.t)("Count"),width:C.z7},examples:{key:"examples",name:(0,h.t)("Example Profiles"),width:C.z7}};var J=r("./app/components/profiling/profileEventsTable.tsx"),K=r("../node_modules/@sentry/browser/node_modules/@sentry/core/esm/exports.js"),ee=r("./app/components/organizations/pageFilters/parse.tsx"),te=r("./app/utils/useApi.tsx");var re=r("./app/utils/profiling/hooks/useProfileEvents.tsx");function oe(e){const t=(0,n.useMemo)((()=>(0,q.ro)(e.location.query.cursor)),[e.location.query.cursor]),r=(0,n.useMemo)((()=>(0,q.ro)(e.location.query.functionsCursor)),[e.location.query.functionsCursor]),o=(0,n.useMemo)((()=>(0,q.ro)(e.location.query.functionsSort,"-p99")),[e.location.query.functionsSort]),a=(0,re.k)((0,q.ro)(e.location.query.sort),ne,{key:"timestamp",order:"desc"}),i=(0,re.G)({cursor:t,fields:ne,query:e.query,sort:a,limit:5,referrer:"api.profiling.profile-summary-table"}),[l,u]=(0,n.useState)("application"),p=function(e){let{functionType:t,project:r,query:o,transaction:s,sort:a,cursor:i,selection:l}=e;const c=(0,te.Z)(),u=(0,S.Z)(),[p,d]=(0,n.useState)({type:"initial"});return(0,n.useEffect)((()=>{if(void 0!==l)return d({type:"loading"}),function(e,t,r){let{cursor:o,functionType:n,projectSlug:s,query:a,selection:i,sort:l,transaction:c}=r;const u=new w.MY(a);return u.setFilterValues("transaction_name",[c]),e.requestPromise(`/projects/${t.slug}/${s}/profiling/functions/`,{method:"GET",includeAllArgs:!0,query:{cursor:o,environment:i.environments,...(0,ee.fK)(i.datetime),query:u.formatString(),sort:l,is_application:"application"===n?"1":"system"===n?"0":void 0}})}(c,u,{functionType:t,projectSlug:r.slug,query:o,selection:l,sort:a,transaction:s,cursor:i}).then((e=>{let[t,,r]=e;d({type:"resolved",data:{functions:t.functions??[],pageLinks:r?.getResponseHeader("Link")??null}})})).catch((e=>{d({type:"errored",error:(0,h.t)("Error: Unable to load functions")}),K.Tb(e)})),()=>c.clear()}),[c,i,t,u,r.slug,o,l,a,s]),p}({cursor:r,project:e.project,query:"",selection:e.selection,transaction:e.transaction,sort:o,functionType:l}),d=(0,n.useCallback)(((e,t,r)=>{s.browserHistory.push({pathname:t,query:{...r,functionsCursor:e}})}),[]),m=(0,n.useCallback)((t=>{s.browserHistory.push({...e.location,query:{...e.location.query,sort:t}})}),[e.location]);return(0,B.BX)(c.or,{fullWidth:!0,children:[(0,B.BX)(ae,{children:[(0,B.tZ)(z.Z,{triggerProps:{prefix:(0,h.t)("Filter"),size:"xs"},value:"asc"===a.order?a.key:`-${a.key}`,options:se,onChange:e=>m(e.value)}),(0,B.tZ)(ie,{pageLinks:"success"===i.status?i.data?.[2]?.getResponseHeader("Link")??null:null,size:"xs"})]}),(0,B.tZ)(J.Q,{columns:ne,data:"success"===i.status?i.data[0]:null,error:"error"===i.status?(0,h.t)("Unable to load profiles"):null,isLoading:"loading"===i.status,sort:a}),(0,B.BX)(ae,{children:[(0,B.tZ)(z.Z,{triggerProps:{prefix:(0,h.t)("Suspect Functions"),size:"xs"},value:l,options:[{label:(0,h.t)("All"),value:"all"},{label:(0,h.t)("Application"),value:"application"},{label:(0,h.t)("System"),value:"system"}],onChange:e=>{let{value:t}=e;return u(t)}}),(0,B.tZ)(ie,{pageLinks:"resolved"===p.type?p.data.pageLinks:null,onCursor:d,size:"xs"})]}),(0,B.tZ)($,{error:"errored"===p.type?p.error:null,isLoading:"initial"===p.type||"loading"===p.type,functions:"resolved"===p.type?p.data.functions:[],project:e.project,sort:o})]})}oe.displayName="ProfileSummaryContent";const ne=["id","timestamp","release","device.model","device.classification","profile.duration"],se=[{label:(0,h.t)("Recent Profiles"),value:"-timestamp"},{label:(0,h.t)("Slowest Profiles"),value:"-profile.duration"},{label:(0,h.t)("Fastest Profiles"),value:"profile.duration"}],ae=(0,o.Z)("div",{target:"ewy0nsd1"})("display:flex;justify-content:space-between;margin-bottom:",(0,x.Z)(1),";"),ie=(0,o.Z)(F.Z,{target:"ewy0nsd0"})("margin:0 0 0 ",(0,x.Z)(1),";");function le(e){const t=(0,S.Z)(),{projects:r}=(0,j.Z)({slugs:(0,Z.ri)(e.params.projectId)?[e.params.projectId]:[]});(0,n.useEffect)((()=>{(0,b.Z)("profiling_views.profile_summary",{organization:t})}),[t]);const o=1===r.length?r[0]:null,x=(0,q.ro)(e.location.query.transaction),P=(0,n.useMemo)((()=>(0,q.ro)(e.location.query.query,"")),[e.location.query.query]),z=(0,n.useMemo)((()=>{const e=new w.MY(P);return(0,Z.ri)(x)&&e.setFilterValues("transaction",[x]),Object.keys(e.filters).forEach((t=>{(0,k.h1)(t)&&e.removeFilter(t)})),e.formatString()}),[P,x]),F=(0,n.useMemo)((()=>{const e=new w.MY("");return(0,Z.ri)(x)&&e.setFilterValues("transaction_name",[x]),e.formatString()}),[x]),_=(0,v.J)({query:F,selection:e.selection}),C=(0,n.useCallback)((t=>{s.browserHistory.push({...e.location,query:{...e.location.query,query:t||void 0}})}),[e.location]);return(0,B.tZ)(g.Z,{title:(0,h.t)("Profiling — Profile Summary"),orgSlug:t.slug,children:(0,B.tZ)(d.Z,{shouldForceProject:(0,Z.ri)(o),forceProject:o,specificProjectSlugs:(0,Z.ri)(o)?[o.slug]:[],children:(0,B.tZ)(u.Z,{organization:t,children:o&&x&&(0,B.BX)(n.Fragment,{children:[(0,B.tZ)(c.h4,{children:(0,B.BX)(c.oB,{children:[(0,B.tZ)(m.a,{organization:t,trails:[{type:"landing",payload:{query:e.location.query}},{type:"profile summary",payload:{projectSlug:o.slug,query:e.location.query,transaction:x}}]}),(0,B.tZ)(c.Dx,{children:(0,B.BX)(ce,{children:[(0,B.tZ)(l.Z,{project:o,avatarSize:28,hideName:!0,avatarProps:{hasTooltip:!0,tooltip:o.slug}}),x]})})]})}),(0,B.tZ)(c.uT,{children:(0,B.BX)(c.or,{fullWidth:!0,children:[(0,B.BX)(ue,{children:[(0,B.BX)(p.Z,{condensed:!0,children:[(0,B.tZ)(i.Z,{}),(0,B.tZ)(a.Z,{alignDropdown:"left"})]}),(0,B.tZ)(y.Z,{organization:t,hasRecentSearches:!0,searchSource:"profile_summary",supportedTags:_,query:P,onSearch:C,maxQueryLength:f.dI})]}),(0,B.tZ)(oe,{location:e.location,project:o,selection:e.selection,transaction:x,query:z})]})})]})})})})}le.displayName="ProfileSummaryPage";const ce=(0,o.Z)("div",{target:"ecjk55m1"})("display:flex;gap:",(0,x.Z)(1),";"),ue=(0,o.Z)("div",{target:"ecjk55m0"})("display:grid;gap:",(0,x.Z)(2),";grid-template-columns:min-content auto;margin-bottom:",(0,x.Z)(2),";"),pe=(0,P.Z)(le)}}]);
//# sourceMappingURL=../sourcemaps/app_views_profiling_profileSummary_index_tsx.c6ce8a4891750e93e4c1882aabf6144d.js.map