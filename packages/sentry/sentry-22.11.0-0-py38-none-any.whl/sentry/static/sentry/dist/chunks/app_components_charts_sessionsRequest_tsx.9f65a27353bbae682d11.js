"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_charts_sessionsRequest_tsx"],{"./app/components/charts/sessionsRequest.tsx":(e,t,s)=>{s.d(t,{Z:()=>g});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),o=s("../node_modules/lodash/isEqual.js"),a=s.n(o),i=s("../node_modules/lodash/omitBy.js"),l=s.n(i),d=s("./app/actionCreators/indicator.tsx"),u=s("./app/locale.tsx"),c=s("./app/utils/sessions.tsx");const h=["api","children","organization"],p=e=>l()(e,((e,t)=>h.includes(t)));class m extends n.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{reloading:!1,errored:!1,response:null}),(0,r.Z)(this,"fetchData",(async()=>{const{api:e,isDisabled:t,shouldFilterSessionsInTimeWindow:s}=this.props;if(!t){this.setState((e=>({reloading:null!==e.response,errored:!1})));try{const t=await e.requestPromise(this.path,{query:this.baseQueryParams});this.setState({reloading:!1,response:s?(0,c.U5)(t,this.baseQueryParams.start,this.baseQueryParams.end):t})}catch(e){(0,d.Iw)(e.responseJSON?.detail??(0,u.t)("Error loading health data")),this.setState({reloading:!1,errored:!0})}}}))}componentDidMount(){this.fetchData()}componentDidUpdate(e){a()(p(e),p(this.props))||this.fetchData()}get path(){const{organization:e}=this.props;return`/organizations/${e.slug}/sessions/`}get baseQueryParams(){const{project:e,environment:t,field:s,statsPeriod:r,start:n,end:o,query:a,groupBy:i,interval:l,organization:d}=this.props;return{project:e,environment:t,field:s,statsPeriod:r,query:a,groupBy:i,start:n,end:o,interval:l||(0,c.Xz)({start:n,end:o,period:r},{highFidelity:d.features.includes("minute-resolution-sessions")})}}render(){const{reloading:e,errored:t,response:s}=this.state,{children:r}=this.props;return r({loading:null===s,reloading:e,errored:t,response:s})}}m.displayName="SessionsRequest";const g=m},"./app/utils/sessions.tsx":(e,t,s)=>{s.d(t,{$K:()=>v,BN:()=>y,FS:()=>A,Lv:()=>N,Pn:()=>E,SU:()=>f,U5:()=>b,VH:()=>m,Xz:()=>C,Y5:()=>R,hD:()=>H,iy:()=>D,mo:()=>w,sA:()=>g,wt:()=>S}),s("../node_modules/core-js/modules/es.array.includes.js");var r=s("../node_modules/lodash/compact.js"),n=s.n(r),o=s("../node_modules/lodash/mean.js"),a=s.n(o),i=s("../node_modules/moment/moment.js"),l=s.n(i),d=s("./app/components/charts/utils.tsx"),u=s("./app/types/index.tsx"),c=s("./app/utils.tsx"),h=s("./app/views/releases/utils/index.tsx"),p=s("./app/views/releases/utils/sessionTerm.tsx");const m=10;function g(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return e.reduce(((e,s)=>e+s.totals[t]),0)}function f(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,s=arguments.length>2?arguments[2]:void 0;return e.reduce(((e,r)=>e+r.series[t][s]),0)}function E(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;const s=y(e,t,u.$y.CRASHED);return(0,c.ri)(s)?(0,h.Mf)(100-s):null}function v(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;const s=g(e,t),r=e.filter((e=>!!e.totals[t])).length;return(0,c.ri)(s)&&null!==r&&0!==s?s/r:null}function S(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const r=Array(s.length).fill(0),n=e.map((e=>e.series[t]));return n.forEach((e=>{e.forEach(((e,t)=>r[t]+=e))})),r}function y(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,s=arguments.length>2?arguments[2]:void 0;const r=g(e,t),n=g(e.filter((e=>{let{by:t}=e;return t["session.status"]===s})),t);return(0,c.ri)(r)&&0!==r?(0,c.aQ)(n??0,r??0):null}function A(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2?arguments[2]:void 0;return n()(t.map(((t,r)=>{const n=e.reduce(((e,t)=>e+(t.series[s]?.[r]??0)),0),o=e.find((e=>e.by["session.status"]===u.$y.CRASHED))?.series[s]?.[r]??0,a=(0,c.aQ)(o,n);return 0===n?null:{name:t,value:(0,h.Mf)(100-a)}})))}function R(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return n()(t.map(((t,n)=>{const o=e.reduce(((e,t)=>e+t.series[s][n]),0),a=e.find((e=>e.by["session.status"]===r))?.series[s][n]??0,i=(0,c.aQ)(a,o);return 0===o?null:{name:t,value:(0,h.r)(i)}})))}function w(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return n()(t.map(((t,n)=>{const o=a()(e.map((e=>e.series[s][n])).filter((e=>!!e)));return o?{name:t,value:"function"==typeof r?r(o):o}:null})))}function H(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3?arguments[3]:void 0;return s.map(((s,n)=>{const o=e.reduce(((e,t)=>e+(t.series[r]?.[n]??0)),0),a=t.reduce(((e,t)=>e+(t.series[r]?.[n]??0)),0),i=(0,c.aQ)(o,a);return{name:s,value:Math.round(i)}}))}function D(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return s.map(((s,r)=>({name:s,value:t?.series[e][r]??0})))}function N(e){const t=e.charts.getColorPalette(14);return{[u.$y.HEALTHY]:{seriesName:p.U1.healthy,data:[],color:e.green300,areaStyle:{color:e.green300,opacity:1},lineStyle:{opacity:0,width:.4}},[u.$y.ERRORED]:{seriesName:p.U1.errored,data:[],color:t[12],areaStyle:{color:t[12],opacity:1},lineStyle:{opacity:0,width:.4}},[u.$y.ABNORMAL]:{seriesName:p.U1.abnormal,data:[],color:t[15],areaStyle:{color:t[15],opacity:1},lineStyle:{opacity:0,width:.4}},[u.$y.CRASHED]:{seriesName:p.U1.crashed,data:[],color:e.red300,areaStyle:{color:e.red300,opacity:1},lineStyle:{opacity:0,width:.4}}}}function C(e){let{highFidelity:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=(0,d.Nm)(e);return l()(e.start).isSameOrBefore(l()().subtract(30,"days"))&&(t=!1),s>=d.Zn?"1d":s>=d.B8?"4h":s>=d.aC?"1h":t?s<=m?"10s":s<=30?"1m":"5m":"1h"}function b(e,t,s){if(!t||!s)return e;const r=[],n=e.intervals.filter(((e,n)=>{const o=l().utc(e).isBetween(l().utc(t),l().utc(s),void 0,"[]");return o&&r.push(n),o})),o=e.groups.map((e=>{const t={},s={};return Object.keys(e.series).forEach((n=>{s[n]=0,t[n]=e.series[n].filter(((e,t)=>{const o=r.includes(t);return o&&(s[n]=(s[n]??0)+e),o})),n.startsWith("p50")&&(s[n]=a()(t[n])),n.startsWith("count_unique")&&(s[n]=e.totals[n])})),{...e,series:t,totals:s}}));return{start:n[0],end:n[n.length-1],query:e.query,intervals:n,groups:o}}},"./app/views/releases/utils/index.tsx":(e,t,s)=>{s.d(t,{C8:()=>x,EB:()=>j,G$:()=>H,G5:()=>y,Jl:()=>T,Mf:()=>A,O7:()=>O,PS:()=>D,TB:()=>C,eY:()=>N,hf:()=>S,me:()=>F,r:()=>w,rF:()=>b,zB:()=>R}),s("../node_modules/core-js/modules/es.array.includes.js");var r=s("../node_modules/lodash/pick.js"),n=s.n(r),o=s("../node_modules/lodash/round.js"),a=s.n(o),i=s("../node_modules/moment/moment.js"),l=s.n(i),d=s("./app/components/links/externalLink.tsx"),u=s("./app/components/organizations/pageFilters/parse.tsx"),c=s("./app/constants/pageFilters.tsx"),h=s("./app/data/platformCategories.tsx"),p=s("./app/locale.tsx"),m=s("./app/types/index.tsx"),g=s("./app/utils.tsx"),f=s("./app/utils/tokenizeSearch.tsx"),E=s("./app/views/issueList/utils.tsx"),v=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const S=95,y=e=>a()(e,e>60?0:3),A=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;const r=a()(e,e>t?s:0);return 100===r&&e<100?Math.floor(e*Math.pow(10,s))/Math.pow(10,s):r},R=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;if(isNaN(e))return"â€•";if(e<1&&e>0)return"<1%";const r=A(e,t,s).toLocaleString();return`${r}%`},w=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return a()(t?Math.abs(e):e,3)},H=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return`${w(e,t).toLocaleString()}%`},D=(e,t,s)=>({pathname:`/organizations/${e}/issues/`,query:{project:t,statsPeriod:void 0,start:void 0,end:void 0,query:new f.MY([`firstRelease:${s}`]).formatString(),sort:E.qh.FREQ}}),N=function(e,t,s){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return{pathname:`/organizations/${e}/issues/`,query:{...r,project:t,query:new f.MY([`release:${s}`,"error.unhandled:true"]).formatString(),sort:E.qh.FREQ}}},C=function(e,t,s){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return{pathname:`/organizations/${e}/issues/`,query:{...r,project:t,query:new f.MY([`release:${s}`,"error.handled:true"]).formatString(),sort:E.qh.FREQ}}},b=e=>e.status===m.dE.Archived;function x(e){const t=l()().subtract(90,"days"),{lastEvent:s,currentProjectMeta:r,dateCreated:n}=e||{},{sessionsUpperBound:o}=r||{};let a="normal",i=l()(n).startOf("minute"),d=l()((l()(o).isAfter(s)?o:s)??void 0).endOf("minute");return l()(i).isSame(d,"minute")&&(d=l()(d).add(1,"minutes")),i.isBefore(t)&&(i=t,a="clamped",(d.isBefore(i)||!(0,g.ri)(o)&&!(0,g.ri)(s))&&(d=l()(),a="ancient")),{type:a,releaseStart:i.utc().format(),releaseEnd:d.utc().format()}}function O(e){let{location:t,releaseBounds:s}=e;const r=(0,u.fK)(n()(t.query,[...Object.values(c.nF),...Object.values(c.V),"cursor"]),{allowAbsolutePageDatetime:!0,allowEmptyPeriod:!0});return Object.keys(r).some((e=>[c.nF.START,c.nF.END,c.nF.UTC,c.nF.PERIOD].includes(e)))||(r[c.nF.START]=s.releaseStart,r[c.nF.END]=s.releaseEnd),r}const _=(0,v.tZ)(d.Z,{href:"https://docs.sentry.io/product/releases/health/#adoption-stages"}),j={low_adoption:{name:(0,p.t)("Low Adoption"),tooltipTitle:(0,p._N)("This release has a low percentage of sessions compared to other releases in this project. [link:Learn more]",{link:_}),type:"warning"},adopted:{name:(0,p.t)("Adopted"),tooltipTitle:(0,p._N)("This release has a high percentage of sessions compared to other releases in this project. [link:Learn more]",{link:_}),type:"success"},replaced:{name:(0,p.t)("Replaced"),tooltipTitle:(0,p._N)("This release was previously Adopted, but now has a lower level of sessions compared to other releases in this project. [link:Learn more]",{link:_}),type:"default"}},T=e=>[...h.ai,...h.gv].includes(e);function F(e){return`release:"${e.replace(/"/g,'\\"')}"`}},"./app/views/releases/utils/sessionTerm.tsx":(e,t,s)=>{s.d(t,{RE:()=>d,U1:()=>o,_k:()=>n,w0:()=>a});var r=s("./app/locale.tsx");let n;!function(e){e.CRASHES="crashes",e.CRASHED="crashed",e.ABNORMAL="abnormal",e.CRASH_FREE="crashFree",e.CRASH_FREE_USERS="crash-free-users",e.CRASH_FREE_SESSIONS="crash-free-sessions",e.HEALTHY="healthy",e.ERRORED="errored",e.UNHANDLED="unhandled",e.STABILITY="stability",e.ADOPTION="adoption"}(n||(n={}));const o={[n.CRASHES]:(0,r.t)("Crashes"),[n.CRASHED]:(0,r.t)("Crashed"),[n.ABNORMAL]:(0,r.t)("Abnormal"),[n.CRASH_FREE_USERS]:(0,r.t)("Crash Free Users"),[n.CRASH_FREE_SESSIONS]:(0,r.t)("Crash Free Sessions"),[n.HEALTHY]:(0,r.t)("Healthy"),[n.ERRORED]:(0,r.t)("Errored"),[n.UNHANDLED]:(0,r.t)("Unhandled"),[n.ADOPTION]:(0,r.t)("Adoption"),duration:(0,r.t)("Session Duration"),otherCrashed:(0,r.t)("Other Crashed"),otherAbnormal:(0,r.t)("Other Abnormal"),otherErrored:(0,r.t)("Other Errored"),otherHealthy:(0,r.t)("Other Healthy"),otherCrashFreeUsers:(0,r.t)("Other Crash Free Users"),otherCrashFreeSessions:(0,r.t)("Other Crash Free Sessions"),otherReleases:(0,r.t)("Other Releases")},a={[n.CRASHES]:(0,r.t)("Number of sessions with a crashed state"),[n.CRASH_FREE]:(0,r.t)("Percentage of sessions/users who did not experience a crash."),[n.CRASH_FREE_USERS]:(0,r.t)("Percentage of unique users with non-crashed sessions"),[n.CRASH_FREE_SESSIONS]:(0,r.t)("Percentage of non-crashed sessions"),[n.STABILITY]:(0,r.t)("The percentage of crash free sessions."),[n.ADOPTION]:(0,r.t)("Adoption compares the sessions or users of a release with the total sessions or users for this project in the last 24 hours.")},i={[n.CRASHED]:(0,r.t)("The process was terminated due to an unhandled exception or a request to the server that ended with an error"),[n.CRASH_FREE_SESSIONS]:(0,r.t)("Percentage of non-crashed sessions"),[n.ABNORMAL]:(0,r.t)("An unknown session exit. Like due to loss of power or killed by the operating system"),[n.HEALTHY]:(0,r.t)("A session without errors"),[n.ERRORED]:(0,r.t)("A session with errors"),[n.UNHANDLED]:(0,r.t)("Not handled by user code")},l={crashed:(0,r.t)("The application crashed with a hard crash (eg. segfault)"),[n.ABNORMAL]:(0,r.t)("The application did not properly end the session, for example, due to force-quit"),[n.HEALTHY]:(0,r.t)("The application exited normally and did not observe any errors"),[n.ERRORED]:(0,r.t)("The application exited normally but observed error events while running"),[n.UNHANDLED]:(0,r.t)("The application crashed with a hard crash")};function d(e,t){return function(e){switch("react-native"===e||"java-spring"===e||"apple-ios"===e||"dotnet-aspnetcore"===e?e:e?.split("-")[0]){case"dotnet":case"java":return{...a,...i};case"java-spring":case"dotnet-aspnetcore":return{...a,...i,[n.CRASHES]:(0,r.t)("A request that resulted in an unhandled exception and hence a Server Error response")};case"android":case"cordova":case"react-native":case"flutter":return{...a,...i,[n.CRASHED]:(0,r.t)("An unhandled exception that resulted in the application crashing")};case"apple":return{...a,...i,[n.CRASHED]:(0,r.t)("An error that resulted in the application crashing")};case"node":case"javascript":return{...a,[n.CRASHED]:(0,r.t)("During the session an unhandled global error/promise rejection occurred."),[n.ABNORMAL]:(0,r.t)("Non applicable for Javascript."),[n.HEALTHY]:(0,r.t)("No errors were captured during session life-time."),[n.ERRORED]:(0,r.t)("During the session at least one handled error occurred."),[n.UNHANDLED]:"An error was captured by the global 'onerror' or 'onunhandledrejection' handler."};case"apple-ios":case"minidump":case"native":return{...a,...l};case"rust":return{...a,...l,[n.CRASHED]:(0,r.t)("The application had an unrecoverable error (a panic)")};default:return{...a,[n.CRASHED]:(0,r.t)("Number of users who experienced an unhandled error"),[n.ABNORMAL]:(0,r.t)("An unknown session exit"),[n.HEALTHY]:i.healthy,[n.ERRORED]:i.errored,[n.UNHANDLED]:i.unhandled}}}(t)[e]}}}]);
//# sourceMappingURL=../sourcemaps/app_components_charts_sessionsRequest_tsx.8a46b2527f94da3e1bac6177d82b1283.js.map