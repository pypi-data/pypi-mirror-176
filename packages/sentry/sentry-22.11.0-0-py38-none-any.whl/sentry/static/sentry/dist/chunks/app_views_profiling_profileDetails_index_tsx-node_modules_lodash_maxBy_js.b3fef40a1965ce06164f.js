(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_profiling_profileDetails_index_tsx-node_modules_lodash_maxBy_js","node_modules_lodash_maxBy_js"],{"./app/components/gridEditable/sortLink.tsx":(e,t,r)=>{"use strict";r.d(t,{Z:()=>g});var o=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=r("../node_modules/react-router/es/index.js"),s=r("../node_modules/lodash/omit.js"),a=r.n(s),i=r("./app/components/links/link.tsx"),l=r("./app/icons/index.tsx"),u=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function c(e){let{align:t,title:r,canSort:o,generateSortLink:s,onClick:a,direction:i,replace:l}=e;const c=s();if(!c||!o)return(0,u.tZ)(p,{align:t,children:r});const g=i?(0,u.tZ)(m,{size:"xs",direction:"desc"===i?"down":"up"}):null;return(0,u.BX)(d,{align:t,to:c,onClick:e=>{l&&(e.preventDefault(),n.browserHistory.replace(c)),a?.(e)},children:[r," ",g]})}c.displayName="SortLink";const d=(0,o.Z)((e=>{const t=a()(e,["align","css"]);return(0,u.tZ)(i.Z,{...t})}),{target:"e1xb2te62"})("display:block;width:100%;white-space:nowrap;color:inherit;&:hover,&:active,&:focus,&:visited{color:inherit;}",(e=>e.align?`text-align: ${e.align};`:""),";"),p=(0,o.Z)("div",{target:"e1xb2te61"})("display:block;width:100%;white-space:nowrap;",(e=>e.align?`text-align: ${e.align};`:""),";"),m=(0,o.Z)(l.CC,{target:"e1xb2te60"})({name:"40f4ru",styles:"vertical-align:top"}),g=c},"./app/components/searchBar.tsx":(e,t,r)=>{"use strict";r.d(t,{Z:()=>f});var o=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=r("../node_modules/react/index.js"),s=r("./app/components/button.tsx"),a=r("./app/components/inputGroup.tsx"),i=r("./app/icons/index.tsx"),l=r("./app/icons/iconClose.tsx"),u=r("./app/locale.tsx"),c=r("./app/styles/space.tsx"),d=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function p(e){let{query:t,defaultQuery:r="",onChange:o,onSearch:s,width:c,size:p,className:f,...y}=e;const b=(0,n.useRef)(null),[k,w]=(0,n.useState)(t??r);(0,n.useEffect)((()=>{"string"==typeof t&&w(t)}),[t]);const x=(0,n.useCallback)((e=>{const{value:t}=e.target;w(t),o?.(t)}),[o]),v=(0,n.useCallback)((e=>{e.preventDefault(),b.current?.blur(),s?.(k)}),[s,k]),C=(0,n.useCallback)((()=>{w(""),o?.(""),s?.("")}),[o,s]);return(0,d.tZ)(m,{onSubmit:v,className:f,children:(0,d.BX)(a.BZ,{children:[(0,d.tZ)(a.t_,{disablePointerEvents:!0,children:(0,d.tZ)(i.jV,{color:"subText",size:"xs"===p?"xs":"sm"})}),(0,d.tZ)(g,{...y,ref:b,type:"text",name:"query",autoComplete:"off",value:k,onChange:x,width:c,size:p}),(0,d.tZ)(a.Oj,{children:!!k&&(0,d.tZ)(h,{type:"button",size:"zero",borderless:!0,onClick:C,icon:(0,d.tZ)(l.b,{size:"xs"}),"aria-label":(0,u.t)("Clear")})})]})})}p.displayName="SearchBar";const m=(0,o.Z)("form",{target:"e4xnwji2"})({name:"4bgdod",styles:"display:block;position:relative"}),g=(0,o.Z)(a.II,{target:"e4xnwji1"})((e=>e.width&&`width: ${e.width};`),";"),h=(0,o.Z)(s.ZP,{target:"e4xnwji0"})("color:",(e=>e.theme.subText),";padding:",(0,c.Z)(.5),";"),f=p},"./app/utils/profiling/tableRenderer.tsx":(e,t,r)=>{"use strict";r.d(t,{w:()=>s});var o=r("./app/components/gridEditable/sortLink.tsx"),n=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function s(e){let{currentSort:t,generateSortLink:r,rightAlignedColumns:s,sortableColumns:a,onClick:i}=e;return(e,l)=>(0,n.tZ)(o.Z,{onClick:t=>i?.(e,t),align:s?.has(e.key)?"right":"left",title:e.name,direction:t?.key===e.key?t?.order:void 0,canSort:a?.has(e.key)||!1,generateSortLink:r?.(e.key)??(()=>{}),replace:!0})}},"./app/utils/profiling/units/units.ts":(e,t,r)=>{"use strict";r.d(t,{CD:()=>n,ab:()=>l,s4:()=>a}),r("../node_modules/core-js/modules/es.error.cause.js");const o={nanoseconds:1e-9,microseconds:1e-6,milliseconds:.001,seconds:1};function n(e,t,r){const n=Math.log10(o[t]),s=Math.log10(o[r]);return e*Math.pow(10,n-s)}const s=(e,t,r)=>e.toFixed(r)+t;function a(e){const t=o[e];if(void 0===t)throw new Error(`Cannot format unit ${e}, duration mapping is not defined`);return e=>{const r=e*t;return r>=1?s(r,"s",2):r/.001>=1?s(r/.001,"ms",2):r/1e-6>=1?s(r/1e-6,"Î¼s",2):s(r/1e-9,"ns",2)}}function i(e,t){return Math.floor(e).toString().padStart(t,"0")}function l(e){const t=o[e];if(void 0===t)throw new Error(`Cannot format unit ${e}, duration mapping is not defined`);return e=>{const r=e*t,o=1e3*r;return`${i(r/60,2)}:${i(r%60,2)}.${i(o%1e3,3)}`}}},"./app/views/profiling/profileDetails/index.tsx":(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>Q});var o=r("../node_modules/react/index.js"),n=r("./app/components/layouts/thirds.tsx"),s=r("./app/components/sentryDocumentTitle.tsx"),a=r("./app/locale.tsx"),i=r("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),l=r("./app/utils/useOrganization.tsx"),u=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),c=(r("../node_modules/core-js/modules/es.array.includes.js"),r("../node_modules/react-router/es/index.js")),d=r("../node_modules/lodash/debounce.js"),p=r.n(d),m=r("./app/components/compactSelect.tsx"),g=r("./app/components/gridEditable/index.tsx"),h=r("./app/components/pagination.tsx"),f=r("./app/components/searchBar.tsx"),y=r("./app/styles/space.tsx"),b=r("./app/utils/discover/styles.tsx"),k=r("./app/utils/profiling/routes.tsx"),w=r("./app/utils/profiling/tableRenderer.tsx"),x=r("./app/utils/profiling/units/units.ts"),v=r("./app/utils/useEffectAfterFirstRender.ts"),C=r("./app/utils/useLocation.tsx"),S=r("./app/utils/useParams.tsx"),Z=r("./app/views/profiling/profileGroupProvider.tsx"),j=r("../node_modules/lodash/groupBy.js"),_=r.n(j);function A(e){const t=[];return e.forEach((e=>{e.selfWeight>0&&t.push(e)}),(()=>{})),t.sort(((e,t)=>t.selfWeight-e.selfWeight)).map((t=>({symbol:t.frame.name,file:t.frame.file,image:t.frame.image,thread:e.threadId,type:t.frame.is_application?"application":"system","self weight":t.selfWeight,"total weight":t.totalWeight})))}function P(e,t){return e.reduce(((e,r)=>{const o=r[t];return o&&!e.includes(o)&&e.push(o),e}),[])}function z(e,t,r){const o=_()(e,(e=>function(e,t){return t.map((t=>e[t])).join($)}(e,t))),n=[];for(const e in o){const s=L(e,t),a=o[e];r.forEach((e=>{s[e.key]=e.compute(a)})),n.push(s)}return n}const $=String.fromCharCode(31);function L(e,t){const r=e.split($);return t.reduce(((e,t,o)=>(e[t]=r[o],e)),{})}var E=r("../node_modules/fuse.js/dist/fuse.esm.js"),q=r("../node_modules/query-string/index.js");function T(e){let{key:t,initialState:r}=e;const n=(0,C.T)(),[s,a]=(0,o.useState)(n.query[t]??r),i=(0,o.useCallback)((e=>{const r=c.browserHistory.getCurrentLocation();return{...r,query:{...r.query,[t]:e}}}),[t]),l=(0,o.useCallback)((e=>{c.browserHistory.replace(i(e)),a(e)}),[i]);return(0,o.useEffect)((()=>c.browserHistory.listenBefore((e=>{c.browserHistory.getCurrentLocation().pathname!==e.pathname&&t in e.query&&delete e.query[t]}))),[t]),[s,l,i]}var B=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function M(){const e=(0,C.T)(),[t]=(0,Z.useProfileGroup)(),[r,n]=T({key:"detailView",initialState:"occurrence"}),[s,i]=T({key:"query",initialState:""}),[l,u]=T({key:"cursor",initialState:""}),c=K[r]??K.occurrence,d=l?parseInt(l,10):0,y=(0,o.useMemo)((()=>{const e="resolved"===t.type?t.data.profiles.flatMap(A):[];return c.transform(e)}),[t,c]),{search:b}=function(e,t){const r=(0,o.useMemo)((()=>new E.default(e,t)),[e]);return{search:(0,o.useCallback)(((t,o)=>t?r.search(t,o).map((e=>e.item)):e),[r,e]),searchIndex:r}}(y,{keys:c.search.key,threshold:.3}),k=(0,o.useMemo)((()=>p()((e=>S(b(e))),500)),[b]),[x,S]=(0,o.useState)(y),[j,_]=T({key:"type"}),[z,$]=T({key:"image"}),{filters:L,columnFilters:M,filterPredicate:W}=function(e,t){const{columns:r}=t,[n,s]=(0,o.useState)((a=t.initialState)?Object.entries(a).reduce(((e,t)=>{let[r,o]=t;return e[r]=void 0,Array.isArray(o)&&(e[r]=o),"string"==typeof o&&(e[r]=[o]),e}),{}):{});var a;const i=(0,o.useMemo)((()=>{function t(e){return t=>{s((r=>({...r,[e]:t.length>0?t.map((e=>e.value)):void 0})))}}return r.reduce(((r,o)=>(r[o]={values:P(e,o).sort(((e,t)=>e.localeCompare(t))),onChange:t(o)},r)),{})}),[e,r]),l=(0,o.useRef)(!1);(0,o.useEffect)((()=>{l.current||0===e.length||(s((e=>Object.entries(e).reduce(((e,t)=>{const[r,o]=t,n=i[r].values,s=o?.filter((e=>n.includes(e)));return e[r]=Array.isArray(s)&&s.length>0?s:void 0,e}),{}))),l.current=!0)}),[e.length,i,n]);const u=(0,o.useCallback)((e=>{let t=!0;for(const r in n){const o=n[r];if(!o)continue;const s=e[r];if(t=o.includes(s),!t)return!1}return t}),[n]);return{filters:n,columnFilters:i,filterPredicate:u}}(y,{columns:["type","image"],initialState:{type:j,image:z}});(0,o.useEffect)((()=>{_(L.type),$(L.image)}),[L,_,$]);const{currentSort:H,generateSortLink:G,sortCompareFn:N}=function(e){const{sortableColumns:t,querystringKey:r,defaultSort:n}=e,[s,a,i]=T({key:r}),l=(0,o.useMemo)((()=>{let e=s??"";const r="-"===e[0];return r&&(e=e.slice(1)),e&&t.includes(e)?{key:e,order:r?"desc":"asc"}:n}),[t,n,s]),u=(0,o.useCallback)((e=>{if(!t.includes(e))return()=>{};if(!l)return()=>i(e);const r=l.key===e&&"desc"===l.order?"asc":"desc";return()=>i(`${"desc"===r?"-":""}${e}`)}),[l,t,i]),c=(0,o.useCallback)(((e,t)=>{const r=e[l.key],o=t[l.key];return r&&o?"number"==typeof r&&"number"==typeof o?"asc"===l.order?r-o:o-r:"string"==typeof r&&"string"==typeof o?"asc"===l.order?r.localeCompare(o):o.localeCompare(r):1:1}),[l]);return{currentSort:l,generateSortLink:u,sortCompareFn:c}}({...c.sort,querystringKey:"functionsSort"}),R=(0,o.useCallback)((e=>{i(e),u(void 0),k(e)}),[u,i,k]);(0,v.K)((()=>{S(b(s??""))}),[y,b]);const O=(0,o.useMemo)((()=>x.filter(W)),[W,x]),X=(0,o.useMemo)((()=>O.sort(N)),[O,N]),V=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const n=(0,C.T)();return(0,o.useMemo)((()=>{const o=t>=r?"true":"false",s=t>=r?t-r:0,a={...n.query,cursor:s},i=`<${n.pathname}${q.stringify(a)}>; rel="previous"; results="${o}"; cursor="${s}"`,l=t+r<e.length?"true":"false",u=t+r<e.length?t+r:0,c={...n.query,cursor:u};return`${i},<${n.pathname}${q.stringify(c)}>; rel="next"; results="${l}"; cursor="${u}"`}),[t,n,e,r])}(X,d),Q=X.slice(d,d+50);return(0,B.BX)(o.Fragment,{children:[(0,B.BX)(I,{children:[(0,B.tZ)(m.Z,{options:Object.values(K).map((e=>e.option)),value:c.option.value,triggerProps:{prefix:(0,a.t)("View")},placement:"bottom right",onChange:e=>{i(""),u(void 0),n(e.value)}}),(0,B.tZ)(f.Z,{defaultQuery:"",query:s,placeholder:c.search.placeholder,onChange:R}),(0,B.tZ)(m.Z,{options:M.type.values.map((e=>({value:e,label:e}))),value:L.type,triggerLabel:!L.type||Array.isArray(L.type)&&L.type.length===M.type.values.length?(0,a.t)("All"):void 0,triggerProps:{prefix:(0,a.t)("Type")},multiple:!0,onChange:M.type.onChange,placement:"bottom right"}),(0,B.tZ)(m.Z,{options:M.image.values.map((e=>({value:e,label:e}))),value:L.image,triggerLabel:!L.image||Array.isArray(L.image)&&L.image.length===M.image.values.length?(0,a.t)("All"):void 0,triggerProps:{prefix:(0,a.t)("Package")},multiple:!0,onChange:M.image.onChange,placement:"bottom right",isSearchable:!0})]}),(0,B.tZ)(g.ZP,{isLoading:"loading"===t.type,error:"errored"===t.type,data:Q,columnOrder:c.columns.map((e=>D[e])),columnSortBy:[H],scrollable:!0,stickyHeader:!0,height:"75vh",grid:{renderHeadCell:(0,w.w)({rightAlignedColumns:new Set(c.rightAlignedColumns),sortableColumns:new Set(c.rightAlignedColumns),currentSort:H,generateSortLink:G}),renderBodyCell:F},location:e}),(0,B.tZ)(h.Z,{pageLinks:V})]})}M.displayName="ProfileDetailsTable";const I=(0,u.Z)("div",{target:"ecfujpj0"})("display:grid;grid-template-columns:auto 1fr auto auto;gap:",(0,y.Z)(2),";margin-bottom:",(0,y.Z)(2),";");function F(e,t,r,o){return(0,B.tZ)(H,{column:e,dataRow:t,rowIndex:r,columnIndex:o})}F.displayName="renderFunctionCell";const W=(0,x.s4)("nanoseconds");function H(e){let{column:t,dataRow:r}=e;const o=r[t.key],{orgId:n,projectId:s,eventId:i}=(0,S.U)();switch(t.key){case"p75":case"p95":case"self weight":case"total weight":return(0,B.tZ)(b.Hw,{children:W(o)});case"count":return(0,B.tZ)(b.Hw,{children:o});case"image":return(0,B.tZ)(b.W2,{children:o??(0,a.t)("Unknown")});case"thread":return(0,B.tZ)(b.W2,{children:(0,B.tZ)(c.Link,{to:(0,k.TH)({orgSlug:n,projectSlug:s,profileId:i,query:{tid:r.thread}}),children:o})});case"symbol":return(0,B.tZ)(b.W2,{children:(0,B.tZ)(c.Link,{to:(0,k.TH)({orgSlug:n,projectSlug:s,profileId:i,query:{frameName:r.symbol,framePackage:r.image,tid:r.thread??r.tids?.[0]}}),children:o})});default:return(0,B.tZ)(b.W2,{children:o})}}const D={symbol:{key:"symbol",name:(0,a.t)("Symbol"),width:g.z7},image:{key:"image",name:(0,a.t)("Package"),width:g.z7},file:{key:"file",name:(0,a.t)("File"),width:g.z7},thread:{key:"thread",name:(0,a.t)("Thread"),width:g.z7},type:{key:"type",name:(0,a.t)("Type"),width:g.z7},"self weight":{key:"self weight",name:(0,a.t)("Self Weight"),width:g.z7},"total weight":{key:"total weight",name:(0,a.t)("Total Weight"),width:g.z7},p75:{key:"p75",name:(0,a.t)("P75(Self)"),width:g.z7},p95:{key:"p95",name:(0,a.t)("P95(Self)"),width:g.z7},count:{key:"count",name:(0,a.t)("Count"),width:g.z7}},G=(e,t)=>{const r=Array.from(e).sort(((e,t)=>e-t)),o=t*(r.length-1),n=Math.floor(o),s=o%1;return o===n?r[o]:r[n]*(1-s)+r[n+1]*s},N={key:"p75",compute:e=>G(e.map((e=>e["self weight"])),.75)},R={key:"p95",compute:e=>G(e.map((e=>e["self weight"])),.95)},O={key:"count",compute:e=>e.length},X={key:"tids",compute:e=>e.reduce(((e,t)=>{const r=t.thread;return e.includes(r)||e.push(r),e}),[])},K={occurrence:{option:{label:(0,a.t)("Slowest Functions"),value:"occurrence"},columns:["symbol","image","file","thread","type","self weight","total weight"],transform:e=>e.slice(0,500),search:{key:["symbol"],placeholder:(0,a.t)("Search for frames")},sort:{sortableColumns:["self weight","total weight"],defaultSort:{key:"self weight",order:"desc"}},rightAlignedColumns:["self weight","total weight"]},symbol:{option:{label:(0,a.t)("Group by Symbol"),value:"symbol"},columns:["symbol","type","image","p75","p95","count"],search:{key:["symbol"],placeholder:(0,a.t)("Search for frames")},transform:e=>z(e,["symbol","type","image"],[N,R,O,X]),sort:{sortableColumns:["p75","p95","count"],defaultSort:{key:"p75",order:"desc"}},rightAlignedColumns:["p75","p95","count"]},package:{option:{label:(0,a.t)("Group by Package"),value:"package"},columns:["image","type","p75","p95","count"],search:{key:["image"],placeholder:(0,a.t)("Search for packages")},transform:e=>z(e,["type","image"],[N,R,O]),sort:{sortableColumns:["p75","p95","count"],defaultSort:{key:"p75",order:"desc"}},rightAlignedColumns:["p75","p95","count"]},file:{option:{label:(0,a.t)("Group by File"),value:"file"},columns:["file","type","image","p75","p95","count"],search:{key:["file"],placeholder:(0,a.t)("Search for files")},transform:e=>z(e,["type","image","file"],[N,R,O]),sort:{sortableColumns:["p75","p95","count"],defaultSort:{key:"p75",order:"desc"}},rightAlignedColumns:["p75","p95","count"]}};function V(){const e=(0,l.Z)();return(0,o.useEffect)((()=>{(0,i.Z)("profiling_views.profile_summary",{organization:e})}),[e]),(0,B.tZ)(o.Fragment,{children:(0,B.tZ)(s.Z,{title:(0,a.t)("Profiling â Details"),orgSlug:e.slug,children:(0,B.tZ)(n.uT,{children:(0,B.tZ)(n.or,{fullWidth:!0,children:(0,B.tZ)(M,{})})})})})}V.displayName="ProfileDetails";const Q=V},"../node_modules/lodash/_baseExtremum.js":(e,t,r)=>{var o=r("../node_modules/lodash/isSymbol.js");e.exports=function(e,t,r){for(var n=-1,s=e.length;++n<s;){var a=e[n],i=t(a);if(null!=i&&(void 0===l?i==i&&!o(i):r(i,l)))var l=i,u=a}return u}},"../node_modules/lodash/_baseGt.js":e=>{e.exports=function(e,t){return e>t}},"../node_modules/lodash/maxBy.js":(e,t,r)=>{var o=r("../node_modules/lodash/_baseExtremum.js"),n=r("../node_modules/lodash/_baseGt.js"),s=r("../node_modules/lodash/_baseIteratee.js");e.exports=function(e,t){return e&&e.length?o(e,s(t,2),n):void 0}}}]);
//# sourceMappingURL=../sourcemaps/app_views_profiling_profileDetails_index_tsx-node_modules_lodash_maxBy_js.1d1fab6f29c34db76d0ce723e4686b7e.js.map