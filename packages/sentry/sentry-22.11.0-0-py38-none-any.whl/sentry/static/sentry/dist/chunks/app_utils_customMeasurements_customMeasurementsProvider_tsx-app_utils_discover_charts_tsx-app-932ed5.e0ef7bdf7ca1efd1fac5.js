"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_utils_customMeasurements_customMeasurementsProvider_tsx-app_utils_discover_charts_tsx-app-932ed5"],{"./app/utils/customMeasurements/customMeasurementsProvider.tsx":(e,t,n)=>{n.d(t,{L:()=>m}),n("../node_modules/core-js/modules/es.array.includes.js");var r=n("../node_modules/react/index.js"),s=n("./app/actionCreators/indicator.tsx"),i=n("./app/components/events/eventCustomPerformanceMetrics.tsx"),o=n("./app/components/organizations/pageFilters/parse.tsx"),a=n("./app/locale.tsx"),l=n("./app/utils/handleXhrErrorResponse.tsx"),u=n("./app/utils/useApi.tsx"),c=n("./app/utils/customMeasurements/customMeasurementsContext.tsx"),d=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function m(e){let{children:t,organization:n,selection:m}=e;const p=(0,u.Z)(),[g,h]=(0,r.useState)({customMeasurements:{}});return(0,r.useEffect)((()=>{let e=!1;return(n.features.includes("dashboards-mep")||n.features.includes("mep-rollout-flag"))&&function(e,t,n){const r=n?.datetime?{...(0,o.fK)(n.datetime)}:{};return n?.projects&&(r.project=n.projects.map(String)),e.requestPromise(`/organizations/${t.slug}/measurements-meta/`,{method:"GET",query:r})}(p,n,m).then((t=>{if(e)return;const n=Object.keys(t).reduce(((e,n)=>(e[n]={key:n,name:n,functions:t[n].functions,unit:t[n].unit,fieldType:(0,i.BB)(t[n].unit)},e)),{});h({customMeasurements:n})})).catch((t=>{if(e)return;const n=t?.responseJSON??(0,a.t)("Unable to fetch custom performance metrics");(0,s.Iw)(n),(0,l.Z)(n)(t)})),()=>{e=!0}}),[m,p,n]),(0,d.tZ)(c.z.Provider,{value:g,children:"function"==typeof t?t(g):t})}m.displayName="CustomMeasurementsProvider"},"./app/utils/discover/charts.tsx":(e,t,n)=>{n.d(t,{CX:()=>o,Xp:()=>d,gu:()=>l,x1:()=>u});var r=n("./app/locale.tsx"),s=n("./app/utils.tsx"),i=n("./app/utils/formatters.tsx");function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"number";return(0,s.ri)(e)?a(e,t):"—"}function a(e,t){if(!(0,s.ri)(e))return"—";switch(t){case"integer":case"number":return e.toLocaleString();case"percentage":return(0,i.rl)(e,2);case"duration":return(0,i.g9)(e/1e3,2,!0);case"size":return(0,s.F)(e);default:return e.toString()}}function l(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0;return u(e,t,n,r)}function u(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0;switch(t){case"integer":case"number":return n?(0,i.Du)(e):e.toLocaleString();case"percentage":return(0,i.rl)(e,0);case"duration":return c(e,r);case"size":return(0,s.F)(e,0);default:return e.toString()}}function c(e,t){if(t??=m(e),0===e)return"0";switch(t){case i.ps:{const t=(e/i.ps).toFixed(0);return(0,r.t)("%swk",t)}case i.x4:{const t=(e/i.x4).toFixed(0);return(0,r.t)("%sd",t)}case i.kr:{const t=(e/i.kr).toFixed(0);return(0,r.t)("%shr",t)}case i.EB:{const t=(e/i.EB).toFixed(0);return(0,r.t)("%smin",t)}case i.sh:{const t=(e/i.sh).toFixed(0);return(0,r.t)("%ss",t)}default:const t=e.toFixed(0);return(0,r.t)("%sms",t)}}function d(e,t){let n=0;const r=function(e,t){let n;if(e[0]?.data){let r,s=e[0];e.forEach(((n,i)=>{let{seriesName:o,data:a}=n;!1!==t?.selected?.[o]&&a.length&&(s=e[i],r??=e[i])})),r?.data&&(n={max:Math.max(...r.data.map((e=>{let{value:t}=e;return t})).filter((e=>!!e))),min:Math.min(...s.data.map((e=>{let{value:t}=e;return t})).filter((e=>!!e)))})}return n}(e,t);if(r){const e=(r.max+r.min)/2;n=m((r.max-r.min)/5),(e/n).toFixed(0).length>6&&(n=m(e))}return n}function m(e){return e>=i.ps?i.ps:e>=i.x4?i.x4:e>=i.kr?i.kr:e>=i.EB?i.EB:e>=i.sh?i.sh:1}},"./app/utils/performance/contexts/metricsEnhancedSetting.tsx":(e,t,n)=>{n.d(t,{Ar:()=>h,Eg:()=>x,gp:()=>v,kP:()=>y,nP:()=>m,nl:()=>p,oR:()=>g,tm:()=>f}),n("../node_modules/core-js/modules/es.array.includes.js");var r=n("../node_modules/react/index.js"),s=n("../node_modules/react-router/es/index.js"),i=(n("./app/utils/localStorage.tsx"),n("./app/utils/queryString.tsx")),o=n("./app/utils/useOrganization.tsx"),a=n("./app/utils/performance/contexts/utils.tsx"),l=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const[u,c,d]=(0,a.n)({name:"MetricsEnhancedSettingContext"}),m=d.Consumer;let p,g;!function(e){e.unset="unset",e.metrics="metrics",e.transactions="transactions"}(p||(p={})),function(e){e.auto="auto",e.metricsOnly="metricsOnly",e.transactionsOnly="transactionsOnly"}(g||(g={}));const h="metricSetting",f="metricSearchSetting";function v(e){const t=function(e){return e.features.includes("performance-use-metrics")}(e),n=e.features.includes("performance-transaction-name-only-search"),r=e.features.includes("server-side-sampling")&&e.features.includes("mep-rollout-flag");return t||n||r}const y=e=>{let{children:t,location:n,_hasMEPState:a,forceTransactions:c}=e;const d=v((0,o.Z)()),m=[g.metricsOnly,g.transactionsOnly],f=n?(0,i.ro)(n.query[h]):g.metricsOnly;let y=g.metricsOnly;c&&(y=g.transactionsOnly);const x=m.find((e=>e===f))??y,S=void 0!==a,[b,E]=(0,r.useReducer)(((e,t)=>t),x),w=(0,r.useCallback)((e=>{n&&(s.browserHistory.replace({...n,query:{...n.query,[h]:e}}),E(e))}),[n,E]),[C,R]=(0,r.useReducer)(((e,t)=>t),p.unset),P=S?a:b,Z=d&&P===g.auto,F=d&&P===g.metricsOnly,O=d&&P===g.transactionsOnly,N=`${P}`;return(0,l.tZ)(u,{value:{autoSampleState:C,metricSettingState:P,shouldQueryProvideMEPAutoParams:Z,shouldQueryProvideMEPMetricParams:F,shouldQueryProvideMEPTransactionParams:O,memoizationKey:N,setMetricSettingState:w,setAutoSampleState:R},children:t})};y.displayName="MEPSettingProvider";const x=c},"./app/utils/performance/urls.ts":(e,t,n)=>{n.d(t,{D:()=>i});var r=n("./app/components/events/interfaces/spans/utils.tsx"),s=n("./app/utils.tsx");function i(e,t,n,i,o){const a={...i||{},transaction:n};(0,s.ri)(a.transaction)||delete a.transaction;const l={pathname:`/organizations/${e}/performance/${t}/`,query:a,hash:(0,s.ri)(o)?(0,r.ct)(o):void 0};return(0,s.ri)(l.hash)||delete l.hash,l}},"./app/utils/userselect.tsx":(e,t,n)=>{n.d(t,{l:()=>r});const r=e=>{const t={userSelect:document.body.style.userSelect,MozUserSelect:document.body.style.MozUserSelect,msUserSelect:document.body.style.msUserSelect,webkitUserSelect:document.body.style.webkitUserSelect};return document.body.style.userSelect=e.userSelect||"",document.body.style.MozUserSelect=e.MozUserSelect||"",document.body.style.msUserSelect=e.msUserSelect||"",document.body.style.webkitUserSelect=e.webkitUserSelect||"",t}},"./app/views/eventsV2/table/columnEditCollection.tsx":(e,t,n)=>{n.d(t,{Z:()=>z});var r=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/react/index.js")),o=n("../node_modules/react-dom/profiling.js"),a=n("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),l=n("./app/components/arithmeticInput/parser.tsx"),u=n("./app/components/button.tsx"),c=n("./app/components/buttonBar.tsx"),d=n("./app/components/charts/styles.tsx"),m=n("./app/components/input.tsx"),p=n("./app/components/performance/waterfall/utils.tsx"),g=n("./app/icons/index.tsx"),h=n("./app/locale.tsx"),f=n("./app/styles/space.tsx"),v=n("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),y=n("./app/utils/discover/fields.tsx"),x=n("./app/utils/theme.tsx");function S(e,t){const n="nativeEvent"in e?e.nativeEvent:e;return window.TouchEvent&&n instanceof TouchEvent?n.targetTouches[0][t]:n instanceof MouseEvent?n[t]:0}var b=n("./app/utils/userselect.tsx"),E=n("./app/views/dashboardsV2/types.tsx"),w=n("./app/views/dashboardsV2/widgetBuilder/issueWidget/fields.tsx"),C=n("./app/views/dashboardsV2/widgetBuilder/releaseWidget/fields.tsx"),R=n("./app/views/eventsV2/table/queryField.tsx"),P=n("./app/views/eventsV2/table/types.tsx"),Z=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const F="draggable-item";var O;!function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM"}(O||(O={}));class N extends i.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{isDragging:!1,draggingIndex:void 0,draggingTargetIndex:void 0,draggingGrabbedOffset:void 0,error:new Map,left:void 0,top:void 0}),(0,r.Z)(this,"previousUserSelect",null),(0,r.Z)(this,"portal",null),(0,r.Z)(this,"dragGhostRef",(0,i.createRef)()),(0,r.Z)(this,"handleAddColumn",(()=>{this.props.onChange([...this.props.columns,{kind:"field",field:""}])})),(0,r.Z)(this,"handleAddEquation",(()=>{const{organization:e}=this.props,t={kind:P.L.EQUATION,field:""};(0,v.Z)("discover_v2.add_equation",{organization:e}),this.props.onChange([...this.props.columns,t])})),(0,r.Z)(this,"handleUpdateColumn",((e,t)=>{const n=[...this.props.columns];"equation"===t.kind?this.setState((n=>{const r=new Map(n.error);return r.set(e,(0,l.W9)(t.field).error),{...n,error:r}})):this.updateEquationFields(n,e,t),n.splice(e,1,t),this.props.onChange(n)})),(0,r.Z)(this,"updateEquationFields",((e,t,n)=>{const r=e[t],s=(0,y.sN)(e[t]),i=(0,y.sN)(n);if((0,y.el)(n)&&!(0,y.bv)(e,r))for(let t=0;t<e.length;t++){const n=e[t];if("equation"===n.kind){const o=(0,l.W9)(n.field);let a="",u=0;const c="function"===r.kind?o.tc.functions:o.tc.fields;for(const e of c)e.term===s&&u!==e.location.end.offset&&(a+=n.field.substring(u,e.location.start.offset)+i,u=e.location.end.offset);a+=n.field.substring(u),e[t]={kind:"equation",field:a,alias:e[t].alias}}}})),(0,r.Z)(this,"onDragMove",(e=>{const{isDragging:t,draggingTargetIndex:n,draggingGrabbedOffset:r}=this.state;if(!t||!["mousemove","touchmove"].includes(e.type))return;e.preventDefault(),e.stopPropagation();const s=S(e,"pageX"),i=S(e,"pageY"),o=r?.x??0,a=r?.y??0;if(this.dragGhostRef.current){const e=this.dragGhostRef.current;e.style.left=s-o+"px",e.style.top=i-a+"px"}const l=document.querySelectorAll(`.${F}`),u=Array.from(l).findIndex((e=>{const t=e.getBoundingClientRect(),n=i,r=window.scrollY+t.top,s=window.scrollY+t.top+t.height;return n>=r&&n<=s}));u>=0&&u!==n&&this.setState({draggingTargetIndex:u})})),(0,r.Z)(this,"isFixedIssueColumn",(e=>{const{source:t,columns:n}=this.props,r=n[e];return n.filter((e=>"field"===e.kind&&e.field===w.Sh.ISSUE)).length<=1&&t===E.l9.ISSUE&&"field"===r.kind&&r.field===w.Sh.ISSUE})),(0,r.Z)(this,"isRemainingReleaseHealthAggregate",(e=>{const{source:t,columns:n}=this.props,r=n[e];return n.filter((e=>e.kind===P.L.FUNCTION)).length<=1&&t===E.l9.RELEASE&&r.kind===P.L.FUNCTION})),(0,r.Z)(this,"onDragEnd",(e=>{if(!this.state.isDragging||!["mouseup","touchend"].includes(e.type))return;const t=this.state.draggingIndex,n=this.state.draggingTargetIndex;if("number"!=typeof t||"number"!=typeof n)return;this.cleanUpListeners(),this.previousUserSelect&&((0,b.l)(this.previousUserSelect),this.previousUserSelect=null);const r=[...this.props.columns],s=r.splice(t,1);r.splice(n,0,s[0]),this.checkColumnErrors(r),this.props.onChange(r),this.setState({isDragging:!1,left:void 0,top:void 0,draggingIndex:void 0,draggingTargetIndex:void 0,draggingGrabbedOffset:void 0})}))}componentDidMount(){if(!this.portal){const e=document.createElement("div");e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.zIndex=String(x.ZP.zIndex.modal),this.portal=e,document.body.appendChild(this.portal)}this.checkColumnErrors(this.props.columns)}componentWillUnmount(){this.portal&&document.body.removeChild(this.portal),this.cleanUpListeners()}checkColumnErrors(e){const t=new Map;for(let n=0;n<e.length;n+=1){const r=e[n];if("equation"===r.kind){const e=(0,l.W9)(r.field);e.error&&t.set(n,e.error)}}this.setState({error:t})}keyForColumn(e,t){return"function"===e.kind?[...e.function,t].join(":"):[...e.field,t].join(":")}cleanUpListeners(){this.state.isDragging&&(window.removeEventListener("mousemove",this.onDragMove),window.removeEventListener("touchmove",this.onDragMove),window.removeEventListener("mouseup",this.onDragEnd),window.removeEventListener("touchend",this.onDragEnd))}removeColumn(e){const t=[...this.props.columns];t.splice(e,1),this.checkColumnErrors(t),this.props.onChange(t)}startDrag(e,t){if(this.state.isDragging||!["mousedown","touchstart"].includes(e.type))return;e.preventDefault(),e.stopPropagation();const n=S(e,"pageY"),r=S(e,"pageX"),s=Array.from(document.querySelectorAll(`.${F}`)).find((t=>t.contains(e.currentTarget))),{x:i,y:o}=(0,p.R3)(s),a={x:r-i+4,y:n-o+4};this.previousUserSelect=(0,b.l)({userSelect:"none",MozUserSelect:"none",msUserSelect:"none",webkitUserSelect:"none"}),window.addEventListener("mousemove",this.onDragMove),window.addEventListener("touchmove",this.onDragMove),window.addEventListener("mouseup",this.onDragEnd),window.addEventListener("touchend",this.onDragEnd),this.setState({isDragging:!0,draggingIndex:t,draggingTargetIndex:t,draggingGrabbedOffset:a,top:n,left:r})}renderGhost(e){let{gridColumns:t,singleColumn:n}=e;const{isDragging:r,draggingIndex:s,draggingGrabbedOffset:i}=this.state,a=s;if("number"!=typeof a||!r||!this.portal)return null;const l=i?.x??0,u=i?.y??0,c=Number(this.state.top)-u,d=Number(this.state.left)-l,m=this.props.columns[a],p={top:`${c}px`,left:`${d}px`},g=(0,Z.tZ)(T,{ref:this.dragGhostRef,style:p,children:this.renderItem(m,a,{singleColumn:n,isGhost:!0,gridColumns:t})});return(0,o.createPortal)(g,this.portal)}renderItem(e,t,n){let{singleColumn:r=!1,canDelete:s=!0,canDrag:o=!0,isGhost:a=!1,gridColumns:l=2,disabled:u=!1}=n;const{columns:c,fieldOptions:d,filterAggregateParameters:m,filterPrimaryOptions:p,noFieldsMessage:f,showAliasField:v}=this.props,{isDragging:y,draggingTargetIndex:x,draggingIndex:S}=this.state;let b=null;if(y&&!1===a&&x===t&&(b=(0,Z.tZ)(_,{className:F},`placeholder:${this.keyForColumn(e,a)}`)),y&&!1===a&&S===t)return b;const E=Number(x)<=Number(S)?O.TOP:O.BOTTOM;return(0,Z.BX)(i.Fragment,{children:[E===O.TOP&&b,(0,Z.BX)(D,{showAliasField:v,singleColumn:r,className:a?"":F,children:[o?(0,Z.tZ)(U,{"aria-label":(0,h.t)("Drag to reorder"),onMouseDown:e=>this.startDrag(e,t),onTouchStart:e=>this.startDrag(e,t),icon:(0,Z.tZ)(g.LS,{size:"xs"}),size:"zero",borderless:!0}):r&&v?null:(0,Z.tZ)("span",{}),(0,Z.tZ)(R.q,{fieldOptions:d,gridColumns:l,fieldValue:e,onChange:e=>this.handleUpdateColumn(t,e),error:this.state.error.get(t),takeFocus:t===this.props.columns.length-1,otherColumns:c,shouldRenderTag:!0,disabled:u,filterPrimaryOptions:p,filterAggregateParameters:m,noFieldsMessage:f,skipParameterPlaceholder:v}),v&&(0,Z.tZ)(k,{singleColumn:r,children:(0,Z.tZ)(j,{name:"alias",placeholder:(0,h.t)("Alias"),value:e.alias??"",onChange:n=>{this.handleUpdateColumn(t,{...e,alias:n.target.value})}})}),s||"equation"===e.kind?v?(0,Z.tZ)(q,{"data-test-id":`remove-column-${t}`,"aria-label":(0,h.t)("Remove column"),title:(0,h.t)("Remove column"),onClick:()=>this.removeColumn(t),icon:(0,Z.tZ)(g.Fz,{}),borderless:!0}):(0,Z.tZ)(q,{"data-test-id":`remove-column-${t}`,"aria-label":(0,h.t)("Remove column"),onClick:()=>this.removeColumn(t),icon:(0,Z.tZ)(g.Fz,{}),borderless:!0}):r&&v?null:(0,Z.tZ)("span",{})]}),E===O.BOTTOM&&b]},`${t}:${this.keyForColumn(e,a)}`)}render(){const{className:e,columns:t,showAliasField:n,source:r}=this.props,s=t.filter((e=>"equation"!==e.kind)).length>1,i=t.length>1,o=t.length<20,a=o?void 0:(0,h.t)("Sorry, you've reached the maximum number of columns (%d). Delete columns to add more.",20),l=1===t.length,c=r===E.l9.ISSUE?1:Math.max(...t.map((e=>"function"!==e.kind?2:2===(y.lx[e.function[0]]??C.Am[e.function[0]]).parameters.length?3:2)));return(0,Z.BX)("div",{className:e,children:[this.renderGhost({gridColumns:c,singleColumn:l}),!n&&r!==E.l9.ISSUE&&(0,Z.tZ)(D,{showAliasField:n,singleColumn:l,children:(0,Z.BX)(I,{gridColumns:c,children:[(0,Z.tZ)(M,{children:(0,h.t)("Tag / Field / Function")}),(0,Z.tZ)(M,{children:(0,h.t)("Field Parameter")})]})}),t.map(((e,t)=>this.isFixedIssueColumn(t)?this.renderItem(e,t,{singleColumn:l,canDelete:!1,canDrag:i,gridColumns:c,disabled:!0}):this.isRemainingReleaseHealthAggregate(t)?this.renderItem(e,t,{singleColumn:l,canDelete:!1,canDrag:i,gridColumns:c}):this.renderItem(e,t,{singleColumn:l,canDelete:s,canDrag:i,gridColumns:c}))),(0,Z.tZ)(D,{showAliasField:n,singleColumn:l,children:(0,Z.BX)(A,{gap:1,showAliasField:n,children:[(0,Z.tZ)(u.ZP,{size:"sm","aria-label":(0,h.t)("Add a Column"),onClick:this.handleAddColumn,title:a,disabled:!o,icon:(0,Z.tZ)(g.N_,{isCircled:!0,size:"xs"}),children:(0,h.t)("Add a Column")}),r!==E.l9.ISSUE&&r!==E.l9.RELEASE&&(0,Z.tZ)(u.ZP,{size:"sm","aria-label":(0,h.t)("Add an Equation"),onClick:this.handleAddEquation,title:a,disabled:!o,icon:(0,Z.tZ)(g.N_,{isCircled:!0,size:"xs"}),children:(0,h.t)("Add an Equation")})]})})]})}}N.displayName="ColumnEditCollection";const A=(0,s.Z)(c.ZP,{target:"ev0fm799"})("grid-column:",(e=>e.showAliasField?"1/-1":" 2/3"),";justify-content:flex-start;"),D=(0,s.Z)("div",{target:"ev0fm798"})("display:grid;grid-template-columns:",(0,f.Z)(3)," 1fr 40px;justify-content:center;align-items:center;width:100%;touch-action:none;padding-bottom:",(0,f.Z)(1),";",(e=>e.showAliasField&&(0,a.iv)("align-items:flex-start;grid-template-columns:",e.singleColumn?"1fr":`${(0,f.Z)(3)} 1fr 40px`,";@media (min-width: ",e.theme.breakpoints.small,"){grid-template-columns:",e.singleColumn?`1fr calc(200px + ${(0,f.Z)(1)})`:`${(0,f.Z)(3)} 1fr calc(200px + ${(0,f.Z)(1)}) 40px`,";}","")),";"),T=(0,s.Z)("div",{target:"ev0fm797"})("background:",(e=>e.theme.background),";display:block;position:absolute;padding:",4,"px;border-radius:",(e=>e.theme.borderRadius),";box-shadow:0 0 15px rgba(0, 0, 0, 0.15);width:710px;opacity:0.8;cursor:grabbing;padding-right:",(0,f.Z)(2),";&>",D,"{padding-bottom:0;}& svg{cursor:grabbing;}"),_=(0,s.Z)("div",{target:"ev0fm796"})("margin:0 ",(0,f.Z)(3)," ",(0,f.Z)(1)," ",(0,f.Z)(3),";border:2px dashed ",(e=>e.theme.border),";border-radius:",(e=>e.theme.borderRadius),";height:",(e=>e.theme.form.md.height),"px;"),I=(0,s.Z)("div",{target:"ev0fm795"})("grid-column:2/3;display:grid;grid-template-columns:repeat(",(e=>e.gridColumns),", 1fr);grid-column-gap:",(0,f.Z)(1),";"),M=(0,s.Z)(d.OT,{target:"ev0fm794"})({name:"ti75j2",styles:"margin:0"}),j=(0,s.Z)(m.Z,{target:"ev0fm793"})({name:"jixqcp",styles:"min-width:50px"}),k=(0,s.Z)("div",{target:"ev0fm792"})("margin-top:",(0,f.Z)(1),";@media (min-width: ",(e=>e.theme.breakpoints.small),"){margin-top:0;margin-left:",(0,f.Z)(1),";}@media (max-width: ",(e=>e.theme.breakpoints.small),"){grid-row:2/2;grid-column:",(e=>e.singleColumn?"1/-1":"2/2"),";}"),q=(0,s.Z)(u.ZP,{target:"ev0fm791"})("margin-left:",(0,f.Z)(1),";height:",(e=>e.theme.form.md.height),"px;"),U=(0,s.Z)(u.ZP,{target:"ev0fm790"})("height:",(e=>e.theme.form.md.height),"px;"),z=N},"./app/views/performance/transactionSummary/utils.tsx":(e,t,n)=>{n.d(t,{K0:()=>c,MF:()=>f,PU:()=>m,Z6:()=>g,e1:()=>p,uI:()=>v,vd:()=>h,xf:()=>d});var r=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=n("./app/styles/space.tsx"),i=n("./app/utils/discover/urls.tsx"),o=n("./app/utils/getRouteStringFromRoutes.tsx"),a=n("./app/utils/performance/urls.ts"),l=n("./app/utils/tokenizeSearch.tsx"),u=n("./app/views/performance/traceDetails/utils.tsx");let c;function d(e){const t=m(e);return t.removeFilter("transaction"),t}function m(e){const t=new l.MY(e);return t.removeFilter("event.type"),t}function p(e){let{orgSlug:t,transaction:n,projectID:r,query:s,unselectedSeries:i="p100()",display:o,trendFunction:a,trendColumn:l,showTransactions:u,additionalQuery:c}=e;const m=function(e){let{orgSlug:t}=e;return`/organizations/${t}/performance/summary/`}({orgSlug:t});let p;return p="string"==typeof s.query?d(s.query).formatString():s.query,{pathname:m,query:{transaction:n,project:r,environment:s.environment,statsPeriod:s.statsPeriod,start:s.start,end:s.end,query:p,unselectedSeries:i,showTransactions:u,display:o,trendFunction:a,trendColumn:l,referrer:"performance-transaction-summary",...c}}}function g(e){return(t,n,r)=>{const s=`${n.trace}`;return s?(0,u.YA)(t,s,e,{}):{}}}function h(e){return(t,n,r,s)=>{const o=(0,i.JE)(n);return(0,a.D)(t.slug,o,e,r,s)}}function f(e){return(t,n,r)=>{const s=n.replayId;if(!s)return{};const i=`${n["project.name"]}:${s}`,a=(0,o.Z)(e);if(!n.timestamp)return{pathname:`/organizations/${t.slug}/replays/${i}/`,query:{referrer:a}};const l=new Date(n.timestamp).getTime()-n["transaction.duration"];return{pathname:`/organizations/${t.slug}/replays/${i}/`,query:{event_t:l,referrer:a}}}}!function(e){e.FASTEST="fastest",e.SLOW="slow",e.OUTLIER="outlier",e.RECENT="recent"}(c||(c={}));const v=(0,r.Z)("div",{target:"e1radvp0"})("margin-top:",(0,s.Z)(3),";")},"./app/views/performance/trends/types.tsx":(e,t,n)=>{let r,s,i;n.d(t,{A2:()=>i,ER:()=>r,Z2:()=>s}),function(e){e.IMPROVED="improved",e.REGRESSION="regression"}(r||(r={})),function(e){e.P50="p50",e.P75="p75",e.P95="p95",e.P99="p99",e.AVG="avg"}(s||(s={})),function(e){e.DURATION="transaction.duration",e.LCP="measurements.lcp",e.FCP="measurements.fcp",e.FID="measurements.fid",e.CLS="measurements.cls",e.SPANS_DB="spans.db",e.SPANS_HTTP="spans.http",e.SPANS_BROWSER="spans.browser",e.SPANS_RESOURCE="spans.resource"}(i||(i={}))},"./app/views/performance/trends/utils.tsx":(e,t,n)=>{n.d(t,{CE:()=>w,HF:()=>I,IO:()=>C,Kt:()=>P,P4:()=>T,RP:()=>A,T1:()=>f,Ws:()=>E,_1:()=>g,_H:()=>Z,bg:()=>h,cs:()=>v,ed:()=>R,es:()=>y,iF:()=>O,j_:()=>D,kM:()=>F,vq:()=>M,vt:()=>b,wx:()=>N}),n("../node_modules/core-js/modules/es.array.includes.js");var r=n("../node_modules/downsample/methods/ASAP.js"),s=n("../node_modules/moment/moment.js"),i=n.n(s),o=n("./app/components/charts/utils.tsx"),a=n("./app/locale.tsx"),l=n("./app/utils/discover/fields.tsx"),u=n("./app/utils/queryString.tsx"),c=n("./app/utils/theme.tsx"),d=n("./app/utils/tokenizeSearch.tsx"),m=n("./app/views/performance/utils.tsx"),p=n("./app/views/performance/trends/types.tsx");const g="14d",h="15min",f=[{label:"p50",field:p.Z2.P50,alias:"percentile_range",legendLabel:"p50"},{label:"p75",field:p.Z2.P75,alias:"percentile_range",legendLabel:"p75"},{label:"p95",field:p.Z2.P95,alias:"percentile_range",legendLabel:"p95"},{label:"p99",field:p.Z2.P99,alias:"percentile_range",legendLabel:"p99"},{label:"average",field:p.Z2.AVG,alias:"avg_range",legendLabel:"average"}],v=[{label:"Duration",column:p.A2.DURATION},{label:"LCP",column:p.A2.LCP},{label:"FCP",column:p.A2.FCP},{label:"FID",column:p.A2.FID},{label:"CLS",column:p.A2.CLS},{label:"Spans (http)",column:p.A2.SPANS_HTTP},{label:"Spans (db)",column:p.A2.SPANS_DB},{label:"Spans (browser)",column:p.A2.SPANS_BROWSER},{label:"Spans (resource)",column:p.A2.SPANS_RESOURCE}],y={[p.ER.IMPROVED]:{lighter:c.ZP.green200,default:c.ZP.green300},[p.ER.REGRESSION]:{lighter:c.ZP.red200,default:c.ZP.red300}},x={[p.ER.IMPROVED]:"improvedSelected",[p.ER.REGRESSION]:"regressionSelected"},S={[p.ER.IMPROVED]:"improvedUnselectedSeries",[p.ER.REGRESSION]:"regressionUnselectedSeries"},b={[p.ER.IMPROVED]:"improvedCursor",[p.ER.REGRESSION]:"regressionCursor"};function E(){const e={};return Object.values(b).forEach((t=>e[t]=void 0)),e}function w(e,t){const n=t??(0,u.ro)(e?.query?.trendFunction);return f.find((e=>{let{field:t}=e;return t===n}))||f[0]}function C(e,t,n){const r=(0,u.ro)(e?.query?.trendParameter),s=v.find((e=>{let{label:t}=e;return t===r}));return s||function(e,t){return function(e){switch(e){case m.iy.FRONTEND:return{label:"LCP",column:p.A2.LCP};case m.iy.ANY:case m.iy.BACKEND:case m.iy.FRONTEND_OTHER:default:return{label:"Duration",column:p.A2.DURATION}}}((0,m.Bh)(e,t))}(t,n)}function R(e,t){return(0,l.sN)({kind:"function",function:[e,t,void 0,void 0]})}function P(e,t){return{fromSeconds:e/1e3,toSeconds:t/1e3,showDigits:e>1e3||t>1e3||e<10||t<10}}function Z(e,t){if(e.project&&t)return t.find((t=>t.slug===e.project))?.id}function F(e,t,n,r,s){const i=w(t),a=C(t,r,e.project),l=[...s?[]:["transaction"],"project"].map((e=>({field:e}))),c={field:"trend_percentage()",kind:"asc"};e.trendType=n,n===p.ER.REGRESSION&&(c.kind="desc"),i&&a&&(e.trendFunction=R(i.field,a.column)),e.query=function(e){const t=new d.MY(e);return t.hasFilter("count_percentage()")||t.addFilterValues("count_percentage()",[">0.25","<4"]),t.hasFilter("trend_percentage()")||t.addFilterValues("trend_percentage()",[">0%"]),t.hasFilter("confidence()")||t.addFilterValues("confidence()",[">6"]),t.formatString()}(e.query),e.interval=function(e,t){const n=(0,u.ro)(e?.query?.interval),{start:r,end:s,statsPeriod:i}=t,a={start:r||null,end:s||null,period:i},l=(0,o.ZS)(a,"high");return n||l}(t,e),e.sorts=[c],e.fields=l}function O(e,t){const{query:n}=t,r=n.start&&n.end;return n.statsPeriod||r||(e.statsPeriod=g),e}function N(e,t){const n=Math.abs(e);return{seconds:n/1e3,fixedDigits:n>1e3||n<10?1:0,changeLabel:t===p.ER.REGRESSION?(0,a.t)("slower"):(0,a.t)("faster")}}function A(e){const t=i()();return e.map((e=>({...e,received_at:t,transaction:e.transaction})))}function D(e){return x[e]}function T(e){return S[e]}const _=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return(0,r.Cl)(e,t)},I=e=>["p50","p75"].find((t=>e.includes(t)));function M(e,t){let n=Number.MAX_SAFE_INTEGER,r=0;if(!e)return{maxValue:r,minValue:n,smoothedResults:void 0};const s=[];for(const i of e){const e=i.data,o=[],a=_(e.map((e=>{let{name:t,value:n}=e;return[Number(t),n]})));for(let e=0;e<a.length;e++){const t=a[e],s=t.y;if(o.push({name:t.x,value:s}),!isNaN(s)){const e=Math.round(s);n=Math.min(e,n),r=Math.max(e,r)}}s.push({seriesName:t||i.seriesName||"Current",data:o,lineStyle:i.lineStyle,color:i.color})}return{minValue:n,maxValue:r,smoothedResults:s}}},"./app/views/performance/utils.tsx":(e,t,n)=>{n.d(t,{Bh:()=>C,C$:()=>R,Ik:()=>P,JY:()=>I,Ov:()=>N,Pv:()=>y,R8:()=>A,U7:()=>f,Ws:()=>O,YL:()=>M,al:()=>D,bY:()=>k,de:()=>F,iL:()=>Z,iy:()=>x,m_:()=>T,n4:()=>_,og:()=>v,p9:()=>q,rL:()=>j,uq:()=>S}),n("../node_modules/core-js/modules/es.array.includes.js");var r=n("../node_modules/react-router/es/index.js"),s=n("./app/constants/pageFilters.tsx"),i=n("./app/data/platformCategories.tsx"),o=n("./app/locale.tsx"),a=n("./app/utils/analytics.tsx"),l=n("./app/utils/dates.tsx"),u=n("./app/utils/discover/eventView.tsx"),c=n("./app/utils/discover/fields.tsx"),d=n("./app/utils/formatters.tsx"),m=n("./app/utils/getCurrentSentryReactTransaction.tsx"),p=n("./app/utils/queryString.tsx"),g=n("./app/utils/tokenizeSearch.tsx"),h=n("./app/views/performance/trends/utils.tsx");const f=["environment","project","query","start","end","statsPeriod"],v="<< unparameterized >>";let y,x;function S(e){const t=e.source===y.DISCOVER?["transaction","project","transaction.source","epm()"]:["transaction","project","transaction.source","epm()","p50()","p95()"],n={id:void 0,name:e.source===y.DISCOVER?(0,o.t)("Unparameterized Transactions"):(0,o.t)("Performance - Unparameterized Transactions"),query:'event.type:transaction transaction.source:"url"',projects:[],fields:t,version:2},r=u.ZP.fromNewQueryWithLocation(n,e.location).withSorts([{field:"epm",kind:"desc"}]).getResultsViewUrlTarget(e.organization.slug);return r.query.showUnparameterizedBanner="true",r}!function(e){e.PERFORMANCE="performance",e.DISCOVER="discover"}(y||(y={})),function(e){e.ANY="any",e.FRONTEND="frontend",e.BACKEND="backend",e.FRONTEND_OTHER="frontend_other",e.MOBILE="mobile"}(x||(x={}));const b=[...i.tQ],E=i.y3.filter((e=>"native"!==e)),w=[...i.ai];function C(e,t){if(0===t.length||t[0]===s.mP)return x.ANY;const n=e.filter((e=>t.includes(parseInt(`${e.id}`,10))));return 0===n.length||n.some((e=>!e.platform))?x.ANY:n.every((e=>b.includes(e.platform)))?x.FRONTEND:n.every((e=>E.includes(e.platform)))?x.BACKEND:n.every((e=>w.includes(e.platform)))?x.MOBILE:x.ANY}function R(e,t){const n=C(e,t.project);return n===x.FRONTEND&&new g.MY(t.query).getFilterValues("!transaction.op").some((e=>"pageload"===e))?x.FRONTEND_OTHER:n}function P(e,t){return R(t,e)===x.FRONTEND}function Z(e,t){return R(t,e)===x.FRONTEND||R(t,e)===x.FRONTEND_OTHER}function F(e){return`/organizations/${e.slug}/performance/`}function O(e){return`/organizations/${e.slug}/performance/trends/`}function N(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,p.ro)(e.query.query,t).trim()}function A(e){let{location:t,organization:n,projectPlatforms:s}=e;(0,a.ec)({eventKey:"performance_views.change_view",eventName:"Performance Views: Change View",organization_id:parseInt(n.id,10),view_name:"TRENDS",project_platforms:s});const i=D({location:t,organization:n});r.browserHistory.push(i)}function D(e){let{location:t,organization:n,initialConditions:r,additionalQuery:s}=e;const i={...t.query,...s},o=(0,p.ro)(t.query.query,""),a=new g.MY(o),l=r??new g.MY([]);return a.hasFilter("tpm()")?l.setFilterValues("tpm()",a.getFilterValues("tpm()")):l.setFilterValues("tpm()",[">0.01"]),a.hasFilter("transaction.duration")?l.setFilterValues("transaction.duration",a.getFilterValues("transaction.duration")):l.setFilterValues("transaction.duration",[">0",`<${h.bg}`]),i.query=l.formatString(),{pathname:O(n),query:{...i}}}function T(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{excludeTagKeys:new Set(["event.type","project"])};return e.getFilterKeys().forEach((n=>{const r=n.startsWith("!")?n.substr(1):n;(r.match(/\w+\(.*\)/)||c.J8.includes(r)||t.excludeTagKeys.has(r))&&e.removeFilter(n)})),e}function _(e){const t=(0,m.Z)(),n=(0,l.Ri)(e.datetime.period,e.datetime.start,e.datetime.end),r=Math.floor(86400*n);t?.setTag("query.period",r.toString());let s=">30d";r<=86400?s="<=1d":r<=604800?s="<=7d":r<=1209600?s="<=14d":r<=2592e3&&(s="<=30d"),t?.setTag("query.period.grouped",s)}function I(e){const{transaction:t}=e.query;return(0,p.ro)(t)}function M(e){return(0,d.g9)(e/1e3,e>1e3?2:0,!0)}function j(e){return!e.project.length||1===e.project.length&&e.project[0]===s.mP}function k(e,t){const n=e.query.project,r=Array.isArray(n)?new Set(n):new Set([n]);return t.reduce(((e,t)=>(r.has(t.id)&&e.push(t.platform??"undefined"),e)),[])}function q(e,t){return k(e,t).join(", ")}}}]);
//# sourceMappingURL=../sourcemaps/app_utils_customMeasurements_customMeasurementsProvider_tsx-app_utils_discover_charts_tsx-app-932ed5.2c5d9e7a76b43116817e96d8a388a284.js.map