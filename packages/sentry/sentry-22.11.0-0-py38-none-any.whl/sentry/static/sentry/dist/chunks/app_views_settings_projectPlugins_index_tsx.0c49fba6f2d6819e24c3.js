"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_projectPlugins_index_tsx"],{"./app/actionCreators/plugins.tsx":(t,e,s)=>{s.d(e,{Cg:()=>g,MM:()=>c,rR:()=>d}),s("../node_modules/core-js/modules/es.error.cause.js");var n=s("./app/actionCreators/indicator.tsx"),i=s("./app/api.tsx"),r=s("./app/locale.tsx"),o=s("./app/stores/pluginsStore.tsx");const a={},l=new i.KU;function p(t){let{orgId:e,projectId:s,pluginId:n,update:i,...r}=t;o.Z.onUpdate(n,i);const a=l.requestPromise(`/projects/${e}/${s}/plugins/${n}/`,{...r});return a.then((()=>{o.Z.onUpdateSuccess(n,i)})).catch((t=>{const e=t&&t.responseJSON&&"string"==typeof t.responseJSON.detail?new Error(t.responseJSON.detail):new Error("Unable to update plugin");o.Z.onUpdateError(n,i,e)})),a}function c(t,e){let{orgId:s,projectId:n}=t;const i=`/projects/${s}/${n}/plugins/`;if(a[i])return a[i];o.Z.onFetchAll(e);const r=l.requestPromise(i,{method:"GET",includeAllArgs:!0});return a[i]=r,r.then((t=>{let[e,s,n]=t;return o.Z.onFetchAllSuccess(e,{pageLinks:n?.getResponseHeader("Link")??void 0}),e})).catch((t=>{throw o.Z.onFetchAllError(t),new Error("Unable to fetch plugins")})).then((()=>a[i]=null)),r}function g(t){return(0,n.E3)((0,r.t)("Enabling...")),p({...t,update:{enabled:!0},method:"POST"}).then((()=>(0,n.S9)((0,r.t)("Plugin was enabled")))).catch((()=>(0,n.Iw)((0,r.t)("Unable to enable plugin"))))}function d(t){return(0,n.E3)((0,r.t)("Disabling...")),p({...t,update:{enabled:!1},method:"DELETE"}).then((()=>(0,n.S9)((0,r.t)("Plugin was disabled")))).catch((()=>(0,n.Iw)((0,r.t)("Unable to disable plugin"))))}},"./app/stores/pluginsStore.tsx":(t,e,s)=>{s.d(e,{Z:()=>o});var n=s("../node_modules/reflux/src/index.js");const i={loading:!0,plugins:[],error:null,pageLinks:null},r={plugins:null,state:{...i},updating:new Map,reset(){return this.plugins=null,this.state={...i},this.updating=new Map,this.state},getInitialState(){return this.getState()},getState(){const{plugins:t,...e}=this.state;return{...e,plugins:this.plugins?Array.from(this.plugins.values()):[]}},init(){this.reset()},triggerState(){this.trigger(this.getState())},onFetchAll(){let{resetLoading:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t&&(this.state.loading=!0,this.state.error=null,this.plugins=null),this.triggerState()},onFetchAllSuccess(t,e){let{pageLinks:s}=e;this.plugins=new Map(t.map((t=>[t.id,t]))),this.state.pageLinks=s||null,this.state.loading=!1,this.triggerState()},onFetchAllError(t){this.plugins=null,this.state.loading=!1,this.state.error=t,this.triggerState()},onUpdate(t,e){if(!this.plugins)return;const s=this.plugins.get(t);if(!s)return;const n={...s,...e};this.plugins.set(t,n),this.updating.set(t,s),this.triggerState()},onUpdateSuccess(t,e){this.updating.delete(t)},onUpdateError(t,e,s){const n=this.updating.get(t);n&&this.plugins&&(this.plugins.set(t,n),this.updating.delete(t),this.state.error=s,this.triggerState())}},o=(0,n.createStore)(r)},"./app/utils/withPlugins.tsx":(t,e,s)=>{s.d(e,{Z:()=>d});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=s("../node_modules/react/index.js"),r=s("./app/actionCreators/plugins.tsx"),o=s("./app/stores/pluginsStore.tsx"),a=s("./app/utils.tsx"),l=s("./app/utils/getDisplayName.tsx"),p=s("./app/utils/withOrganization.tsx"),c=s("./app/utils/withProject.tsx"),g=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const d=function(t){class e extends i.Component{constructor(){super(...arguments),(0,n.Z)(this,"state",{plugins:[],loading:!0}),(0,n.Z)(this,"unsubscribe",o.Z.listen((t=>{let{plugins:e,loading:s}=t;this.setState({plugins:e,loading:s})}),void 0))}componentDidMount(){this.fetchPlugins()}componentDidUpdate(t,e,s){const{organization:n,project:i}=this.props,r=t.organization||s?.organization,o=t.project||s?.project;if(!(0,a.ri)(o)||!(0,a.ri)(r))return;const l=r.slug===n.slug,p=o.slug===i?.slug;l&&p||this.fetchPlugins()}componentWillUnmount(){this.unsubscribe()}fetchPlugins(){const{organization:t,project:e}=this.props;e&&t&&(0,r.MM)({projectId:e.slug,orgId:t.slug})}render(){return(0,g.tZ)(t,{...this.props,plugins:this.state})}}return e.displayName="WithPlugins",(0,n.Z)(e,"displayName",`withPlugins(${(0,l.Z)(t)})`),(0,p.Z)((0,c.Z)(e))}},"./app/views/settings/project/permissionAlert.tsx":(t,e,s)=>{s.d(e,{Z:()=>l});var n=s("./app/components/acl/access.tsx"),i=s("./app/components/alert.tsx"),r=s("./app/locale.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const a=t=>{let{access:e=["project:write"],...s}=t;return(0,o.tZ)(n.Z,{access:e,children:t=>{let{hasAccess:e}=t;return!e&&(0,o.tZ)(i.Z,{"data-test-id":"project-permission-alert",type:"warning",...s,children:(0,r.t)("These settings can only be edited by users with the organization owner, manager, or admin role.")})}})};a.displayName="PermissionAlert";const l=a},"./app/views/settings/projectPlugins/index.tsx":(t,e,s)=>{s.r(e),s.d(e,{ProjectPluginsContainer:()=>N,default:()=>B});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=s("../node_modules/react/index.js"),r=s("./app/actionCreators/plugins.tsx"),o=s("./app/components/sentryDocumentTitle.tsx"),a=s("./app/locale.tsx"),l=s("./app/utils/integrationUtil.tsx"),p=s("./app/utils/withPlugins.tsx"),c=s("./app/views/settings/components/settingsPageHeader.tsx"),g=s("./app/views/settings/project/permissionAlert.tsx"),d=s("./app/components/acl/access.tsx"),u=s("./app/components/links/link.tsx"),h=s("./app/components/loadingIndicator.tsx"),m=s("./app/components/panels/index.tsx"),x=s("./app/views/routeError.tsx"),Z=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),b=s("./app/components/links/externalLink.tsx"),j=s("./app/components/switchButton.tsx"),f=s("./app/plugins/components/pluginIcon.tsx"),w=s("./app/utils/getDynamicText.tsx"),v=s("./app/utils/recreateRoute.tsx"),y=s("./app/utils/withOrganization.tsx"),P=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const S={name:"is2cq7",styles:"color:#979ba0"};class I extends i.PureComponent{constructor(){super(...arguments),(0,n.Z)(this,"handleChange",(()=>{const{onChange:t,id:e,enabled:s}=this.props;t(e,!s);const n=s?"integrations.disabled":"integrations.enabled";(0,l.Db)(n,{integration:e,integration_type:"plugin",view:"legacy_integrations",organization:this.props.organization})}))}render(){const{id:t,name:e,slug:s,version:n,author:i,hasConfiguration:r,enabled:o,canDisable:l}=this.props,p=(0,v.Z)(t,this.props);return(0,P.tZ)(d.Z,{access:["project:write"],children:c=>{let{hasAccess:g}=c;const d=g?u.Z:"span";return(0,P.BX)(_,{className:s,children:[(0,P.BX)(k,{children:[(0,P.tZ)(E,{size:48,pluginId:t}),(0,P.BX)(z,{children:[(0,P.BX)(A,{children:[`${e} `,(0,w.Z)({value:(0,P.tZ)(U,{children:n?`v${n}`:(0,P.tZ)("em",{children:(0,a.t)("n/a")})}),fixed:(0,P.tZ)(U,{children:"v10"})})]}),(0,P.BX)("div",{children:[i&&(0,P.tZ)(b.Z,{css:S,href:i.url,children:i.name}),r&&(0,P.BX)("span",{children:[" ","Â·"," ",(0,P.tZ)(d,{css:S,to:p,children:(0,a.t)("Configure plugin")})]})]})]})]}),(0,P.tZ)(j.Z,{size:"lg",isDisabled:!g||!l,isActive:o,toggle:this.handleChange})]},t)}})}}I.displayName="ProjectPluginRow";const C=(0,y.Z)(I),_=(0,Z.Z)("div",{target:"evund0f5"})({name:"zol16h",styles:"display:flex;flex:1;align-items:center"}),z=(0,Z.Z)("div",{target:"evund0f4"})({name:"1cepywk",styles:"display:flex;justify-content:center;flex-direction:column"}),k=(0,Z.Z)("div",{target:"evund0f3"})({name:"1l1txui",styles:"display:flex;flex:1;line-height:24px"}),A=(0,Z.Z)("div",{target:"evund0f2"})({name:"11g4mt0",styles:"font-size:16px"}),E=(0,Z.Z)(f.ZP,{target:"evund0f1"})({name:"o7nnmj",styles:"margin-right:16px"}),U=(0,Z.Z)("span",{target:"evund0f0"})({name:"qhuumn",styles:"color:#babec2"});class D extends i.Component{render(){const{plugins:t,loading:e,error:s,onChange:n,routes:i,params:r,project:o}=this.props,{orgId:l}=this.props.params,p=!s&&e;return s?(0,P.tZ)(x.Z,{error:s}):p?(0,P.tZ)(h.Z,{}):(0,P.BX)(m.s_,{children:[(0,P.BX)(m.V9,{children:[(0,P.tZ)("div",{children:(0,a.t)("Legacy Integration")}),(0,P.tZ)("div",{children:(0,a.t)("Enabled")})]}),(0,P.BX)(m.N,{children:[(0,P.tZ)(m.aU,{type:"warning",children:(0,P.tZ)(d.Z,{access:["org:integrations"],children:t=>{let{hasAccess:e}=t;return e?(0,a._N)("Legacy Integrations must be configured per-project. It's recommended to prefer organization integrations over the legacy project integrations when available. Visit the [link:organization integrations] settings to manage them.",{link:(0,P.tZ)(u.Z,{to:`/settings/${l}/integrations`})}):(0,a.t)("Legacy Integrations must be configured per-project. It's recommended to prefer organization integrations over the legacy project integrations when available.")}})}),t.filter((t=>!t.isHidden)).map((t=>(0,P.tZ)(m.Lv,{children:(0,P.tZ)(C,{params:r,routes:i,project:o,...t,onChange:n})},t.id)))]})]})}}D.displayName="ProjectPlugins";const L=D;class N extends i.Component{constructor(){super(...arguments),(0,n.Z)(this,"fetchData",(async()=>{const t=(await(0,r.MM)(this.props.params)).filter((t=>t.hasConfiguration&&t.enabled)).length;(0,l.Db)("integrations.index_viewed",{integrations_installed:t,view:"legacy_integrations",organization:this.props.organization},{startSession:!0})})),(0,n.Z)(this,"handleChange",((t,e)=>{const{projectId:s,orgId:n}=this.props.params;(e?r.Cg:r.rR)({projectId:s,orgId:n,pluginId:t})}))}componentDidMount(){this.fetchData()}render(){const{loading:t,error:e,plugins:s}=this.props.plugins||{},{orgId:n}=this.props.params,r=(0,a.t)("Legacy Integrations");return(0,P.BX)(i.Fragment,{children:[(0,P.tZ)(o.Z,{title:r,orgSlug:n}),(0,P.tZ)(c.Z,{title:r}),(0,P.tZ)(g.Z,{}),(0,P.tZ)(L,{...this.props,onChange:this.handleChange,loading:t,error:e,plugins:s})]})}}N.displayName="ProjectPluginsContainer";const B=(0,p.Z)(N)}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_projectPlugins_index_tsx.b21fa19c9095aebef524da6bf19aa367.js.map