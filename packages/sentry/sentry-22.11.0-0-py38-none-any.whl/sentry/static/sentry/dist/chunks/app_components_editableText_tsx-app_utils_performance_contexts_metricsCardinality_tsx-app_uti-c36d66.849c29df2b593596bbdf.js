"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_editableText_tsx-app_utils_performance_contexts_metricsCardinality_tsx-app_uti-c36d66"],{"./app/components/editableText.tsx":(e,t,n)=>{n.d(t,{_:()=>v,Z:()=>f});var r=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=n("../node_modules/react/index.js"),a=n("./app/actionCreators/indicator.tsx"),i=n("./app/components/input.tsx"),s=n("./app/components/textOverflow.tsx"),c=n("./app/icons/iconEdit.tsx"),u=n("./app/styles/space.tsx"),l=n("./app/utils.tsx");const d=(e,t)=>{const[n,r]=(0,o.useState)(!1),a=t??document.body;return(0,o.useEffect)((()=>{const t=t=>{let{key:n}=t;n===e&&r(!0)},n=t=>{let{key:n}=t;n===e&&r(!1)};return a.addEventListener("keydown",t),a.addEventListener("keyup",n),()=>{a.removeEventListener("keydown",t),a.removeEventListener("keyup",n)}}),[e,a]),n};var p=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function m(e){let{value:t,onChange:n,name:r,errorMessage:i,successMessage:s,maxLength:u,isDisabled:m=!1,autoSelect:f=!1,className:x,"aria-label":w}=e;const[C,Z]=(0,o.useState)(!1),[E,k]=(0,o.useState)(t),j=!E.trim(),P=(0,o.useRef)(null),T=(0,o.useRef)(null),z=(0,o.useRef)(null),L=d("Enter"),D=d("Escape");function N(){t!==E&&k(t),C&&Z(!1)}var O,S;O=P,S=()=>{C&&(j?R("error"):(E!==t&&(n(E),R("success")),Z(!1)))},(0,o.useEffect)((()=>{const e=e=>{const t=O?.current;t&&!t.contains(e.target)&&S(e)};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}}),[O,S]);const A=(0,o.useCallback)((()=>{if(L){if(j)return void R("error");E!==t&&(n(E),R("success")),Z(!1)}}),[L,E,n]),q=(0,o.useCallback)((()=>{D&&N()}),[D]);function R(e){"error"!==e?s&&(0,a.S9)(s):i&&(0,a.Iw)(i)}return(0,o.useEffect)((()=>{N()}),[m,t]),(0,o.useEffect)((()=>{if(C){const e=z.current;(0,l.ri)(e)&&e.focus()}}),[C]),(0,o.useEffect)((()=>{C&&(A(),q())}),[A,q,C]),(0,p.tZ)(_,{isDisabled:m,isEditing:C,className:x,children:C?(0,p.BX)(g,{ref:P,isEmpty:j,"data-test-id":"editable-text-input",children:[(0,p.tZ)(y,{"aria-label":w,name:r,ref:z,value:E,onChange:function(e){k(e.target.value)},onFocus:e=>f&&e.target.select(),maxLength:u}),(0,p.tZ)(b,{children:E})]}):(0,p.BX)(v,{onClick:m?void 0:function(){Z(!0)},ref:T,isDisabled:m,"data-test-id":"editable-text-label",children:[(0,p.tZ)(h,{children:E}),!m&&(0,p.tZ)(c.y,{})]})})}m.displayName="EditableText";const f=m,v=(0,r.Z)("div",{target:"e1nzw5k75"})("display:grid;grid-auto-flow:column;align-items:center;gap:",(0,u.Z)(1),";cursor:",(e=>e.isDisabled?"default":"pointer"),";"),h=(0,r.Z)(s.Z,{target:"e1nzw5k74"})("border-top:1px solid transparent;border-bottom:1px dotted ",(e=>e.theme.gray200),";"),g=(0,r.Z)("div",{target:"e1nzw5k73"})("display:inline-block;background:",(e=>e.theme.gray100),";border-radius:",(e=>e.theme.borderRadius),";margin:-",(0,u.Z)(.5)," -",(0,u.Z)(1),";padding:",(0,u.Z)(.5)," ",(0,u.Z)(1),";max-width:calc(100% + ",(0,u.Z)(2),");"),y=(0,r.Z)(i.Z,{target:"e1nzw5k72"})({name:"1v43sqt",styles:"border:none!important;background:transparent;height:auto;min-height:34px;padding:0;font-size:inherit;&,&:focus,&:active,&:hover{box-shadow:none;}"}),b=(0,r.Z)("div",{target:"e1nzw5k71"})("height:0;opacity:0;white-space:pre;padding:0 ",(0,u.Z)(1),";"),_=(0,r.Z)("div",{target:"e1nzw5k70"})("display:flex;",(e=>e.isDisabled&&`\n      ${h} {\n        border-bottom-color: transparent;\n      }\n    `),";")},"./app/utils/performance/contexts/metricsCardinality.tsx":(e,t,n)=>{n.d(t,{BT:()=>_,e0:()=>w}),n("../node_modules/core-js/modules/es.array.includes.js");var r=n("../node_modules/react/index.js"),o=n("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),a=n("./app/utils/dates.tsx"),i=n("./app/utils/discover/eventView.tsx"),s=n("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),c=n("../node_modules/lodash/omit.js"),u=n.n(c),l=n("./app/utils/discover/genericDiscoverQuery.tsx"),d=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function p(e){let{eventView:t,location:n}=e;return u()(t.getEventsAPIPayload(n),["field","sort","per_page","query"])}function m(e){let{children:t,...n}=e;return(0,d.tZ)(l.ZP,{route:"metrics-compatibility-sums",getRequestPayload:p,...n,children:e=>{let{tableData:n,...r}=e;return t({tableData:n,...r})}})}function f(e){let{eventView:t,location:n}=e;return u()(t.getEventsAPIPayload(n),["field","sort","per_page","query"])}function v(e){let{children:t,...n}=e;return(0,d.tZ)(l.ZP,{route:"metrics-compatibility",getRequestPayload:f,...n,children:e=>{let{tableData:n,...r}=e;return t({tableData:n,...r})}})}m.displayName="MetricsCompatibilityQuery",v.displayName="MetricsCompatibilitySumsQuery";var h=n("./app/utils/performance/contexts/utils.tsx");const[g,y,b]=(0,h.n)({name:"MetricsCardinalityContext",strict:!1}),_=e=>{if(!(0,s.gp)(e.organization))return(0,d.tZ)(g,{value:{isLoading:!1,outcome:{forceTransactionsOnly:!0}},children:e.children});const t={location:e.location,orgSlug:e.organization.slug,cursor:"0:0:0"},n=i.ZP.fromLocation(e.location);n.fields=[{field:"tpm()"}];const o=function(e){const t=e.clone();return t.start||t.end||(t.statsPeriod?(0,a.YJ)(t.statsPeriod)>1&&(t.statsPeriod="1h",t.start=void 0,t.end=void 0):(t.statsPeriod="1h",t.start=void 0,t.end=void 0)),t}(n);return(0,d.tZ)(r.Fragment,{children:(0,d.tZ)(m,{eventView:o,...t,children:n=>(0,d.tZ)(v,{eventView:o,...t,children:t=>{const r=n.isLoading||t.isLoading,o=n.isLoading||t.isLoading?void 0:function(e,t,n){const r={forceTransactionsOnly:!0},o=n.features.includes("performance-mep-bannerless-ui");if(!e)return r;const a=e.compatible_projects;return t?r:e?function(e){return!C(e).metricsCount}(e)?r:function(e,t){const n=C(e);return t?n.nullCount/n.metricsCount>.01:n.nullCount>0}(e,o)?{shouldWarnIncompatibleSDK:!0,forceTransactionsOnly:!0,compatibleProjects:a}:function(e){const t=C(e);return t.unparamCount>=t.metricsCount}(e)?{shouldNotifyUnnamedTransactions:!0,forceTransactionsOnly:!0,compatibleProjects:a}:function(e,t){const n=C(e);return t?n.unparamCount/n.metricsCount>.01:n.unparamCount>0}(e,o)?{shouldNotifyUnnamedTransactions:!0,compatibleProjects:a,forceTransactionsOnly:!1}:{forceTransactionsOnly:!1}:r}(n.tableData&&t.tableData?{...n.tableData,...t.tableData}:null,!!n.error&&!!t.error,e.organization);return(0,d.tZ)(x,{sendOutcomeAnalytics:e.sendOutcomeAnalytics,organization:e.organization,value:{isLoading:r,outcome:o},children:e.children})}})})})};_.displayName="MetricsCardinalityProvider";const x=e=>{const t=e.value.outcome?.shouldWarnIncompatibleSDK??!1,n=e.value.outcome?.shouldNotifyUnnamedTransactions??!1,a=!e.value.outcome?.forceTransactionsOnly;return(0,r.useEffect)((()=>{!e.value.isLoading&&e.sendOutcomeAnalytics&&(0,o.Z)("performance_views.mep.metrics_outcome",{organization:e.organization,is_on_metrics:a,fallback_from_null:t,fallback_from_unparam:n})}),[e.organization,e.value.isLoading,a,n,t,e.sendOutcomeAnalytics]),(0,d.tZ)(g,{...e,children:e.children})};x.displayName="Provider",b.Consumer;const w=y;function C(e){let{sum:t}=e;try{const e=Number(t.metrics);return{metricsCount:e,unparamCount:Number(t.metrics_unparam),nullCount:Number(t.metrics_null)}}catch(e){return{metricsCount:0,unparamCount:0,nullCount:0}}}},"./app/utils/performance/quickTrace/utils.tsx":(e,t,n)=>{n.d(t,{$J:()=>b,Ci:()=>C,R8:()=>v,S2:()=>_,_Z:()=>y,eF:()=>g,eW:()=>m,hp:()=>d,q2:()=>p,xB:()=>x,y3:()=>w}),n("../node_modules/core-js/modules/es.error.cause.js");var r=n("../node_modules/lodash/omit.js"),o=n.n(r),a=n("../node_modules/moment-timezone/index.js"),i=n.n(a),s=n("./app/components/events/interfaces/spans/utils.tsx"),c=n("./app/constants/pageFilters.tsx"),u=n("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),l=n("./app/utils/discover/eventView.tsx");function d(e){return"transaction"===e.type}function p(e,t){return d(t)?e.event_id===t.id:void 0!==e.errors&&e.errors.some((e=>e.event_id===t.id))}function m(e,t){const n=[],r=[],o=[{event:t,path:[]}];for(;o.length;){const t=o.shift();if(p(t.event,e)){for(const e of t.path)n.push(e);r.push(t.event)}else{const e=[...t.path,f(t.event)];for(const n of t.event.children)o.push({event:n,path:e})}}if(!r.length)throw new Error("No relevant path exists!");for(;r.length;){const e=r.shift();for(const t of e.children)r.push(t);n.push(f(e))}return n}function f(e){return o()(e,["children"])}function v(e,t,n){const{type:r,trace:o}=e;if("empty"===r||null===o)throw new Error("Current event not in trace navigator!");const a="full"===r,i=o.find((e=>p(e,t)))??null;if(null===i)throw new Error("Current event not in trace navigator!");const s=i.parent_event_id?o.find((e=>e.event_id===i.parent_event_id))??null:null,c=o.find((e=>e.event_id!==i.event_id&&e.event_id!==s?.event_id&&0===e.generation))??null,l=a?[]:null,d=[],m=a?[]:null,f=new Set;return o.forEach((e=>{f.add(e.project_id),(e=>e.parent_event_id===i.event_id)(e)?d.push(e):a&&((e=>null!==i.generation&&null!==e.generation&&e.generation>0&&i.generation-1>e.generation)(e)?l?.push(e):(e=>null!==i.generation&&null!==e.generation&&i.generation+1<e.generation)(e)&&m?.push(e))})),a&&f.size>1&&function(e,t){(0,u.Z)("quick_trace.connected_services",{organization:e.id,projects:t})}(n,f.size),{root:c,ancestors:null===l?null:h(l),parent:s,current:i,children:h(d),descendants:null===m?null:h(m)}}function h(e){return e.sort(((e,t)=>t["transaction.duration"]-e["transaction.duration"]))}function g(e){let{eventView:t,location:n}=e;return o()(t.getEventsAPIPayload(n),["field","sort","per_page"])}function y(e){let{start:t,end:n,statsPeriod:r}=e;return l.ZP.fromSavedQuery({id:void 0,version:2,name:"",fields:["transaction.duration"],projects:[c.mP],query:"",environment:[],start:t,end:n,range:r??void 0})}function b(e){const t=d(e)?e.startTimestamp:i()(e.dateReceived?e.dateReceived:e.dateCreated).valueOf()/1e3,n=d(e)?e.endTimestamp:t;return(0,s.TC)({start:t,end:n})}function _(e,t,n){let r=n;const o=[e];for(;o.length;){const e=o.pop();for(const t of e.children)o.push(t);r=t(r,e)}return r}function x(e,t){return _(e,((e,n)=>(t(n)&&e.push(n),e)),[])}function w(e){return Boolean(e.event_id)}function C(e){return Boolean(e.event_id)}}}]);
//# sourceMappingURL=../sourcemaps/app_components_editableText_tsx-app_utils_performance_contexts_metricsCardinality_tsx-app_uti-c36d66.36b5c9238af1149f89d2bde363f4d9b3.js.map