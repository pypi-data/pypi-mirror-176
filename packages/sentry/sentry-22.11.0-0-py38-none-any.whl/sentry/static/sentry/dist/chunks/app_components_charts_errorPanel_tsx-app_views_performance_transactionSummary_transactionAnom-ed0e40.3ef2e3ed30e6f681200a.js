"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_charts_errorPanel_tsx-app_views_performance_transactionSummary_transactionAnom-ed0e40","app_views_performance_transactionSummary_utils_tsx"],{"./app/components/charts/chartZoom.tsx":(e,t,n)=>{n.d(t,{Z:()=>y});var o=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=n("../node_modules/react/index.js"),a=n("../node_modules/moment/moment.js"),i=n.n(a),s=n("../node_modules/query-string/index.js"),d=n("./app/actionCreators/pageFilters.tsx"),l=n("./app/components/charts/components/dataZoomInside.tsx");n("../node_modules/echarts/lib/component/dataZoomSlider.js");const c={realtime:!1,showDetail:!1,left:0,right:6,bottom:8};function p(e){return e&&Array.isArray(e)?e:[{...c,...e}]}var m=n("./app/components/charts/components/toolBox.tsx"),u=n("./app/utils/callIfFunction.tsx"),h=n("./app/utils/dates.tsx");const f=e=>e?i().utc(e).format(i().HTML5_FMT.DATETIME_LOCAL_SECONDS):null;class g extends r.Component{constructor(e){var t;super(e),t=this,(0,o.Z)(this,"history",void 0),(0,o.Z)(this,"currentPeriod",void 0),(0,o.Z)(this,"zooming",null),(0,o.Z)(this,"saveCurrentPeriod",(e=>{this.currentPeriod={period:e.period,start:f(e.start),end:f(e.end)}})),(0,o.Z)(this,"setPeriod",(function(e){let{period:n,start:o,end:r}=e,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{router:i,onZoom:l,usePageDate:c}=t.props,p=f(o),m=f(r);a&&t.history.push(t.currentPeriod),l?.({period:n,start:p,end:m}),t.zooming=()=>{if(c&&i){const e={...i.location.query,pageStart:o?(0,h.v5)(o):void 0,pageEnd:r?(0,h.v5)(r):void 0,pageStatsPeriod:n??void 0};s.stringify(e)!==s.stringify(i.location.query)&&i.push({pathname:i.location.pathname,query:e})}else(0,d.dR)({period:n,start:p?(0,h.hC)(p):p,end:m?(0,h.hC)(m):m},i);t.saveCurrentPeriod({period:n,start:o,end:r})}})),(0,o.Z)(this,"handleChartReady",(e=>{this.props.onChartReady?.(e)})),(0,o.Z)(this,"handleZoomRestore",((e,t)=>{this.history.length&&(this.setPeriod(this.history[0]),this.history=[],this.props.onRestore?.(e,t))})),(0,o.Z)(this,"handleDataZoom",((e,t)=>{const n=t.getModel(),{startValue:o,endValue:r}=n._payload.batch[0];if(null===o&&null===r){const e=this.history.pop();if(!e)return;this.setPeriod(e)}else{const e=i().utc(o),t=i().utc(r);this.setPeriod({period:null,start:e,end:t},!0)}this.props.onDataZoom?.(e,t)})),(0,o.Z)(this,"handleChartFinished",((e,t)=>{"function"==typeof this.zooming&&(this.zooming(),this.zooming=null);const n=t._componentsViews?.find((e=>e._features&&e._features.dataZoom));n&&!n._features.dataZoom._isZoomActive&&t.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:!0}),(0,u.g)(this.props.onFinished)})),this.history=[],this.saveCurrentPeriod(e)}componentDidUpdate(){this.props.disabled||this.saveCurrentPeriod(this.props)}render(){const{utc:e,start:t,end:n,disabled:o,children:r,xAxisIndex:a,router:i,onZoom:s,onRestore:d,onChartReady:c,onDataZoom:u,onFinished:f,showSlider:g,chartZoomOptions:y,...x}=this.props,v=e??void 0,Z=t?(0,h.hC)(t):void 0,w=n?(0,h.hC)(n):void 0;return r(o?{utc:v,start:Z,end:w,...x}:{isGroupedByDate:!0,onChartReady:this.handleChartReady,utc:v,start:Z,end:w,dataZoom:g?[...p({xAxisIndex:a,...y}),...(0,l.Z)({xAxisIndex:a,...y})]:(0,l.Z)({xAxisIndex:a,...y}),showTimeInTooltip:!0,toolBox:(0,m.Z)({},{dataZoom:{title:{zoom:"",back:""},iconStyle:{borderWidth:0,color:"transparent",opacity:0}}}),onDataZoom:this.handleDataZoom,onFinished:this.handleChartFinished,onRestore:this.handleZoomRestore,...x})}}g.displayName="ChartZoom";const y=g},"./app/components/charts/components/dataZoomInside.tsx":(e,t,n)=>{n.d(t,{Z:()=>r}),n("../node_modules/echarts/lib/component/dataZoomInside.js");const o={type:"inside",zoomOnMouseWheel:!1,zoomLock:!0,throttle:50};function r(e){return e&&Array.isArray(e)?e:[{...o,...e}]}},"./app/components/charts/components/markArea.tsx":(e,t,n)=>{function o(e){return{...e}}n.d(t,{Z:()=>o}),n("../node_modules/echarts/lib/component/markArea.js")},"./app/components/charts/components/toolBox.tsx":(e,t,n)=>{function o(){let{dataZoom:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{...e?{dataZoom:{yAxisIndex:"none",title:{zoom:"zoom",back:"undo"},...e}}:{},...t}}function r(e,t){return{right:0,top:0,itemSize:16,z:-1,feature:o(t),...e}}n.d(t,{Z:()=>r})},"./app/components/charts/errorPanel.tsx":(e,t,n)=>{n.d(t,{Z:()=>o});const o=(0,n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js").Z)("div",{target:"e1six6h50"})("display:flex;flex-direction:column;justify-content:center;align-items:center;flex:1;flex-shrink:0;overflow:hidden;height:",(e=>e.height||"200px"),";position:relative;border-color:transparent;margin-bottom:0;color:",(e=>e.theme.gray300),";font-size:",(e=>e.theme.fontSizeExtraLarge),";")},"./app/components/charts/lineChart.tsx":(e,t,n)=>{n.d(t,{w:()=>i});var o=n("./app/components/charts/series/lineSeries.tsx"),r=n("./app/components/charts/baseChart.tsx"),a=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){let{series:t,seriesOptions:n,...i}=e;return(0,a.tZ)(r.Z,{...i,series:t.map((e=>{let{seriesName:t,data:r,dataArray:a,...i}=e;return(0,o.Z)({...n,...i,name:t,data:a||r?.map((e=>{let{value:t,name:n}=e;return[n,t]})),animation:!1,animationThreshold:1,animationDuration:0})}))})}i.displayName="LineChart"},"./app/components/gridEditable/sortLink.tsx":(e,t,n)=>{n.d(t,{Z:()=>h});var o=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=n("../node_modules/react-router/es/index.js"),a=n("../node_modules/lodash/omit.js"),i=n.n(a),s=n("./app/components/links/link.tsx"),d=n("./app/icons/index.tsx"),l=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function c(e){let{align:t,title:n,canSort:o,generateSortLink:a,onClick:i,direction:s,replace:d}=e;const c=a();if(!c||!o)return(0,l.tZ)(m,{align:t,children:n});const h=s?(0,l.tZ)(u,{size:"xs",direction:"desc"===s?"down":"up"}):null;return(0,l.BX)(p,{align:t,to:c,onClick:e=>{d&&(e.preventDefault(),r.browserHistory.replace(c)),i?.(e)},children:[n," ",h]})}c.displayName="SortLink";const p=(0,o.Z)((e=>{const t=i()(e,["align","css"]);return(0,l.tZ)(s.Z,{...t})}),{target:"e1xb2te62"})("display:block;width:100%;white-space:nowrap;color:inherit;&:hover,&:active,&:focus,&:visited{color:inherit;}",(e=>e.align?`text-align: ${e.align};`:""),";"),m=(0,o.Z)("div",{target:"e1xb2te61"})("display:block;width:100%;white-space:nowrap;",(e=>e.align?`text-align: ${e.align};`:""),";"),u=(0,o.Z)(d.CC,{target:"e1xb2te60"})({name:"40f4ru",styles:"vertical-align:top"}),h=c},"./app/utils/performance/anomalies/anomaliesQuery.tsx":(e,t,n)=>{n.d(t,{Z:()=>l}),n("../node_modules/core-js/modules/es.array.includes.js");var o=n("./app/utils/discover/genericDiscoverQuery.tsx"),r=n("./app/views/performance/transactionSummary/transactionAnomalies/utils.tsx"),a=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){return e.data.forEach((e=>e[0]=1e3*e[0])),e}function s(e){const t={...e};return e.y&&e.yhat_lower&&e.yhat_upper&&e.anomalies?(t.y=i(e.y),t.yhat_upper=i(e.yhat_upper),t.yhat_lower=i(e.yhat_lower),t.anomalies=((n=e.anomalies).forEach((e=>{e.start=1e3*e.start,e.end=1e3*e.end})),n),t):t;var n}function d(e){return e.organization.features.includes(r.uT)?(0,a.tZ)(o.ZP,{route:"transaction-anomaly-detection",...e,children:t=>{let{tableData:n,...o}=t;return e.children({data:n&&n.y?s(n):null,...o})}}):(0,a.tZ)("div",{children:e.children({data:null,isLoading:!1,error:null,pageLinks:null})})}d.displayName="AnomaliesSeriesQuery";const l=d},"./app/utils/performance/quickTrace/utils.tsx":(e,t,n)=>{n.d(t,{$J:()=>v,Ci:()=>b,R8:()=>f,S2:()=>Z,_Z:()=>x,eF:()=>y,eW:()=>u,hp:()=>p,q2:()=>m,xB:()=>w,y3:()=>_}),n("../node_modules/core-js/modules/es.error.cause.js");var o=n("../node_modules/lodash/omit.js"),r=n.n(o),a=n("../node_modules/moment-timezone/index.js"),i=n.n(a),s=n("./app/components/events/interfaces/spans/utils.tsx"),d=n("./app/constants/pageFilters.tsx"),l=n("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),c=n("./app/utils/discover/eventView.tsx");function p(e){return"transaction"===e.type}function m(e,t){return p(t)?e.event_id===t.id:void 0!==e.errors&&e.errors.some((e=>e.event_id===t.id))}function u(e,t){const n=[],o=[],r=[{event:t,path:[]}];for(;r.length;){const t=r.shift();if(m(t.event,e)){for(const e of t.path)n.push(e);o.push(t.event)}else{const e=[...t.path,h(t.event)];for(const n of t.event.children)r.push({event:n,path:e})}}if(!o.length)throw new Error("No relevant path exists!");for(;o.length;){const e=o.shift();for(const t of e.children)o.push(t);n.push(h(e))}return n}function h(e){return r()(e,["children"])}function f(e,t,n){const{type:o,trace:r}=e;if("empty"===o||null===r)throw new Error("Current event not in trace navigator!");const a="full"===o,i=r.find((e=>m(e,t)))??null;if(null===i)throw new Error("Current event not in trace navigator!");const s=i.parent_event_id?r.find((e=>e.event_id===i.parent_event_id))??null:null,d=r.find((e=>e.event_id!==i.event_id&&e.event_id!==s?.event_id&&0===e.generation))??null,c=a?[]:null,p=[],u=a?[]:null,h=new Set;return r.forEach((e=>{h.add(e.project_id),(e=>e.parent_event_id===i.event_id)(e)?p.push(e):a&&((e=>null!==i.generation&&null!==e.generation&&e.generation>0&&i.generation-1>e.generation)(e)?c?.push(e):(e=>null!==i.generation&&null!==e.generation&&i.generation+1<e.generation)(e)&&u?.push(e))})),a&&h.size>1&&function(e,t){(0,l.Z)("quick_trace.connected_services",{organization:e.id,projects:t})}(n,h.size),{root:d,ancestors:null===c?null:g(c),parent:s,current:i,children:g(p),descendants:null===u?null:g(u)}}function g(e){return e.sort(((e,t)=>t["transaction.duration"]-e["transaction.duration"]))}function y(e){let{eventView:t,location:n}=e;return r()(t.getEventsAPIPayload(n),["field","sort","per_page"])}function x(e){let{start:t,end:n,statsPeriod:o}=e;return c.ZP.fromSavedQuery({id:void 0,version:2,name:"",fields:["transaction.duration"],projects:[d.mP],query:"",environment:[],start:t,end:n,range:o??void 0})}function v(e){const t=p(e)?e.startTimestamp:i()(e.dateReceived?e.dateReceived:e.dateCreated).valueOf()/1e3,n=p(e)?e.endTimestamp:t;return(0,s.TC)({start:t,end:n})}function Z(e,t,n){let o=n;const r=[e];for(;r.length;){const e=r.pop();for(const t of e.children)r.push(t);o=t(o,e)}return o}function w(e,t){return Z(e,((e,n)=>(t(n)&&e.push(n),e)),[])}function _(e){return Boolean(e.event_id)}function b(e){return Boolean(e.event_id)}},"./app/utils/performance/urls.ts":(e,t,n)=>{n.d(t,{D:()=>a});var o=n("./app/components/events/interfaces/spans/utils.tsx"),r=n("./app/utils.tsx");function a(e,t,n,a,i){const s={...a||{},transaction:n};(0,r.ri)(s.transaction)||delete s.transaction;const d={pathname:`/organizations/${e}/performance/${t}/`,query:s,hash:(0,r.ri)(i)?(0,o.ct)(i):void 0};return(0,r.ri)(d.hash)||delete d.hash,d}},"./app/views/performance/landing/widgets/components/selectableList.tsx":(e,t,n)=>{n.d(t,{Nm:()=>Z,QE:()=>y,S$:()=>g,ZP:()=>h,qL:()=>x,xq:()=>v});var o=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=n("./app/components/emptyStateWarning.tsx"),a=n("./app/components/forms/controls/radioGroup.tsx"),i=n("./app/components/links/link.tsx"),s=n("./app/components/radio.tsx"),d=n("./app/components/tooltip.tsx"),l=n("./app/icons/index.tsx"),c=n("./app/locale.tsx"),p=n("./app/styles/space.tsx"),m=n("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),u=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function h(e){return(0,u.tZ)("div",{children:e.items.map(((t,n)=>(0,m.az)(f,{...e,isSelected:n===e.selectedIndex,currentIndex:n,key:n},t())))})}function f(e){let{isSelected:t,currentIndex:n,children:o,setSelectedIndex:r,radioColor:i}=e;return(0,u.BX)(S,{children:[(0,u.tZ)(j,{color:i??"",children:(0,u.tZ)(a.V,{index:n,role:"radio",children:(0,u.tZ)(s.Z,{checked:t,onChange:()=>r(n)})})}),o]})}h.displayName="SelectableList",f.displayName="SelectableItem";const g=(0,o.Z)("div",{target:"e1fgyx4u7"})("text-align:right;display:flex;align-items:center;justify-content:center;padding:0 ",(0,p.Z)(1),";"),y=(0,o.Z)("span",{target:"e1fgyx4u6"})("color:",(e=>e.theme.gray300),";font-size:",(e=>e.theme.fontSizeMedium),";display:inline-block;"),x=(0,o.Z)(i.Z,{target:"e1fgyx4u5"})({name:"pu304d",styles:"flex-grow:1;display:inherit"}),v=()=>(0,u.tZ)(b,{small:!0,children:(0,c.t)("No results")});function Z(e){return(0,u.tZ)(w,{title:(0,c.t)("Exclude this transaction from the search filter."),children:(0,u.tZ)(_,{onClick:()=>{e.onClick(),e.setSelectListIndex(0)}})})}v.displayName="WidgetEmptyStateWarning",Z.displayName="ListClose";const w=(0,o.Z)(d.Z,{target:"e1fgyx4u4"})({name:"1wnowod",styles:"display:flex;align-items:center;justify-content:center"}),_=(0,o.Z)(l.bM,{target:"e1fgyx4u3"})("cursor:pointer;color:",(e=>e.theme.gray200),";"),b=(0,o.Z)(r.Z,{target:"e1fgyx4u2"})({name:"1t1oqhu",styles:"min-height:300px;justify-content:center"}),S=(0,o.Z)("div",{target:"e1fgyx4u1"})("display:flex;border-top:1px solid ",(e=>e.theme.border),";padding:",(0,p.Z)(1)," ",(0,p.Z)(2),";font-size:",(e=>e.theme.fontSizeMedium),";"),j=(0,o.Z)("div",{target:"e1fgyx4u0"})("grid-row:1/3;input{cursor:pointer;}input:checked::after{background-color:",(e=>e.color),";}")},"./app/views/performance/traceDetails/utils.tsx":(e,t,n)=>{n.d(t,{Rg:()=>i,YA:()=>a,uM:()=>s});var o=n("./app/constants/pageFilters.tsx"),r=n("./app/utils/performance/quickTrace/utils.tsx");function a(e,t,n,r){const{start:a,end:i,statsPeriod:s}=n;return{pathname:`/organizations/${e.slug}/performance/trace/${t}/`,query:{...r,statsPeriod:s,[o.V.PAGE_START]:a,[o.V.PAGE_END]:i}}}function i(e){const t={projects:new Set,errors:new Set,transactions:new Set,startTimestamp:Number.MAX_SAFE_INTEGER,endTimestamp:0,maxGeneration:0};return e.reduce(((e,t)=>(0,r.S2)(t,((e,t)=>{for(const n of t.errors??[])e.errors.add(n.event_id);return e.transactions.add(t.event_id),e.projects.add(t.project_slug),e.startTimestamp=Math.min(e.startTimestamp,t.start_timestamp),e.endTimestamp=Math.max(e.endTimestamp,t.timestamp),e.maxGeneration=Math.max(e.maxGeneration,t.generation),e}),e)),t)}function s(e){return null===e.parent_span_id}},"./app/views/performance/transactionSummary/transactionAnomalies/index.tsx":(e,t,n)=>{n.r(t),n.d(t,{default:()=>le});var o=n("./app/locale.tsx"),r=n("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),a=n("./app/utils/withOrganization.tsx"),i=n("./app/utils/withProjects.tsx"),s=n("./app/views/performance/transactionSummary/pageLayout.tsx"),d=n("./app/views/performance/transactionSummary/tabs.tsx"),l=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),c=n("../node_modules/react/index.js"),p=n("../node_modules/react-router/es/index.js"),m=n("../node_modules/lodash/omit.js"),u=n.n(m),h=n("./app/components/charts/components/markArea.tsx"),f=n("./app/components/charts/components/markLine.tsx"),g=n("./app/components/datePageFilter.tsx"),y=n("./app/components/environmentPageFilter.tsx"),x=n("./app/components/events/searchBar.tsx"),v=n("./app/components/layouts/thirds.tsx"),Z=n("./app/components/organizations/pageFilterBar.tsx"),w=n("./app/components/organizations/pageFilters/parse.tsx"),_=n("./app/styles/space.tsx"),b=n("./app/utils.tsx"),S=n("./app/utils/performance/anomalies/anomaliesQuery.tsx"),j=n("./app/utils/queryString.tsx"),C=n("./app/utils/theme.tsx"),k=n("./app/views/performance/landing/widgets/components/performanceWidget.tsx"),A=n("./app/views/performance/landing/widgets/components/selectableList.tsx"),P=n("./app/views/performance/landing/widgets/widgetDefinitions.tsx"),z=n("./app/components/count.tsx"),E=n("./app/components/gridEditable/index.tsx"),T=n("./app/components/gridEditable/sortLink.tsx"),L=n("./app/icons/index.tsx"),q=n("./app/utils/discover/fieldRenderers.tsx"),D=n("./app/utils/discover/fields.tsx"),I=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const N=e=>({anomaly:`#${e.id}`,confidence:e.confidence,timestamp:new Date(e.start),timeInterval:e.end-e.start,expected:e.expected,received:e.received});function R(e){const{location:t,organization:n,isLoading:o,anomalies:r}=e,a=r?.map(N)||[];return(0,I.tZ)(E.ZP,{isLoading:o,data:a,columnOrder:Object.values(G),columnSortBy:[],grid:{renderHeadCell:F,renderBodyCell:B(t,n)},location:t})}function F(e,t){const n=(0,D.qG)(e.key,W[e.key]);return(0,I.tZ)(T.Z,{title:e.name,align:n,direction:void 0,canSort:!1,generateSortLink:()=>{}})}function B(e,t){return(n,r)=>{const a=(0,q.Js)(n.key,W);return"confidence"===n.key?(0,I.tZ)(V,{children:"low"===r.confidence?(0,I.tZ)(M,{children:(0,o.t)("Low Confidence")}):(0,I.tZ)(O,{children:(0,o.t)("High Confidence")})}):"expected"===n.key?(0,I.tZ)($,{children:(0,I.tZ)(z.Z,{value:r.expected})}):"received"===n.key?(0,I.BX)($,{children:[(0,I.tZ)(z.Z,{value:r.received}),(0,I.tZ)(L.CC,{size:"sm",direction:r.received>r.expected?"up":"down"})]}):a(r,{location:e,organization:t})}}R.displayName="AnomaliesTable",F.displayName="renderHeadCell";const $=(0,l.Z)("div",{target:"e1uhfujm3"})("display:flex;justify-content:flex-end;align-items:center;gap:",(0,_.Z)(.5),";"),M=(0,l.Z)("div",{target:"e1uhfujm2"})("color:",(e=>e.theme.yellow300),";"),O=(0,l.Z)("div",{target:"e1uhfujm1"})("color:",(e=>e.theme.red300),";"),V=(0,l.Z)("div",{target:"e1uhfujm0"})({name:"1qetfgc",styles:"text-align:left;justify-self:flex-end;flex-grow:1"}),G={anomaly:{key:"anomaly",name:(0,o.t)("Anomaly"),width:E.z7},confidence:{key:"confidence",name:(0,o.t)("Confidence"),width:E.z7},timeInterval:{key:"timeInterval",name:(0,o.t)("Time Interval"),width:E.z7},timestamp:{key:"timestamp",name:(0,o.t)("Timestamp"),width:E.z7},expected:{key:"expected",name:(0,o.t)("Expected"),width:E.z7},received:{key:"received",name:(0,o.t)("Received"),width:E.z7}},W={anomaly:"string",confidence:"string",timeInterval:"duration",timestamp:"date",expected:"number",received:"number"};var H=n("./app/components/charts/chartZoom.tsx"),X=n("./app/components/charts/lineChart.tsx"),Q=n("./app/utils/dates.tsx"),J=n("./app/utils/discover/charts.tsx");const K=e=>{const{data:t,location:n,statsPeriod:r,height:a,router:i,start:s,end:d}=e,l=s?(0,Q.hC)(s):null,c=d?(0,Q.hC)(d):null,{utc:p}=(0,w.fK)(n.query),m={legend:{right:10,top:5,data:[(0,o.t)("High Confidence"),(0,o.t)("Low Confidence")]},seriesOptions:{showSymbol:!1},height:a,tooltip:{trigger:"axis",valueFormatter:(e,t)=>(0,J.CX)(e,(0,D.Px)(t))},xAxis:void 0,yAxis:{axisLabel:{formatter:e=>(0,J.gu)(e,"number")}}};return(0,I.tZ)(H.Z,{router:i,period:r,start:l,end:c,utc:"true"===p,children:e=>(0,I.tZ)(X.w,{...e,series:t,...m})})};K.displayName="_AnomalyChart";const U=(0,p.withRouter)(K),Y=e=>`#${e.id}`,ee=e=>[{name:Y(e),xAxis:e.start},{xAxis:e.end}],te=(e,t)=>{const n=[],o=t.data;if(!o)return{isLoading:t.isLoading,isErrored:!!t.error,data:void 0,hasData:!1,loading:t.isLoading};n.push({seriesName:"tpm()",data:o.y.data.map((e=>{let[t,[{count:n}]]=e;return{name:t,value:n}}))}),n.push({seriesName:"tpm() lower bound",data:o.yhat_lower.data.map((e=>{let[t,[{count:n}]]=e;return{name:t,value:n}}))}),n.push({seriesName:"tpm() upper bound",data:o.yhat_upper.data.map((e=>{let[t,[{count:n}]]=e;return{name:t,value:n}}))});const r=t.data.anomalies,a=r.filter((e=>"high"===e.confidence)).map(ee),i=r.filter((e=>"high"===e.confidence)).map((e=>({xAxis:e.start,name:Y(e)}))),s=r.filter((e=>"low"===e.confidence)).map(ee),d=r.filter((e=>"low"===e.confidence)).map((e=>({xAxis:e.start,name:Y(e)})));return n.push({seriesName:"High Confidence",color:C.ZP.red300,data:[],silent:!0,markLine:(0,f.Z)({animation:!1,lineStyle:{color:C.ZP.red300,type:"solid",width:1,opacity:1},data:i,label:{show:!0,rotate:90,color:C.ZP.red300,position:"insideEndBottom",fontSize:"10",offset:[5,5],formatter:e=>`${e.data.name}`}}),markArea:(0,h.Z)({itemStyle:{color:C.ZP.red300,opacity:.2},label:{show:!1},data:a})}),n.push({seriesName:"Low Confidence",color:C.ZP.yellow200,data:[],markLine:(0,f.Z)({animation:!1,lineStyle:{color:C.ZP.yellow200,type:"solid",width:1,opacity:1},data:d,label:{show:!0,rotate:90,color:C.ZP.yellow300,position:"insideEndBottom",fontSize:"10",offset:[5,5],formatter:e=>`${e.data.name}`}}),markArea:(0,h.Z)({itemStyle:{color:C.ZP.yellow200,opacity:.2},label:{show:!1},data:s})}),{isLoading:t.isLoading,isErrored:!!t.error,data:n,hasData:!0,loading:t.isLoading}};function ne(e){const t=C.ZP.charts.colors[0],n=(0,c.useMemo)((()=>({fields:"",component:t=>(0,I.tZ)(c.Fragment,{children:t.children(e.queryData)}),transform:te})),[e.queryData]);return(0,I.tZ)(k.I,{...e,title:(0,o.t)("Transaction Count"),titleTooltip:(0,o.t)("Represents transaction count across time, with added visualizations to highlight anomalies in your data."),fields:[""],chartSetting:P.s.TPM_AREA,chartDefinition:P.W[P.s.TPM_AREA],Subtitle:()=>(0,I.tZ)("div",{}),HeaderActions:()=>(0,I.tZ)("div",{}),EmptyComponent:A.xq,Queries:{chart:n},Visualizations:[{component:e=>{const n=e.widgetData.chart.data?.map((e=>("tpm()"!==e.seriesName&&(e.lineStyle={type:"dashed",color:t,width:1.5}),"score"===e.seriesName&&(e.lineStyle={color:C.ZP.red400}),e)))??[];return(0,I.tZ)(U,{...e,data:n,height:250,statsPeriod:void 0,start:null,end:null})},height:250}]})}function oe(e){const{location:t,organization:n,eventView:o}=e,r=(0,j.ro)(t.query.query,"");return(0,I.BX)(v.or,{fullWidth:!0,children:[(0,I.BX)(re,{children:[(0,I.BX)(Z.Z,{condensed:!0,children:[(0,I.tZ)(y.Z,{}),(0,I.tZ)(g.Z,{alignDropdown:"left"})]}),(0,I.tZ)(x.Z,{organization:n,projectIds:o.project,query:r,fields:o.fields,onSearch:(a="query",function(e){const n=(0,w.fK)({...t.query||{},[a]:e}),o=["cursor"];(0,b.ri)(e)||o.push(a);const r=u()(n,o);p.browserHistory.push({...t,query:r})})})]}),(0,I.tZ)(S.Z,{organization:n,location:t,eventView:o,children:t=>(0,I.BX)(c.Fragment,{children:[(0,I.tZ)(ne,{...e,queryData:t}),(0,I.tZ)(R,{anomalies:t.data?.anomalies,...e,isLoading:t.isLoading})]})})]});var a}ne.displayName="Anomalies",oe.displayName="AnomaliesContent";const re=(0,l.Z)("div",{target:"eoagdn90"})("display:grid;gap:",(0,_.Z)(2),";margin-bottom:",(0,_.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints.small),"){grid-template-columns:auto 1fr;}"),ae=oe;var ie=n("./app/views/performance/transactionSummary/transactionAnomalies/utils.tsx");function se(e){const{location:t,organization:n,projects:o}=e;return(0,I.tZ)(r.kP,{children:(0,I.tZ)(s.ZP,{location:t,organization:n,projects:o,tab:d.Z.Anomalies,generateEventView:ie.h2,getDocumentTitle:de,childComponent:ae})})}function de(e){return"string"==typeof e&&String(e).trim().length>0?[String(e).trim(),(0,o.t)("Performance")].join(" - "):[(0,o.t)("Summary"),(0,o.t)("Performance")].join(" - ")}se.displayName="TransactionAnomalies";const le=(0,i.Z)((0,a.Z)(se))},"./app/views/performance/transactionSummary/utils.tsx":(e,t,n)=>{n.d(t,{K0:()=>c,MF:()=>g,PU:()=>m,Z6:()=>h,e1:()=>u,uI:()=>y,vd:()=>f,xf:()=>p});var o=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=n("./app/styles/space.tsx"),a=n("./app/utils/discover/urls.tsx"),i=n("./app/utils/getRouteStringFromRoutes.tsx"),s=n("./app/utils/performance/urls.ts"),d=n("./app/utils/tokenizeSearch.tsx"),l=n("./app/views/performance/traceDetails/utils.tsx");let c;function p(e){const t=m(e);return t.removeFilter("transaction"),t}function m(e){const t=new d.MY(e);return t.removeFilter("event.type"),t}function u(e){let{orgSlug:t,transaction:n,projectID:o,query:r,unselectedSeries:a="p100()",display:i,trendFunction:s,trendColumn:d,showTransactions:l,additionalQuery:c}=e;const m=function(e){let{orgSlug:t}=e;return`/organizations/${t}/performance/summary/`}({orgSlug:t});let u;return u="string"==typeof r.query?p(r.query).formatString():r.query,{pathname:m,query:{transaction:n,project:o,environment:r.environment,statsPeriod:r.statsPeriod,start:r.start,end:r.end,query:u,unselectedSeries:a,showTransactions:l,display:i,trendFunction:s,trendColumn:d,referrer:"performance-transaction-summary",...c}}}function h(e){return(t,n,o)=>{const r=`${n.trace}`;return r?(0,l.YA)(t,r,e,{}):{}}}function f(e){return(t,n,o,r)=>{const i=(0,a.JE)(n);return(0,s.D)(t.slug,i,e,o,r)}}function g(e){return(t,n,o)=>{const r=n.replayId;if(!r)return{};const a=`${n["project.name"]}:${r}`,s=(0,i.Z)(e);if(!n.timestamp)return{pathname:`/organizations/${t.slug}/replays/${a}/`,query:{referrer:s}};const d=new Date(n.timestamp).getTime()-n["transaction.duration"];return{pathname:`/organizations/${t.slug}/replays/${a}/`,query:{event_t:d,referrer:s}}}}!function(e){e.FASTEST="fastest",e.SLOW="slow",e.OUTLIER="outlier",e.RECENT="recent"}(c||(c={}));const y=(0,o.Z)("div",{target:"e1radvp0"})("margin-top:",(0,r.Z)(3),";")}}]);
//# sourceMappingURL=../sourcemaps/app_components_charts_errorPanel_tsx-app_views_performance_transactionSummary_transactionAnom-ed0e40.535b09f80feb1c0b2334e99e188995da.js.map