{"version":3,"file":"chunks/app_views_organizationGroupDetails_groupReplays_index_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"2WAwEA,QAtDA,SAAuB,GAA4C,IAA5C,UAACA,EAAS,aAAEC,GAAsB,EACvD,MAAMC,GAAMC,EAAAA,EAAAA,KACNC,GAAWC,EAAAA,EAAAA,KACXC,GAAiBC,EAAAA,EAAAA,UACjBC,GAAgBD,EAAAA,EAAAA,QAA+B,OAE9CE,EAAMC,IAAWC,EAAAA,EAAAA,UAAgB,CACtCC,gBAAYC,EACZC,YAAY,EACZC,UAAW,KACXC,QAAS,KAGLC,GAAcC,EAAAA,EAAAA,cAClBC,UACET,GAAQU,IAAQ,IACXA,EACHN,YAAY,MAEd,MAAMO,QAAiBC,EAAAA,EAAAA,IAAgB,CACrCpB,MACAD,eACAG,WACAJ,cAGGuB,EAAYC,SACfd,EAAQW,EACV,GAEF,CAACnB,EAAKD,EAAcG,EAAUJ,IAqBhC,OAlBAyB,EAAAA,EAAAA,YAAU,KACHnB,EAAeoB,SAAWpB,EAAeoB,UAAYtB,EAASuB,SACjEnB,EAAckB,QAAU,IAAIE,gBAC5BtB,EAAeoB,QAAUtB,EAASuB,OAElCV,EAAYT,EAAckB,QAAQG,QACpC,GACC,CAACZ,EAAab,EAASuB,UAE1BF,EAAAA,EAAAA,YAAU,KACR,MAAMK,EAAatB,GAAekB,QAClC,MAAO,KACDI,GACFA,EAAWC,OACb,CACD,GACA,IAEItB,CACT,C,w0BCjDA,MAAMuB,EAAe,IAA+B,IAA9B,MAACC,EAAK,UAAEC,GAAiB,EAC7C,MAAM9B,GAAWC,EAAAA,EAAAA,KACXJ,GAAekC,EAAAA,EAAAA,MACf,QAACC,GAAWH,EAEZjC,GAAYqC,EAAAA,EAAAA,UAAQ,IACjBC,EAAAA,GAAAA,yBACL,CACEC,GAAI,GACJC,KAAM,GACNC,QAAS,EACTC,OAAQC,EAAAA,GACRC,SAAU,CAACC,OAAOT,EAAQG,KAC1BO,MAAQ,OAAMC,OAAOb,MACrBc,SAASC,EAAAA,EAAAA,IAAa7C,EAAS0C,MAAMI,KAAMC,EAAAA,KAE7C/C,IAED,CAACA,EAAUgC,EAAQG,GAAIL,KAEpB,QAAClB,EAAO,UAAED,EAAS,WAAED,EAAU,WAAEF,IAAcwC,EAAAA,EAAAA,GAAc,CACjEnD,eACAD,cAGF,OACE,QAACqD,EAAiB,YAChB,QAAC,IAAW,CACVvC,WAAYA,EACZE,QAASA,EACTsC,mBAAmB,EACnBJ,KAAMK,IAAMvD,EAAUwD,OACtB5C,WAAYA,KAEd,QAAC,IAAU,CAACG,UAAWA,MACL,EAnClBiB,EAAY,2BAuClB,MAAMqB,GAAoB,OAAOI,EAAAA,GAAW,qBAAlB,CAAmB,2BACjBC,GAAKA,EAAEC,MAAMC,SAAO,sBAC1BF,GAAKA,EAAEC,MAAME,YAAU,KAG7C,ICzDMC,EAAyBC,IAC7B,MAAM9D,GAAekC,EAAAA,EAAAA,KASrB,OACE,QAAC,IAAO,CACN6B,SAAU,CAAC,qBACX/D,aAAcA,EACdgE,eAZJ,WACE,OACE,QAAC,KAAW,WACV,QAAC,IAAK,CAACC,KAAK,UAAS,UAAEC,EAAAA,EAAAA,GAAE,4CAG/B,EAMmC,UAE/B,QAAC,EAAY,IAAKJ,KACV,EAjBRD,EAAqB,oCAqB3B,S","sources":["webpack:///./app/utils/replays/hooks/useReplayList.tsx","webpack:///./app/views/organizationGroupDetails/groupReplays/groupReplays.tsx","webpack:///./app/views/organizationGroupDetails/groupReplays/index.tsx"],"sourcesContent":["import {useCallback, useEffect, useRef, useState} from 'react';\n\nimport type {Organization} from 'sentry/types';\nimport type EventView from 'sentry/utils/discover/eventView';\nimport fetchReplayList from 'sentry/utils/replays/fetchReplayList';\nimport useApi from 'sentry/utils/useApi';\nimport {useLocation} from 'sentry/utils/useLocation';\nimport type {ReplayListLocationQuery} from 'sentry/views/replays/types';\n\ntype Options = {\n  eventView: EventView;\n  organization: Organization;\n};\n\ntype State = Awaited<ReturnType<typeof fetchReplayList>>;\n\ntype Result = State;\n\nfunction useReplayList({eventView, organization}: Options): Result {\n  const api = useApi();\n  const location = useLocation<ReplayListLocationQuery>();\n  const querySearchRef = useRef<string>();\n  const controllerRef = useRef<AbortController | null>(null);\n\n  const [data, setData] = useState<State>({\n    fetchError: undefined,\n    isFetching: true,\n    pageLinks: null,\n    replays: [],\n  });\n\n  const loadReplays = useCallback(\n    async (abortSignal: AbortSignal) => {\n      setData(prev => ({\n        ...prev,\n        isFetching: true,\n      }));\n      const response = await fetchReplayList({\n        api,\n        organization,\n        location,\n        eventView,\n      });\n\n      if (!abortSignal.aborted) {\n        setData(response);\n      }\n    },\n    [api, organization, location, eventView]\n  );\n\n  useEffect(() => {\n    if (!querySearchRef.current || querySearchRef.current !== location.search) {\n      controllerRef.current = new AbortController();\n      querySearchRef.current = location.search;\n\n      loadReplays(controllerRef.current.signal);\n    }\n  }, [loadReplays, location.search]);\n\n  useEffect(() => {\n    const controller = controllerRef?.current;\n    return () => {\n      if (controller) {\n        controller.abort();\n      }\n    };\n  }, []);\n\n  return data;\n}\n\nexport default useReplayList;\n","import {useMemo} from 'react';\nimport styled from '@emotion/styled';\nimport first from 'lodash/first';\n\nimport Pagination from 'sentry/components/pagination';\nimport {PageContent} from 'sentry/styles/organization';\nimport type {Group} from 'sentry/types';\nimport EventView from 'sentry/utils/discover/eventView';\nimport {decodeScalar} from 'sentry/utils/queryString';\nimport {DEFAULT_SORT, REPLAY_LIST_FIELDS} from 'sentry/utils/replays/fetchReplayList';\nimport useReplayList from 'sentry/utils/replays/hooks/useReplayList';\nimport {useLocation} from 'sentry/utils/useLocation';\nimport useOrganization from 'sentry/utils/useOrganization';\nimport ReplayTable from 'sentry/views/replays/replayTable';\nimport type {ReplayListLocationQuery} from 'sentry/views/replays/types';\n\ntype Props = {\n  group: Group;\n  replayIds: string[];\n};\n\nconst GroupReplays = ({group, replayIds}: Props) => {\n  const location = useLocation<ReplayListLocationQuery>();\n  const organization = useOrganization();\n  const {project} = group;\n\n  const eventView = useMemo(() => {\n    return EventView.fromNewQueryWithLocation(\n      {\n        id: '',\n        name: '',\n        version: 2,\n        fields: REPLAY_LIST_FIELDS,\n        projects: [Number(project.id)],\n        query: `id:[${String(replayIds)}]`,\n        orderby: decodeScalar(location.query.sort, DEFAULT_SORT),\n      },\n      location\n    );\n  }, [location, project.id, replayIds]);\n\n  const {replays, pageLinks, isFetching, fetchError} = useReplayList({\n    organization,\n    eventView,\n  });\n\n  return (\n    <StyledPageContent>\n      <ReplayTable\n        isFetching={isFetching}\n        replays={replays}\n        showProjectColumn={false}\n        sort={first(eventView.sorts)}\n        fetchError={fetchError}\n      />\n      <Pagination pageLinks={pageLinks} />\n    </StyledPageContent>\n  );\n};\n\nconst StyledPageContent = styled(PageContent)`\n  box-shadow: 0px 0px 1px ${p => p.theme.gray200};\n  background-color: ${p => p.theme.background};\n`;\n\nexport default GroupReplays;\n","import Feature from 'sentry/components/acl/feature';\nimport Alert from 'sentry/components/alert';\nimport {t} from 'sentry/locale';\nimport {PageContent} from 'sentry/styles/organization';\nimport useOrganization from 'sentry/utils/useOrganization';\n\nimport GroupReplays from './groupReplays';\n\nconst GroupReplaysContainer = (props: React.ComponentProps<typeof GroupReplays>) => {\n  const organization = useOrganization();\n  function renderNoAccess() {\n    return (\n      <PageContent>\n        <Alert type=\"warning\">{t(\"You don't have access to this feature\")}</Alert>\n      </PageContent>\n    );\n  }\n\n  return (\n    <Feature\n      features={['session-replay-ui']}\n      organization={organization}\n      renderDisabled={renderNoAccess}\n    >\n      <GroupReplays {...props} />\n    </Feature>\n  );\n};\n\nexport default GroupReplaysContainer;\n"],"names":["eventView","organization","api","useApi","location","useLocation","querySearchRef","useRef","controllerRef","data","setData","useState","fetchError","undefined","isFetching","pageLinks","replays","loadReplays","useCallback","async","prev","response","fetchReplayList","abortSignal","aborted","useEffect","current","search","AbortController","signal","controller","abort","GroupReplays","group","replayIds","useOrganization","project","useMemo","EventView","id","name","version","fields","REPLAY_LIST_FIELDS","projects","Number","query","String","orderby","decodeScalar","sort","DEFAULT_SORT","useReplayList","StyledPageContent","showProjectColumn","first","sorts","PageContent","p","theme","gray200","background","GroupReplaysContainer","props","features","renderDisabled","type","t"],"sourceRoot":""}