

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>5.1.1.4. numdifftools.core.Hessdiag &mdash; Numdifftools 0.9.41 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="5.1.1.5. numdifftools.core.Hessian" href="numdifftools.core.Hessian.html" />
    <link rel="prev" title="5.1.1.3. numdifftools.core.Jacobian" href="numdifftools.core.Jacobian.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Numdifftools
          

          
          </a>

          
            
            
              <div class="version">
                0.9
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../intro/index.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">2. Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how-to/index.html">3. How-to guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topics/index.html">4. Topics guides</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">5. Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../numdifftools_summary.html">5.1. Numdifftools summary</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../numdifftools_summary.html#numdifftools-core-module">5.1.1. numdifftools.core module</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="numdifftools.core.Derivative.html">5.1.1.1. numdifftools.core.Derivative</a></li>
<li class="toctree-l4"><a class="reference internal" href="numdifftools.core.Gradient.html">5.1.1.2. numdifftools.core.Gradient</a></li>
<li class="toctree-l4"><a class="reference internal" href="numdifftools.core.Jacobian.html">5.1.1.3. numdifftools.core.Jacobian</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">5.1.1.4. numdifftools.core.Hessdiag</a></li>
<li class="toctree-l4"><a class="reference internal" href="numdifftools.core.Hessian.html">5.1.1.5. numdifftools.core.Hessian</a></li>
<li class="toctree-l4"><a class="reference internal" href="numdifftools.core.directionaldiff.html">5.1.1.6. numdifftools.core.directionaldiff</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../numdifftools_summary.html#step-generators">5.1.2. Step generators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numdifftools_summary.html#numdifftools-extrapolation-module">5.1.3. numdifftools.extrapolation module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numdifftools_summary.html#numdifftools-limits-module">5.1.4. numdifftools.limits module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numdifftools_summary.html#numdifftools-multicomplex-module">5.1.5. numdifftools.multicomplex module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numdifftools_summary.html#numdifftools-nd-algopy-module">5.1.6. numdifftools.nd_algopy module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numdifftools_summary.html#numdifftools-nd-scipy-module">5.1.7. numdifftools.nd_scipy module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numdifftools_summary.html#numdifftools-nd-statsmodels-module">5.1.8. numdifftools.nd_statsmodels module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../numdifftools.html">5.2. Numdifftools package details</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/authors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/acknowledgement.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/index.html">Indices and tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/zreferences.html">Bibliography</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Numdifftools</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html"><span class="section-number">5. </span>Reference</a> &raquo;</li>
        
          <li><a href="../numdifftools_summary.html"><span class="section-number">5.1. </span>Numdifftools summary</a> &raquo;</li>
        
      <li><span class="section-number">5.1.1.4. </span>numdifftools.core.Hessdiag</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/reference/generated/numdifftools.core.Hessdiag.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="numdifftools-core-hessdiag">
<h1><span class="section-number">5.1.1.4. </span>numdifftools.core.Hessdiag<a class="headerlink" href="#numdifftools-core-hessdiag" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="numdifftools.core.Hessdiag">
<em class="property">class </em><code class="sig-name descname">Hessdiag</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f</span></em>, <em class="sig-param"><span class="n">step</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'central'</span></em>, <em class="sig-param"><span class="n">order</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">options</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/numdifftools/core.html#Hessdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#numdifftools.core.Hessdiag" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate Hessian diagonal with finite difference approximation</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>fun</strong><span class="classifier">function</span></dt><dd><p>function of one array fun(x, <cite>*args</cite>, <cite>**kwds</cite>)</p>
</dd>
<dt><strong>step</strong><span class="classifier">float, array-like or StepGenerator object, optional</span></dt><dd><p>Defines the spacing used in the approximation.
Default is MinStepGenerator(<a href="#id1"><span class="problematic" id="id2">**</span></a>step_options) if method in in [‘complex’, ‘multicomplex’],
otherwise</p>
<blockquote>
<div><p>MaxStepGenerator(<a href="#id3"><span class="problematic" id="id4">**</span></a>step_options)</p>
</div></blockquote>
<p>The results are extrapolated if the StepGenerator generate more than 3
steps.</p>
</dd>
<dt><strong>method</strong><span class="classifier">{‘central’, ‘complex’, ‘multicomplex’, ‘forward’, ‘backward’}</span></dt><dd><p>defines the method used in the approximationorder : int, optional
defines the order of the error term in the Taylor approximation used.
For ‘central’ and ‘complex’ methods, it must be an even number.</p>
</dd>
<dt><strong>richardson_terms: scalar integer, default 2.</strong></dt><dd><p>number of terms used in the Richardson extrapolation.</p>
</dd>
<dt><strong>full_output</strong><span class="classifier">bool, optional</span></dt><dd><p>If <cite>full_output</cite> is False, only the derivative is returned.
If <cite>full_output</cite> is True, then (der, r) is returned <cite>der</cite> is the
derivative, and <cite>r</cite> is a Results object.</p>
</dd>
<dt><strong>**step_options:</strong></dt><dd><p>options to pass on to the XXXStepGenerator used.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>hessdiag</strong><span class="classifier">array</span></dt><dd><p>hessian diagonal</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../numdifftools.html#numdifftools.core.Derivative" title="numdifftools.core.Derivative"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Derivative</span></code></a>, <a class="reference internal" href="../numdifftools.html#numdifftools.core.Hessian" title="numdifftools.core.Hessian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Hessian</span></code></a>, <a class="reference internal" href="../numdifftools.html#numdifftools.core.Jacobian" title="numdifftools.core.Jacobian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Jacobian</span></code></a>, <a class="reference internal" href="../numdifftools.html#numdifftools.core.Gradient" title="numdifftools.core.Gradient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Gradient</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Complex methods are usually the most accurate provided the function to
differentiate is analytic. The complex-step methods also requires fewer
steps than the other methods and can work very close to the support of
a function.
The complex-step derivative has truncation error O(steps**2) for <cite>n=1</cite> and
O(steps**4) for <cite>n</cite> larger, so truncation error can be eliminated by
choosing steps to be very small.
Especially the first order complex-step derivative avoids the problem of
round-off error with small steps because there is no subtraction. However,
this method fails if fun(x) does not support complex numbers or involves
non-analytic functions such as e.g.: abs, max, min.
Central difference methods are almost as accurate and has no restriction on
type of function. For this reason the ‘central’ method is the default
method, but sometimes one can only allow evaluation in forward or backward
direction.</p>
<p>For all methods one should be careful in decreasing the step size too much
due to round-off errors.</p>
<p>Higher order approximation methods will generally be more accurate, but may
also suffer more from numerical problems. First order methods is usually
not recommended.</p>
<p class="rubric">References</p>
<dl class="simple">
<dt>Ridout, M.S. (2009) Statistical applications of the complex-step method</dt><dd><p>of numerical differentiation. The American Statistician, 63, 66-74</p>
</dd>
<dt>K.-L. Lai, J.L. Crassidis, Y. Cheng, J. Kim (2005), New complex step</dt><dd><p>derivative approximations with application to second-order
kalman filtering, AIAA Guidance, Navigation and Control Conference,
San Francisco, California, August 2005, AIAA-2005-5944.</p>
</dd>
<dt>Lyness, J. M., Moler, C. B. (1966). Vandermonde Systems and Numerical</dt><dd><p>Differentiation. <em>Numerische Mathematik</em>.</p>
</dd>
<dt>Lyness, J. M., Moler, C. B. (1969). Generalized Romberg Methods for</dt><dd><p>Integrals of Derivatives. <em>Numerische Mathematik</em>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numdifftools</span> <span class="k">as</span> <span class="nn">nd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Hfun</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">Hessdiag</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hd</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">Hfun</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">hd</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span>   <span class="mf">2.</span><span class="p">,</span>  <span class="mf">18.</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">error_estimate</span> <span class="o">&lt;</span> <span class="mf">1e-11</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(x, *args, **kwds)</p></td>
<td><p>Call self as a function.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="numdifftools.core.Hessdiag.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f</span></em>, <em class="sig-param"><span class="n">step</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'central'</span></em>, <em class="sig-param"><span class="n">order</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">options</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/numdifftools/core.html#Hessdiag.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#numdifftools.core.Hessdiag.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#numdifftools.core.Hessdiag.__init__" title="numdifftools.core.Hessdiag.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(f[, step, method, order])</p></td>
<td><p>Initialize self.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../numdifftools.html#numdifftools.core.Hessdiag.set_richardson_rule" title="numdifftools.core.Hessdiag.set_richardson_rule"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_richardson_rule</span></code></a>(step_ratio[, num_terms])</p></td>
<td><p>Set Richardson exptrapolation options</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="../numdifftools.html#numdifftools.core.Hessdiag.method" title="numdifftools.core.Hessdiag.method"><code class="xref py py-obj docutils literal notranslate"><span class="pre">method</span></code></a></p></td>
<td><p>Defines the method used in the finite difference approximation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../numdifftools.html#numdifftools.core.Hessdiag.method_order" title="numdifftools.core.Hessdiag.method_order"><code class="xref py py-obj docutils literal notranslate"><span class="pre">method_order</span></code></a></p></td>
<td><p>Defines the leading order of the error term in the Richardson extrapolation method.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../numdifftools.html#numdifftools.core.Hessdiag.n" title="numdifftools.core.Hessdiag.n"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n</span></code></a></p></td>
<td><p>Order of the derivative.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../numdifftools.html#numdifftools.core.Hessdiag.order" title="numdifftools.core.Hessdiag.order"><code class="xref py py-obj docutils literal notranslate"><span class="pre">order</span></code></a></p></td>
<td><p>Defines the order of the error term in the Taylor approximation used.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../numdifftools.html#numdifftools.core.Hessdiag.step" title="numdifftools.core.Hessdiag.step"><code class="xref py py-obj docutils literal notranslate"><span class="pre">step</span></code></a></p></td>
<td><p>The step spacing(s) used in the approximation</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="numdifftools.core.Hessian.html" class="btn btn-neutral float-right" title="5.1.1.5. numdifftools.core.Hessian" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="numdifftools.core.Jacobian.html" class="btn btn-neutral float-left" title="5.1.1.3. numdifftools.core.Jacobian" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2009-2022, Per A. Brodtkorb, John D&#39;Errico.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>