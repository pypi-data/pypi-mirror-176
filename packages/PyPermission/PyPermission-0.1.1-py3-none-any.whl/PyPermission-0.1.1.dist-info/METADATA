Metadata-Version: 2.1
Name: PyPermission
Version: 0.1.1
Summary: A node based permission engine for python.
Home-page: https://gitlab.com/DigonIO/PyPermission
Author: Jendrik A. Potyka, Fabian A. PreiÃŸ
Author-email: devops@digon.io
License: LGPLv3
Project-URL: Documentation, https://PyPermission.readthedocs.io/en/latest/
Project-URL: Source Code, https://gitlab.com/DigonIO/PyPermission
Project-URL: Bug Tracker, https://gitlab.com/DigonIO/PyPermission/-/issues
Project-URL: Changelog, https://gitlab.com/DigonIO/PyPermission/-/blob/master/CHANGELOG.md
Keywords: permission engine system node tree
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: GNU Lesser General Public License v3 (LGPLv3)
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: Implementation :: CPython
Classifier: Topic :: Software Development
Classifier: Operating System :: OS Independent
Classifier: Typing :: Typed
Requires-Python: >=3.10
Description-Content-Type: text/markdown
License-File: LICENSE
Provides-Extra: all
Requires-Dist: sqlalchemy (==1.4.42) ; extra == 'all'
Requires-Dist: PyYAML (>=6.0) ; extra == 'all'
Provides-Extra: dev
Requires-Dist: pytest (==7.1.3) ; extra == 'dev'
Requires-Dist: furo (==2022.9.29) ; extra == 'dev'
Requires-Dist: coverage (==6.5.0) ; extra == 'dev'
Requires-Dist: Sphinx (==5.2.3) ; extra == 'dev'
Requires-Dist: m2r2 (==0.3.3) ; extra == 'dev'
Requires-Dist: mariadb (>=1.1.5.post2) ; extra == 'dev'
Requires-Dist: sybil (==3.0.1) ; extra == 'dev'
Requires-Dist: mypy-extensions (==0.4.3) ; extra == 'dev'
Requires-Dist: sqlalchemy (==1.4.42) ; extra == 'dev'
Requires-Dist: mypy (==0.981) ; extra == 'dev'
Requires-Dist: numpydoc (==1.5.0) ; extra == 'dev'
Requires-Dist: bandit (==1.7.4) ; extra == 'dev'
Requires-Dist: typing-extensions (==4.4.0) ; extra == 'dev'
Requires-Dist: scheduler (==0.8.0) ; extra == 'dev'
Requires-Dist: pylint (==2.14.5) ; extra == 'dev'
Requires-Dist: docutils (==0.19) ; extra == 'dev'
Requires-Dist: PyYAML (>=6.0) ; extra == 'dev'
Requires-Dist: deepdiff (==6.2.1) ; extra == 'dev'
Requires-Dist: pytest-cov (==4.0.0) ; extra == 'dev'
Requires-Dist: sqlalchemy2-stubs (==0.0.2a29) ; extra == 'dev'
Requires-Dist: pydocstyle (==6.1.1) ; extra == 'dev'
Requires-Dist: types-PyYAML (>=6.0.12) ; extra == 'dev'
Provides-Extra: doc
Requires-Dist: furo (==2022.9.29) ; extra == 'doc'
Requires-Dist: docutils (==0.19) ; extra == 'doc'
Requires-Dist: Sphinx (==5.2.3) ; extra == 'doc'
Requires-Dist: m2r2 (==0.3.3) ; extra == 'doc'
Requires-Dist: sqlalchemy (==1.4.42) ; extra == 'doc'
Requires-Dist: PyYAML (>=6.0) ; extra == 'doc'
Requires-Dist: numpydoc (==1.5.0) ; extra == 'doc'
Provides-Extra: lint
Requires-Dist: typing-extensions (==4.4.0) ; extra == 'lint'
Requires-Dist: pylint (==2.14.5) ; extra == 'lint'
Requires-Dist: PyYAML (>=6.0) ; extra == 'lint'
Requires-Dist: sqlalchemy2-stubs (==0.0.2a29) ; extra == 'lint'
Requires-Dist: mypy-extensions (==0.4.3) ; extra == 'lint'
Requires-Dist: pydocstyle (==6.1.1) ; extra == 'lint'
Requires-Dist: types-PyYAML (>=6.0.12) ; extra == 'lint'
Requires-Dist: sqlalchemy (==1.4.42) ; extra == 'lint'
Requires-Dist: mypy (==0.981) ; extra == 'lint'
Requires-Dist: numpydoc (==1.5.0) ; extra == 'lint'
Requires-Dist: bandit (==1.7.4) ; extra == 'lint'
Provides-Extra: sqlalchemy
Requires-Dist: sqlalchemy (==1.4.42) ; extra == 'sqlalchemy'
Provides-Extra: test
Requires-Dist: typing-extensions (==4.4.0) ; extra == 'test'
Requires-Dist: pytest (==7.1.3) ; extra == 'test'
Requires-Dist: scheduler (==0.8.0) ; extra == 'test'
Requires-Dist: coverage (==6.5.0) ; extra == 'test'
Requires-Dist: pylint (==2.14.5) ; extra == 'test'
Requires-Dist: mariadb (>=1.1.5.post2) ; extra == 'test'
Requires-Dist: PyYAML (>=6.0) ; extra == 'test'
Requires-Dist: deepdiff (==6.2.1) ; extra == 'test'
Requires-Dist: pytest-cov (==4.0.0) ; extra == 'test'
Requires-Dist: sqlalchemy2-stubs (==0.0.2a29) ; extra == 'test'
Requires-Dist: sybil (==3.0.1) ; extra == 'test'
Requires-Dist: mypy-extensions (==0.4.3) ; extra == 'test'
Requires-Dist: pydocstyle (==6.1.1) ; extra == 'test'
Requires-Dist: types-PyYAML (>=6.0.12) ; extra == 'test'
Requires-Dist: sqlalchemy (==1.4.42) ; extra == 'test'
Requires-Dist: mypy (==0.981) ; extra == 'test'
Requires-Dist: numpydoc (==1.5.0) ; extra == 'test'
Requires-Dist: bandit (==1.7.4) ; extra == 'test'
Provides-Extra: yaml
Requires-Dist: PyYAML (>=6.0) ; extra == 'yaml'

<h1 align="center">
  <img alt="PyPermission" src="./docs/_assets/logo_name.svg" width="60%">
</h1>

<p>
    A role-based access control (RBAC) permission library for python.
</p>

[![repository](https://img.shields.io/badge/src-GitLab-orange)](https://gitlab.com/DigonIO/pypermission)
[![mirror](https://img.shields.io/badge/mirror-GitHub-orange)](https://github.com/DigonIO/pypermission)
[![license](https://img.shields.io/badge/license-LGPLv3-orange)](https://gitlab.com/DigonIO/pypermission/-/blob/master/LICENSE)
[![pipeline status](https://gitlab.com/DigonIO/pypermission/badges/master/pipeline.svg)](https://gitlab.com/DigonIO/pypermission/-/pipelines)
[![coverage report](https://gitlab.com/DigonIO/pypermission/badges/master/coverage.svg)](https://gitlab.com/DigonIO/pypermission/-/pipelines)
[![Documentation Status](https://readthedocs.org/projects/python-pypermission/badge/?version=latest)](https://pypermission.readthedocs.io/en/latest/?badge=latest)
[![Code style: black](https://gitlab.com/DigonIO/scheduler/-/raw/master/doc/_assets/code_style_black.svg)](https://github.com/psf/black)

[![pkgversion](https://img.shields.io/pypi/v/pypermission)](https://pypi.org/project/pypermission/)
[![versionsupport](https://img.shields.io/pypi/pyversions/pypermission)](https://pypi.org/project/pypermission/)
[![Downloads Week](https://pepy.tech/badge/pypermission/week)](https://pepy.tech/project/pypermission)
[![Downloads Total](https://pepy.tech/badge/pypermission)](https://pepy.tech/project/pypermission)

## WARNING: ALPHA VERSION

This is a prototype. APIs will be subjects to breaking changes! Existing APIs are not battle tested
and might exhibit unexpected behavior!

## Features

+ NIST Model for RBAC: <https://doi.org/10.1145/344287.344301>
  + Level 1: Flat (Missing method)
  + Level 2a: Hierarchical
  + Level 3a: Constrained (TODO)
  + Level 4a: Symmetric (TODO)
+ Permissions with hierarchical ordering
+ Permissions with string payloads
+ Persistency backends
  + SQLAlchemy
  + JSON + YAML save files
+ Subject permission assignment (UBAC oriented)
+ Online Documentation (TODO, is incomplete and incorrect)

## Installation

### pip

`PyPermission` can be installed directly from the PyPI repositories.

#### JSON persistency backend

```bash
pip install PyPermission
```

#### SQLAlchemy persistency backend

```bash
pip install PyPermission[sqlalchemy]
```

#### JSON + YAML persistency backend

```bash
pip install PyPermission[yaml]
```

### Editable installation for developers

Install `PyPermission` from the `git`
[repository](https://gitlab.com/DigonIO/PyPermission) with:

```bash
git clone https://gitlab.com/DigonIO/PyPermission.git
cd PyPermission
python -m venv venv  # optional
source ./venv/bin/activate # optional
pip install -e .[dev]
```

## Example: *How to RBAC*

Import all required objects. Here we will choose the authority with the JSON persistency backend.

```py
from pypermission import PermissionNode
from pypermission.yaml import SerialAuthority
```

Define an authority with some permission nodes:

```py
class Nodes(PermissionNode):
    CHAT_ = "chat.*"  # parent
    CHAT_GLOBAL = "chat.global"  # leaf
    CHAT_MODERATOR = "chat.moderator"  # leaf
    TICKET_ = "ticket.*"  # parent
    TICKET_OPEN = "ticket.open"  # leaf
    TICKET_CLOSE_ = "ticket.close.*"  # parent
    TICKET_CLOSE_OWN = "ticket.close.own"  # leaf
    TICKET_CLOSE_ALL = "ticket.close.all"  # leaf
    TICKET_ASSIGN = "ticket.assign"  # leaf

auth = SerialAuthority(nodes=Nodes)
```

The following file `save_file.yaml` defines a RBAC setup. Alice is
a member of the user and moderator role, while Bob is assigned only to the user role:

```yaml
roles:
  moderator:
    permission_nodes:
      - chat.*
      - ticket.*
    member_subjects:
      - Alice
  user:
    permission_nodes:
      - chat.global
      - ticket.open
      - ticket.close.own
    member_subjects:
      - Alice
      - Bob
subjects:
  Alice: {}
  Bob: {}
```

```py
auth.load_file(path="save_file.yaml")
```

Now check if a subject has a desired permission.

```pycon
>>> auth.subject_has_permission(sid="Bob", node=Nodes.CHAT_GLOBAL)
True

>>> auth.subject_has_permission(sid="Alice", node=Nodes.CHAT_MODERATOR)
True

>>> auth.subject_has_permission(sid="Bob", node=Nodes.TICKET_OPEN)
True

>>> auth.subject_has_permission(sid="Alice", node=Nodes.TICKET_CLOSE_ALL)
True
```

## Documentation

The API documentation can either be viewed
[online](https://pypermission.readthedocs.io/en/latest/readme.html)
or generated using Sphinx with [numpydoc](https://numpydoc.readthedocs.io/en/latest/format.html)
formatting. To build, run:

```bash
sphinx-build -b html docs/ docs/_build/html
```

## Testing

Testing is done using [pytest](https://pypi.org/project/pytest/). With
[pytest-cov](https://pypi.org/project/pytest-cov/) and
[coverage](https://pypi.org/project/coverage/) a report for the test coverage can be generated:

```bash
pytest --cov=src/ tests/
coverage html
```

To test the examples in the documentation run:

```bash
pytest docs/
```

## License

This free and open source software (FOSS) is published under the [LGPLv3 license](https://www.gnu.org/licenses/lgpl-3.0.en.html).
