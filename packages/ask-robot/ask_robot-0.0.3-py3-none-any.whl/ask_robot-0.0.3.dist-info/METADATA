Metadata-Version: 2.1
Name: ask-robot
Version: 0.0.3
Summary: the robot for chat system
License: MIT
Author: idlewith
Author-email: newellzhou@163.com
Requires-Python: >=3.6,<4.0
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.6
Classifier: Programming Language :: Python :: 3.7
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Requires-Dist: Flask (==2.0.3)
Requires-Dist: Jinja2 (==3.0.3)
Requires-Dist: MarkupSafe (==2.0.1)
Requires-Dist: Pygments (==2.11.2)
Requires-Dist: Werkzeug (==2.0.3)
Requires-Dist: asttokens (==2.0.5)
Requires-Dist: beautifulsoup4 (==4.10.0)
Requires-Dist: certifi (==2021.10.8)
Requires-Dist: cffi (==1.15.0)
Requires-Dist: charset-normalizer (==2.0.12)
Requires-Dist: cheap-repr (==0.5.1)
Requires-Dist: cheroot (==8.6.0)
Requires-Dist: click (==8.0.4)
Requires-Dist: dataclasses (==0.6)
Requires-Dist: executing (==0.8.3)
Requires-Dist: flake8 (==4.0.1)
Requires-Dist: idna (==3.3)
Requires-Dist: importlib-metadata (==4.8.3)
Requires-Dist: itsdangerous (==2.0.1)
Requires-Dist: jaraco.functools (==3.4.0)
Requires-Dist: line-profiler (==3.5.0)
Requires-Dist: line-profiler-pycharm (==1.1.0)
Requires-Dist: mccabe (==0.6.1)
Requires-Dist: more-itertools (==8.12.0)
Requires-Dist: optionaldict (==0.1.2)
Requires-Dist: pycodestyle (==2.8.0)
Requires-Dist: pycparser (==2.21)
Requires-Dist: pycryptodome (==3.14.1)
Requires-Dist: pyflakes (==2.4.0)
Requires-Dist: python-dateutil (==2.8.2)
Requires-Dist: requests (==2.27.1)
Requires-Dist: semantic-version (==2.9.0)
Requires-Dist: setuptools-rust (==1.1.2)
Requires-Dist: six (==1.16.0)
Requires-Dist: snoop (==0.4.1)
Requires-Dist: soupsieve (==2.3.1)
Requires-Dist: typing-extensions (==4.1.1)
Requires-Dist: urllib3 (==1.26.8)
Requires-Dist: wechatpy (==1.8.18)
Requires-Dist: xmltodict (==0.12.0)
Requires-Dist: zipp (==3.6.0)
Description-Content-Type: text/markdown


# Ask robot

**using cloud functions to do soma daily things**

# todo

**main todo**

- [ ] update docs to use cloud functions to connect wechat platform
- [ ] delete local operations, like files


# install python


## build from source

```shell
wget https://www.python.org/ftp/python/3.9.7/Python-3.9.7.tar.xz
tar -xzvf Python-3.9.7.tar.xz

cd Python-3.9.7
./configure --prefix=/opt/idlepig/apps/python397
make
make altinstall

cd ~/code/venv
/opt/idlepig/apps/python397/bin/python3.9 -m venv wx
source ~/code/venv/wx/bin/activate

cd ~/code/wx
pip install -r requirements.txt
```


## create environment

in centos

```shell
yum install python36u
```

create virtual environment and source

```shell
mkdir -p ~/code/venv
cd ~/code/venv
python3 -m venv wx
source ~/code/venv/wx/bin/activate
```

copy files in this project to server.

firstly, login in your server, then, clone github repository

**todo: push code to github**

```shell
mkdir -p ~/code
cd ~/code
git clone https://github.com/idlepig/wx.git
cd wx
```

install third requirement
```shell
pip install -r requirements.txt
```

## start flask service

you need set actual info for token, aes_key, appid

if you are in plaintext mode, just set token is ok.

```shell
export token=''
export app_id=''
export aes_key=''
export secret=''
export email_from=''
export email_password=''
export email_to=''
```

```shell
sh auto.sh
```

the http://0.0.0.0:8081 will work

# install nginx


```shell
yum install nginx
```

vi /etc/nginx/nginx.conf

```shell
http {
...
upstream idlepig {
    server 127.0.0.1:8081;
  }
...
}
```

vi /etc/nginx/conf.d/default.conf

```shell
server {
    listen 80;
    server_name _;
    location / {
      proxy_pass http://idlepig;
    }
}
```

so, we map 80 port to 8081 port

start nginx

```shell
nginx
```

# for WeChat platform

[article_for_wx.py](article_for_wx.py) has chinese comment is only for WeChat platform

这个脚本是微信公众号里面都脚本文件

# logs file location

/opt/idlewith/logs/output.log

