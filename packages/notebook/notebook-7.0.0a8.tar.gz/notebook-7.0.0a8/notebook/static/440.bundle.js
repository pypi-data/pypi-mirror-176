"use strict";(self.webpackChunk_JUPYTERLAB_CORE_OUTPUT=self.webpackChunk_JUPYTERLAB_CORE_OUTPUT||[]).push([[440,7594],{80440:(e,t,s)=>{s.r(t),s.d(t,{AwarenessMock:()=>y,CollaboratorsBody:()=>j,CollaboratorsPanel:()=>S,ICurrentUser:()=>o,IGlobalAwareness:()=>i,IUserMenu:()=>n,RendererUserMenu:()=>C,USER:()=>r,User:()=>_,UserInfoBody:()=>E,UserInfoPanel:()=>f,UserMenu:()=>N,getAnonymousUserName:()=>m,moonsOfJupyter:()=>d,requestAPI:()=>u});var a=s(39787);const r="@jupyterlab/collaboration:userDB",o=new a.Token("@jupyterlab/collaboration:ICurrentUser"),n=new a.Token("@jupyterlab/collaboration:IUserMenu"),i=new a.Token("@jupyterlab/collaboration:IGlobalAwareness");var l=s(6691),c=s(22554),h=s(42081);async function u(e="",t={}){const s=h.ServerConnection.makeSettings(),a=c.URLExt.join(s.baseUrl,e);let r;try{r=await h.ServerConnection.makeRequest(a,t,s)}catch(e){throw new h.ServerConnection.NetworkError(e)}let o=await r.text();if(o.length>0)try{o=JSON.parse(o)}catch(e){console.log("Not a JSON response body.",r)}if(!r.ok)throw new h.ServerConnection.ResponseError(r,o.message||o);return o}const d=["Metis","Adrastea","Amalthea","Thebe","Io","Europa","Ganymede","Callisto","Themisto","Leda","Ersa","Pandia","Himalia","Lysithea","Elara","Dia","Carpo","Valetudo","Euporie","Eupheme","Helike","Euanthe","Hermippe","Praxidike","Thyone","Thelxinoe","Ananke","Mneme","Orthosie","Harpalyke","Iocaste","Erinome","Aitne","Herse","Taygete","Eukelade","Carme","Isonoe","Autonoe","Philophrosyne","Cyllene","Pasithee","Pasiphae","Sponde","Eurydome","Kalyke","Hegemone","Kale","Kallichore","Chaldene","Arche","Eirene","Kore","Megaclite","Aoede","Callirrhoe","Sinope"],m=()=>d[Math.floor(Math.random()*d.length)];class _{constructor(){this._isReady=!1,this._ready=new l.Signal(this),this._changed=new l.Signal(this),this._fetchUser(),this._isReady=!0,this._ready.emit(!0)}get username(){return this._username}get name(){return this._name}get displayName(){return this._displayName}get initials(){return this._initials}get color(){return this._color}set color(e){this._color=e}get anonymous(){return this._anonymous}get cursor(){return this._cursor}get isReady(){return this._isReady}get ready(){return this._ready}get changed(){return this._changed}fromJSON(e){this._username=e.username,this._name=e.name,this._displayName=e.displayName,this._initials=e.initials,this._color=e.color,this._anonymous=e.anonymous,this._cursor=e.cursor,this._save()}toJSON(){return{username:this._username,name:this.name,displayName:this._displayName,initials:this._initials,color:this._color,anonymous:this._anonymous,cursor:this._cursor}}_save(){const{localStorage:e}=window;e.setItem(r,JSON.stringify(this.toJSON())),this._changed.emit()}_fetchUser(){const e=new URLSearchParams(location.search);let t=e.get("username")||"",s=e.get("usercolor")||"",o=e.get("initials")||"";const{localStorage:n}=window,i=n.getItem(r);if(null!==i){const e=JSON.parse(i);this._username=e.username,this._name=""!==t?t:e.name,this._displayName=""!==t?t:e.displayName,this._initials=""!==o?o:e.initials,this._color=""!==s?"#"+s:e.color,this._anonymous=e.anonymous,this._cursor=e.cursor||void 0,""===t&&""===s||this._save()}else{const e=m();this._username=a.UUID.uuid4(),this._name=""!==t?t:"Anonymous "+e,this._displayName=this._name,this._initials=""!==o?o:`A${e.substring(0,1).toLocaleUpperCase()}`,this._color=""!==s?"#"+s:p.getRandomColor(),this._anonymous=!0,this._cursor=void 0,this._save()}}}var p;!function(e){const t=["var(--jp-collaborator-color1)","var(--jp-collaborator-color2)","var(--jp-collaborator-color3)","var(--jp-collaborator-color4)","var(--jp-collaborator-color5)","var(--jp-collaborator-color6)","var(--jp-collaborator-color7)"];e.getRandomColor=()=>t[Math.floor(Math.random()*t.length)]}(p||(p={}));class y{constructor(e){this.states=new Map,this.meta=new Map,this.doc=e,this.clientID=e.clientID}setLocalState(e){}setLocalStateField(e,t){}getLocalState(){return null}getStates(){return this.states}on(e,t){}off(e,t){}once(e,t){}emit(e,t){}destroy(){}}var b=s(26629),g=s(34340),I=s(48236);class C extends g.MenuBar.Renderer{constructor(e){super(),this._user=e}renderItem(e){let t=this.createItemClass(e),s=this.createItemDataset(e),a=this.createItemARIA(e);return I.h.li({className:t,dataset:s,tabindex:"0",onfocus:e.onfocus,...a},this._createUserIcon(),this.renderLabel(e),this.renderIcon(e))}renderLabel(e){let t=this.formatLabel(e);return I.h.div({className:"lm-MenuBar-itemLabel jp-MenuBar-label"},t)}_createUserIcon(){return this._user.isReady&&this._user.avatar_url?I.h.div({className:"lm-MenuBar-itemIcon jp-MenuBar-imageIcon"},I.h.img({src:this._user.avatar_url})):this._user.isReady?I.h.div({className:"lm-MenuBar-itemIcon jp-MenuBar-anonymousIcon",style:{backgroundColor:this._user.color}},I.h.span({},this._user.initials)):I.h.div({className:"lm-MenuBar-itemIcon jp-MenuBar-anonymousIcon"},b.userIcon)}}class N extends g.Menu{constructor(e){super(e),this._updateLabel=e=>{const t=""!==e.displayName?e.displayName:e.name;this.title.label=t,this.update()},this._user=e.user;const t=""!==this._user.displayName?this._user.displayName:this._user.name;this.title.label=this._user.isReady?t:"",this.title.icon=b.caretDownIcon,this.title.iconClass="jp-UserMenu-caretDownIcon",this._user.ready.connect(this._updateLabel),this._user.changed.connect(this._updateLabel)}dispose(){this._user.ready.disconnect(this._updateLabel),this._user.changed.disconnect(this._updateLabel)}}var w=s(2815),U=s(72245);const v=e=>{const{user:t}=e;return U.createElement("div",{className:"jp-UserInfo-Container"},U.createElement("div",{title:t.displayName,className:"jp-UserInfo-Icon",style:{backgroundColor:t.color}},U.createElement("span",null,t.initials)),U.createElement("h3",null,t.displayName))};class f extends g.Panel{constructor(e){super({}),this.addClass("jp-UserInfoPanel"),this._profile=e,this._profile.isReady?(this._body=new E(e.toJSON()),this.addWidget(this._body),this.update()):this._profile.ready.connect((e=>{this._body=new E(e.toJSON()),this.addWidget(this._body),this.update()}))}}class E extends w.ReactWidget{constructor(e){super(),this._user=e}get user(){return this._user}set user(e){this._user=e,this.update()}render(){return U.createElement(v,{user:this._user})}}class S extends g.Panel{constructor(e,t,s){super({}),this._onAwarenessChanged=()=>{const e=this._awareness.getStates(),t=[];e.forEach(((e,s)=>{e.user.name!==this._currentUser.name&&t.push(e)})),this._body.collaborators=t},this._awareness=t,this._currentUser=e,this._body=new j(s),this.addWidget(this._body),this.update(),this._awareness.on("change",this._onAwarenessChanged)}}class j extends w.ReactWidget{constructor(e){super(),this._collaborators=[],this._fileopener=e,this.addClass("jp-CollaboratorsList")}get collaborators(){return this._collaborators}set collaborators(e){this._collaborators=e,this.update()}render(){return this._collaborators.map(((e,t)=>{let s=!1,a="",r="",o="";e.current&&(s=!0,o=e.current.split(":")[1],a=c.PathExt.basename(o),a=a.length>25?a.slice(0,12).concat("…"):a,r="•");const n=`${""!=e.user.displayName?e.user.displayName:e.user.name} ${r} ${a}`;return U.createElement("div",{className:s?"jp-ClickableCollaborator jp-Collaborator":"jp-Collaborator",key:t,onClick:()=>{s&&this._fileopener(o)}},U.createElement("div",{className:"jp-CollaboratorIcon",style:{backgroundColor:e.user.color}},U.createElement("span",null,e.user.initials)),U.createElement("span",null,n))}))}}}}]);